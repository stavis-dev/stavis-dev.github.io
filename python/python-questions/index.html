<!doctype html>
<html lang="ru" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-python/python-questions">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Подготовка к собеседованию Python разработчика. | Шпаргалка по знаниям</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stavis-dev.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://stavis-dev.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://stavis-dev.github.io/python/python-questions"><meta data-rh="true" name="docusaurus_locale" content="ru"><meta data-rh="true" name="docsearch:language" content="ru"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Подготовка к собеседованию Python разработчика. | Шпаргалка по знаниям"><meta data-rh="true" name="description" content="Вопросы попадающиеся на собеседованиях на разработчика python"><meta data-rh="true" property="og:description" content="Вопросы попадающиеся на собеседованиях на разработчика python"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://stavis-dev.github.io/python/python-questions"><link data-rh="true" rel="alternate" href="https://stavis-dev.github.io/python/python-questions" hreflang="ru"><link data-rh="true" rel="alternate" href="https://stavis-dev.github.io/python/python-questions" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://A4WYJ5NE7Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Шпаргалка по знаниям RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Шпаргалка по знаниям Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5EZH6Q0C8W"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5EZH6Q0C8W",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Шпаргалка по знаниям" href="/opensearch.xml">
<link rel="preconnect" href="https://mc.yandex.ru">
<script>!function(e,t,a,c,n,r,i){e[n]=e[n]||function(){(e[n].a=e[n].a||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(a),i=t.getElementsByTagName(a)[0],r.async=1,r.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(r,i)}(window,document,"script",0,"ym"),ym(94461914,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!1,ecommerce:!1,trackHash:!1})</script>
<noscript>
                            <div><img src="https://mc.yandex.ru/watch/94461914" style="position:absolute; left:-9999px;" alt=""></div>
                        </noscript><link rel="stylesheet" href="/assets/css/styles.f7acf942.css">
<link rel="preload" href="/assets/js/runtime~main.b57e7902.js" as="script">
<link rel="preload" href="/assets/js/main.3369d20a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Перейти к основному содержимому"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Перейти к основному содержимому</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Переключить навигационную панель" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Обо мне</b></a><a class="navbar__item navbar__link" href="/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" sidebarid="pythonSidebar" href="/python/">Python</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/stavis-dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon navbar-icon-github" aria-label="GitHub repository"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>
            </svg></a><a href="https://twitter.com/stavisvega" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-icon navbar-icon-twitter" aria-label="Twitter page"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
              </path>
            </svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-label="Переключение между темным и светлым режимом (сейчас используется Светлый режим)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Поиск"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Поиск</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Прокрутка к началу" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><b>Обо мне</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/">Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/python/types/tipy-dannykh-v-python">Типы данных Python</a><button aria-label="Свернуть/развернуть категорию &#x27;Типы данных Python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/python/functions/all_any">Python - функции</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/python/algorithms/">Все про алгоритмы</a><button aria-label="Свернуть/развернуть категорию &#x27;Все про алгоритмы&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/python/modules/">Модули</a><button aria-label="Свернуть/развернуть категорию &#x27;Модули&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/best-practices-python">Лучшие практики</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/dataclasses">Датаклассы</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/google-colab">Google Colab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/python/python-questions">Собеседования</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/python-re-sub">Модуль re.replace()</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/save_load">Работа с файлами Pyhton</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/python/unittests">Unittest примеры</a></li></ul></nav><button type="button" title="Свернуть сайдбар" aria-label="Свернуть сайдбар" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Навигационная цепочка текущей страницы"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Главная страница" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Собеседования</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Содержание этой страницы</button></div><div class="theme-doc-markdown markdown"><h1>Python вопросы собеседования</h1><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Вопрос</summary><div><div class="collapsibleContent_i85q"><p>Ответ </p></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="последовательности">Последовательности<a href="#последовательности" class="hash-link" aria-label="Прямая ссылка на Последовательности" title="Прямая ссылка на Последовательности">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что такое последовательность</summary><div><div class="collapsibleContent_i85q"><p>Последовательностью в Python называется итерабельный объект, который поддерживает эффективный доступ к элементам с использованием целочисленных индексов через специальный метод <code>__getitem__()</code> и поддерживает метод <code>__len__()</code>, который возвращает длину последовательности.
К основным встроенным типам последовательностей относятся list, tuple, range, str и bytes.</p><p>Последовательности также опционально могут реализовывать методы <code>count()</code>, <code>index()</code>, <code>__contains__()</code> и <code>__reversed__()</code> и другие.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Какие операции поддерживают большинство последовательностей</summary><div><div class="collapsibleContent_i85q"><ul><li><code>x in s</code>, <code>x not in s</code> – находится ли элемент x в последовательности s (для строк и последовательностей байтов – является ли x подстрокой s)</li><li><code>s + t</code> – конкатенация последовательностей</li><li><code>s * n, n * s</code> – конкатенация n нерекурсивных копий последовательности s</li><li><code>s[i]</code> – i-й элемент последовательности s</li><li><code>s[i:j]</code> – срез последовательности s от i до j</li><li><code>s[i:j:k]</code> – срез последовательности s от i до j с шагом k</li><li><code>len(s)</code> – длина последовательности</li><li><code>min(s)</code> – минимальный элемент последовательности</li><li><code>max(s)</code> – максимальный элемент последовательности</li><li><code>s.index(x[, i[, j]])</code> – индекс первого вхождения x (опционально – начиная с позиции i и до позиции j)</li><li><code>s.count(x)</code> – общее количество вхождений x в s</li><li><code>sum(s)</code> – сумма элементов последовательности</li></ul><p>Неизменяемые последовательности обычно реализуют операцию hash(s) – хеш-значение объекта.</p><p>Большинство изменяемых последовательностей поддерживают следующие операции:</p><ul><li><code>s[i] = x</code> – элемент с индексом i заменяется на x</li><li><code>s[i:j] = t</code>, <code>s[i:j:k] = t</code> – элементы с индексами от i до j (с шагом k) заменяются содержимым итерабельного объекта t</li><li><code>del s[i:j]</code>, <code>del s[i:j:k]</code> – удаление соответствующих элементов из последовательности</li><li><code>s.append(x)</code> – добавление x в конец последовательности</li><li><code>s.clear()</code> – удаление всех элементов последовательности</li><li><code>s.copy()</code> – нерекурсивная копия последовательности</li><li><code>s.extend(t)</code> – добавление всех элементов итерабельного объекта в конец последовательности</li><li><code>s.insert(i, x)</code> – вставка элемента x по индексу i</li><li><code>s.pop()</code>, <code>s.pop(i)</code> – возврат значения по индексу i (по умолчанию – последний элемент) и удаление его из последовательности</li><li><code>s.remove(x)</code> – удаление первого вхождения x</li><li><code>s.reverse()</code> – разворот последовательности в обратном порядке</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Какие виды строк бывают в питоне</summary><div><div class="collapsibleContent_i85q"><ul><li>Во второй ветке два типа: однобайтные строки и Юникод представлены классами str и unicode соответственно. </li><li>В третьем Питоне есть один вид строк str, который представляет собой Юникод. Однобайтных строк нет, вместо них есть тип bytes, то есть цепочка байт.</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Можно ли изменить отдельный символ внутри строки</summary><div><div class="collapsibleContent_i85q"><p>Нет, строки неизменяемы. Операции замены, форматирования и конкатенации возвращают новую строку.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как соединить список строк в одну. Как разбить строку на список строк</summary><div><div class="collapsibleContent_i85q"><p>Чтобы соединить, нужен метод строки <code>.join()</code>. Чтобы разбить, метод <code>.split()</code>.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как кодировать и декодировать строки</summary><div><div class="collapsibleContent_i85q"><p>Кодировать – перевести Юникод в байтовую строку. Вызвать метод <code>.encode()</code> у строки.</p><p>Декодировать – восстановить строку из цепочки байт. Вызвать метод <code>.decode()</code> у объекта <code>str</code> или <code>bytes</code> (версии Питона 2 и 3 соответственно).</p><p>В обоих случаях явно передавать кодировку, иначе будет использована та, что определена в системе по умолчанию. Быть готовым поймать исключения <code>UnicodeEncodeError</code>, <code>UnicodeDecodeError</code>.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Чем список отличается от кортежа</summary><div><div class="collapsibleContent_i85q"><p>Списки – это изменяемые последовательности, обычно используемые для хранения однотипных данных (хотя Python не запрещает хранить в них данные разных типов). Представлены классом list.</p><p>Кортежи – это неизменяемые последовательности, обычно используемые, чтобы хранить разнотипные данные. Представлены классом tuple.</p><p>На уровне языка отличаются тем, что в кортеж нельзя добавить или убрать элемент. На уровне интерпретатора различий нет. Обе коллекции представлены массивом указателей на структуру <code>PyObject</code>.</p><p>Для списка определены функции, которые добавляют в такой массив новый элемент, удаляют имеющийся, соединяют два массива в один. Они вызываются методами списка <code>.append()</code>, <code>.pop()</code>, <code>.sort()</code> и т.д.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что такое диапазон</summary><div><div class="collapsibleContent_i85q"><p>Диапазоны – неизменяемые последовательности чисел, которые задаются началом, концом и шагом. Представлены классом range (в Python 2 – xrange; range в Python 2 – это функция, которая возвращает список).
Параметры конструктора должны быть целыми числами (либо экземпляры класса int, либо любой объект с методом <code>__index__</code>)
Поддерживает все общие для последовательностей операции, кроме конкатенации и повторения, а также, в версиях Python до 3.2, срезов и отрицательных индексов.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как сделать список уникальным (без повторяющихся элементов)</summary><div><div class="collapsibleContent_i85q"><p>Вариант со множеством. Не гарантирует порядок элементов. Порядок сохраняется только для маленьких списков.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Вариант с OrderedDict. Гарантирует порядок элементов.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> collections </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> OrderedDict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OrderedDict</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fromkeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Вариант с циклом. Медленно, но гарантирует порядок. Подходит, если элементы нельзя помещать внутрь множества (например, словари).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">res </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> x </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Есть кортеж из трех элементов. Назначить переменным a, b, c его значения</summary><div><div class="collapsibleContent_i85q"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">`a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как сравниваются последовательности</summary><div><div class="collapsibleContent_i85q"><p>Две последовательности равны, если они имеют одинаковый тип, равную длину и соответствующие элементы обоих последовательностей равны.</p><p>Последовательности одинаковых типов можно сравнивать.<br>
<!-- -->Сравнения происходят в лексикографическом порядке: последовательность меньшей длины меньше, чем последовательность большей длины, если же их длины равны, то результат сравнения равен результату сравнения первых отличающихся элементов.</p></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="множества-и-отображения">Множества и отображения<a href="#множества-и-отображения" class="hash-link" aria-label="Прямая ссылка на Множества и отображения" title="Прямая ссылка на Множества и отображения">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как понять хешируемый ли объект</summary><div><div class="collapsibleContent_i85q"><p>Объект называется хешируемым, если он имеет хеш-значение (целое число), которое никогда не изменяется на протяжении его жизненного цикла и возвращается методом <code>__hash__()</code>, и может сравниваться с другими объектами (реализует метод <code>__eq__()</code>).<br>
<!-- -->Равные хешируемые объекты должны иметь равные хеш-значения.</p><ul><li>Все стандартные неизменяемые объекты хешируемые. </li><li>Все стандартные изменяемые объекты не хешируемые.</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что такое множество</summary><div><div class="collapsibleContent_i85q"><p>Множество – это неупорядоченная коллекция хешируемых объектов, которые не повторяются.<br>
<!-- -->В множествах нет понятия позиции элемента. Соответственно, они не поддерживают индексацию и срезы.</p><p>Встроенные классы множеств:</p><ul><li>set (изменяемое множество),</li><li>frozenset (неизменяемое множество). </li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Для чего применяются множества</summary><div><div class="collapsibleContent_i85q"><p>Обычно используются для проверки элемента на вхождение в множество и удаление повторений элементов и выполнения таких операций, как объединение, пересечение, разница и симметрическая разница.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Какие операции можно производить над множествами</summary><div><div class="collapsibleContent_i85q"><ul><li><code>set([iterable])</code>, <code>frozenset([iterable])</code> – создание множества (пустого или из элементов итерабельного объекта)</li><li><code>len(s)</code> – количество элементов множества</li><li><code>x in s</code>, <code>x not in s</code> – проверка нахождения элемента в множестве</li><li><code>s.isdisjoint(t)</code> – проверка того, что данное множество не имеет общих элементов с заданным</li><li><code>s.issubset(t)</code>, <code>s &lt;= t</code> – проверка того, что все элементы множества s являются элементами множества t</li><li><code>s &lt; t</code> – проверка того, что s &lt;= t и s != t</li><li><code>s.isuperset(t)</code>, <code>s &gt;= t</code> – проверка того, что все элементы множества t являются элементами множества s</li><li><code>s &gt; t</code> – проверка того, что <code>s &gt;= t</code> и <code>s != t</code></li><li><code>s.union(t, ...)</code>, <code>s | t | ...</code> – создание нового множества, которое является объединением данных множеств</li><li><code>s.intersection(t, ...)</code>, <code>s &amp; t &amp; ...</code> – создание нового множества, которое является пересечением данных множеств</li><li><code>s.difference(t, ...)</code>, <code>s - t - ...</code> – создание нового множества, которое является разницей данных множеств</li><li><code>s.symmetric_difference(t)</code>, <code>s ^ t</code> – создание нового множества, которое является симметрической разницей данных множеств (то есть, разница объединения и пересечения множеств)</li><li><code>s.copy()</code> – неполная копия множества s</li></ul><p>Операции над множествами, которые являются методами, принимают в качестве аргументов любые итерабельные объекты. Операции над множествами, записанные в виде бинарных операций, требуют, чтобы второй операнд операции тоже был множеством, и возвращают множество того типа, которым было первое множество.</p><p>Операции над изменяемыми множествами:</p><ul><li><code>s.update(t, ...)</code>, <code>s |= t | ...</code> – добавить в данное множество элементы из других множеств</li><li><code>s.intersection_update(t, ...)</code>, <code>s &amp;= t &amp; ...</code> – оставить в данном множестве только те элементы, которые есть и в других множествах</li><li><code>s.difference_update(t, ...)</code>, <code>s -= t | ...</code> – удалить из данного множества те элементы, которые есть в других множествах</li><li><code>s.symmetric_difference_update(t)</code>, <code>s ^= t</code> – оставить или добавить в s элементы, которые есть либо в s, либо в t, но не в обоих множествах</li><li><code>s.add(element)</code> – добавить новый элемент в множество</li><li><code>s.remove(element)</code> – удалить элемент из множества; если такого элемента нет, возникает исключение KeyError</li><li><code>s.discard(element)</code> – удалить элемент из множества, если он в нём находится</li><li><code>s.pop()</code> – удалить из множества и вернуть произвольный элемент; если множество пустое, возникает исключение KeyError</li><li><code>s.clear()</code> – удалить все элементы множества.</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как происходит проверка множеств на равенство</summary><div><div class="collapsibleContent_i85q"><p>Проверка множеств на равенство происходит поэлементно, независимо от типов множеств.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что такое отображение</summary><div><div class="collapsibleContent_i85q"><p>Отображение (mapping) – это объект-контейнер, который поддерживает произвольный доступ к элементам по ключам и описывает все методы, описанные в абстрактном базовом классе <code>collections.Mapping</code> (<code>get()</code>, <code>items()</code>, <code>keys()</code>, <code>values()</code>) или <code>collections.MutableMapping</code> (<code>clear()</code>, <code>get()</code>, <code>items()</code>, <code>keys()</code>, <code>pop()</code>, <code>popitem()</code>, <code>setdefault()</code>, <code>update()</code>, <code>values()</code>).</p><p>К отображениям относятся классы <code>dict</code>, <code>collections.defaultdict</code>, <code>collections.OrderedDict</code> и <code>collections.Counter</code>.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Какие нюансы есть в использовании чисел как ключей</summary><div><div class="collapsibleContent_i85q"><p>Числовые ключи в словарях подчиняются правилам сравнения чисел. Таким образом, <code>int(1)</code> и <code>float(1.0)</code> считаются одинаковым ключом. Однако из-за того, что значения типа float сохраняются приближенно, не рекомендуется использовать их в качестве ключей.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;yes&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;no&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1.0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;maybe&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token boolean" style="color:#005CC5">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;maybe&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Какие операции можно производить над отображениями</summary><div><div class="collapsibleContent_i85q"><ul><li><code>len(d)</code> – количество элементов.</li><li><code>d[key]</code> – получение значения с ключом key. Если такой ключ не существует и отображение реализует специальный метод <code>__missing__(self, key)</code>, то он вызывается. Если ключ не существует и метод <code>__missing__</code> не определён, выбрасывается исключение KeyError.</li><li><code>d[key] = value</code> – изменить значение или создать новую пару ключ-значение, если ключ не существует.</li><li><code>key in d</code>, <code>key not in d</code> – проверка наличия ключа в отображении.</li><li><code>iter(d)</code> – то же самое, что iter(d.keys()).</li><li><code>clear()</code> – удалить все элементы словаря.</li><li><code>copy()</code> – создать неполную копию словаря.</li><li><code>(метод класса) dict.fromkeys(sequence[, value])</code> – создаёт новый словарь с ключами из последовательности sequence и заданным значением (по умолчанию – None).</li><li><code>d.get(key[, default])</code> – безопасное получение значения по ключу (никогда не выбрасывает KeyError). Если ключ не найден, возвращается значение default (по-умолчанию – None).</li><li><code>d.items()</code> – в Python 3 возвращает объект представления словаря, соответствующий парам (двухэлементным кортежам) вида (ключ, значение). В Python 2 возвращает соответствующий список, а метод iteritems() возвращает итератор. Аналогичный метод в Python 2.7 – viewitems().</li><li><code>d.keys()</code> – в Python 3 возвращает объект представления словаря, соответствующий ключам словаря. В Python 2 возвращает соответствующий список, а метод iterkeys() возвращает итератор. Аналогичный метод в Python 2.7 – viewkeys().</li><li><code>d.pop(key[, default])</code> – если ключ key существует, удаляет элемент из словаря и возвращает его значение. Если ключ не существует и задано значение default, возвращается данное значение, иначе выбрасывается исключение KeyError.</li><li><code>d.popitem()</code> – удаляет произвольную пару ключ-значение и возвращает её. Если словарь пустой, возникает исключение KeyError. Метод полезен для алгоритмов, которые обходят словарь, удаляя уже обработанные значения (например, определённые алгоритмы, связанные с теорией графов).</li><li><code>d.setdefault(key[, default])</code> – если ключ key существует, возвращает соответствующее значение. Иначе создаёт элемент с ключом key и значением default. default по умолчанию равен None.</li><li><code>d.update(mapping)</code> – принимает либо другой словарь или отображение, либо итерабельный объект, состоящий из итерабельных объектов – пар ключ-значение, либо именованные аргументы. Добавляет соответствующие элементы в словарь, перезаписывая элементы с существующими ключами.</li><li><code>d.values()</code> – в Python 3 возвращает объект представления словаря, соответствующий значениям. В Python 2 возвращает соответствующий список, а метод itervalues() возвращает итератор. Аналогичный метод в Python 2.7 – viewvalues().</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что возвращает метод items</summary><div><div class="collapsibleContent_i85q"><p>Объекты, возвращаемые методами <code>items()</code>, <code>keys()</code> и <code>values()</code> (<code>viewitems()</code>, <code>viewkeys()</code>, <code>viewvalues()</code> в Python 2.7) – это объекты <em>представления словаря</em>. Они предоставляют динамическое представление элементов словаря, то есть изменения данного словаря автоматически отображаются и на этих объектах.</p><p>Операции с представлениями словарей:</p><ul><li><code>iter(dictview)</code> – получение итератора по ключам, значениям или парам ключей и значений. Все представления словарей при итерировании возвращают элементы словаря в одинаковом порядке. При попытке изменить словарь во время итерирования может возникнуть исключение RuntimeError</li><li><code>len(dictview)</code> – количество элементов в словаре.</li><li><code>x in dictview</code> – проверка существования ключа, значения или пары ключ-значение в словаре.</li></ul></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как отсортировать список словарей по определенному полю</summary><div><div class="collapsibleContent_i85q"><p>Метод списка <code>.sort()</code> и встроенная функция <code>sorted()</code> принимают параметр <code>key</code>.</p><p>Им должен быть вызываемый объект, который принимает очередной элемент (в нашем случае словарь) и возвращает значение-критерий сортировки.</p><p>Код ниже показывает, как отсортировать список людей по возрасту:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">users </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">30</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">20</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token operator" style="color:#D73A49">=</span><span class="token keyword" style="color:#CF222E">lambda</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">20</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;age&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">30</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что может являться ключом словаря. Что не может. Почему</summary><div><div class="collapsibleContent_i85q"><p>Ключом словаря может быть любой хешируемый неизменяемый объект: число, строка, datetime, функция и даже модуль. Такие объекты имеют метод <code>__hash__()</code>, который однозначно сопоставляет объект с некоторым числом. По этому числу словарь ищет значение для ключа.</p><p>Списки, словари и множества изменяемы и не имеют метода хеширования. При подстановке их в словарь возникнет ошибка.</p><p>Хеш кортежа вычисляется рекурсивно по всем элементам. Так, кортеж</p><p><code>(1, (True, (42, (&#x27;hello&#x27;, ))))</code></p><p>состоит только из неизменяемых элементов, поэтому может быть ключом. Однако, такой кортеж</p><p><code>(1, (True, (42, ({&#x27;hello&#x27;: &#x27;world&#x27;}, ))))</code></p><p>содержит глубоко внутри словарь, поэтому хеш не может быть рассчитан.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Есть два списка – ключи и значения. Как составить из них словарь</summary><div><div class="collapsibleContent_i85q"><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">keys </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;bar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;baz&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vals </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vals</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;baz&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;bar&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Функция <code>zip</code> отдает список пар N-ых элементов. Конструктор <code>dict</code> принимает список пар. Каждую пару он рассматривает как ключ и значение соответственно.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Как работает хэш-таблица</summary><div><div class="collapsibleContent_i85q"><p>Хэш-таблица это разреженный массив (массив, в котором имеются незаполненные позиции). В стандартных англоязычных учебниках ячейки хэш-таблицы называются <code>bucket</code>.</p><p>В хэш-таблице dict каждому элементу соотвествует ячейка, содержащая два поля: ссылку на ключ и ссылку на значение элемента. Поскольку размер всех ячеек одинаков, доступ к отдельной ячейке производится по смещению.</p><p>Python стремится оставить не менее трети ячеек пустыми; если хэш-таблица становится чрезмерно заполненной, то она копируется в новый участок памяти, где есть место для большего числа ячеек.</p><p>Для помещения элемента в хэш-таблицу нужно первым делом вычислить хэш-значение ключа элемента. Это делает встроенная функция <code>hash()</code>.</p><p>Для выборки значения с помощью выражения <code>my_dict[search_key]</code> Python обращается к функции <code>hash(search_key)</code>, чтобы получить хэш-значение search_key, и использует несколько младших битов полученного числа как смещение ячейки относительно начала хэш-таблицы (сколько именно битов зависит от текущего размера таблицы). Если найденная ячейка пуста, возбуждается исключение <code>KeyError</code>. В противном случае в найденной ячейке есть какой-то элемент - пара <code>ключ:значение</code> - и тогда Python проверяет, верно ли то, что search_key == found_key. Если да, то элемент найден и возвращается found_value. Если же search_key и found_key не совпали, то имеет место <em>коллизия хэширования</em>. Для разрешения коллизии алгоритм берет различные биты хэш-значения, производит над ними определенные действия и использует результат как смещение другой ячейки.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Что такое коллизия</summary><div><div class="collapsibleContent_i85q"><p>Когда хеш-функция возвращает один и тот же ответ для разных данных.</p></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Где будет быстрее поиск, а где перебор и почему: dict, list, set, tuple</summary><div><div class="collapsibleContent_i85q"><p>Поиск будет быстрее в dict и set, потому что это хэш-таблицы, доступ к элементу которых выполняется за O(1). Для list и tuple поиск будет выполняться в среднем за O(n).</p><p>Исключение работает только для очень маленьких списков длиной до 5 элементов. В этом случае интерпретатору будет быстрей пробежаться по списку, чем считать хеш.</p><p>В Python 2 методы словаря <code>keys</code>, <code>values</code>, <code>items</code> возвращают список. Тоесть перед итерацией по словарю (или сету) интерпретатор сначала создает новый список, что занимает дополнительное время и память, но после создания это уже обыкновенный список. Тоесть в Python 2 итерация по словарям и сетам выполняется дольше, за счет создания нового списка и копирования в него элементов.</p><p>В Python 3 эти методы создают объект-представление. Это определенно происходит быстрее чем создание нового списка в Python2. Но итерирование по такому представлению должно происходить немного дольше, чем по списку из-за того что данные в словарях хранятся разреженно (редко, негусто). В подтверждение вышесказанного (Python 3):</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> l </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> d </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fromkeys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> s </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">iter_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">         </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">iter_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">         </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">iter_set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">     </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">         </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> timeit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timeit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iter_list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> number</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#005CC5">6.727667486004066</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> timeit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timeit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iter_dict</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> number</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#005CC5">9.293120226997416</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> timeit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timeit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iter_set</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> number</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#005CC5">8.627948219014797</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="функции">Функции<a href="#функции" class="hash-link" aria-label="Прямая ссылка на Функции" title="Прямая ссылка на Функции">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-args-kwargs-в-каких-случаях-они-требуются">Что такое args, kwargs. В каких случаях они требуются<a href="#что-такое-args-kwargs-в-каких-случаях-они-требуются" class="hash-link" aria-label="Прямая ссылка на Что такое args, kwargs. В каких случаях они требуются" title="Прямая ссылка на Что такое args, kwargs. В каких случаях они требуются">​</a></h3><p>Выражения <code>*args</code> и <code>**kwargs</code> объявляют в сигнатуре функции. Они означают, что внутри функции будут доступны переменные с именами <code>args</code> и <code>kwargs</code> (без звездочек). Можно использовать другие имена, но это считается дурным тоном.</p><p><code>args</code> – это кортеж, который накапливает позиционные аргументы. <code>kwargs</code> – словарь именованных аргументов, где ключ – имя параметра, значение – значение параметра.</p><p><strong>Важно:</strong> если в функцию не передано никаких параметров, переменные будут соответственно равны пустому кортежу и пустому словарю, а не <code>None</code>.</p><p>Пожалуйста, не путайте кортеж со списком. Следующий вопрос объясняет, почему.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="почему-использовать-изменяемые-объекты-как-параметры-по-умолчанию-плохо-приведите-пример-плохого-случая-как-исправить">Почему использовать изменяемые объекты как параметры по-умолчанию плохо. Приведите пример плохого случая. Как исправить<a href="#почему-использовать-изменяемые-объекты-как-параметры-по-умолчанию-плохо-приведите-пример-плохого-случая-как-исправить" class="hash-link" aria-label="Прямая ссылка на Почему использовать изменяемые объекты как параметры по-умолчанию плохо. Приведите пример плохого случая. Как исправить" title="Прямая ссылка на Почему использовать изменяемые объекты как параметры по-умолчанию плохо. Приведите пример плохого случая. Как исправить">​</a></h3><p>Функция создается однажды при загрузке модуля. Именованные параметры и их дефолтные значения тоже создаются один раз и хранятся в одном из полей объекта-функции.</p><p>В нашем примере <code>bar</code> равен пустому списку. Список – изменяемая коллекция, поэтому значение <code>bar</code> может изменяться от вызова к вызову. Пример:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token operator" style="color:#D73A49">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Хорошим тоном считается указывать параметру пустое неизменяемое значение, например <code>0</code>, <code>None</code>, <code>&#x27;&#x27;</code>, <code>False</code>. В теле функции проверять на заполненность и создавать новую коллекцию:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bar</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> bar </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Сказанное выше актуально в т.ч. для множеств и словарей.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="можно-ли-передавать-функцию-в-качестве-аргумента-другой-функции">Можно ли передавать функцию в качестве аргумента другой функции<a href="#можно-ли-передавать-функцию-в-качестве-аргумента-другой-функции" class="hash-link" aria-label="Прямая ссылка на Можно ли передавать функцию в качестве аргумента другой функции" title="Прямая ссылка на Можно ли передавать функцию в качестве аргумента другой функции">​</a></h3><p>Можно, функция в Питоне объект первого порядка: допускает присваивание, передачу в функцию, удаление.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="можно-ли-объявлять-функцию-внутри-другой-функции-где-она-будет-видна">Можно ли объявлять функцию внутри другой функции. Где она будет видна<a href="#можно-ли-объявлять-функцию-внутри-другой-функции-где-она-будет-видна" class="hash-link" aria-label="Прямая ссылка на Можно ли объявлять функцию внутри другой функции. Где она будет видна" title="Прямая ссылка на Можно ли объявлять функцию внутри другой функции. Где она будет видна">​</a></h3><p>Можно. Такая функция будет видна только внутри первой функции.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-лямбды-каковы-их-особенности">Что такое лямбды. Каковы их особенности<a href="#что-такое-лямбды-каковы-их-особенности" class="hash-link" aria-label="Прямая ссылка на Что такое лямбды. Каковы их особенности" title="Прямая ссылка на Что такое лямбды. Каковы их особенности">​</a></h3><p>Это анонимные функции. Они не резервируют имени в пространстве имен. Лямбды
часто передают в функции <code>map</code>, <code>reduce</code>, <code>filter</code>.</p><p>Лямбды в Питоне могут состоять только из одного выражения. Используя синтаксис
скобок, можно оформить тело лямбды в несколько строк.</p><p>Использовать точку с запятой для разделения операторов нельзя.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="допустимы-ли-следующие-выражения">Допустимы ли следующие выражения<a href="#допустимы-ли-следующие-выражения" class="hash-link" aria-label="Прямая ссылка на Допустимы ли следующие выражения" title="Прямая ссылка на Допустимы ли следующие выражения">​</a></h3><ul><li><code>nope = lambda: pass</code></li><li><code>riser = lambda x: raise Exception(x)</code></li></ul><p>Нет, при загрузке модуля выскочит исключение <code>SyntaxError</code>. В теле лямбды может
быть только выражение. <code>pass</code> и <code>raise</code> являются операторами.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-передаются-значения-аргументов-в-функцию-или-метод">Как передаются значения аргументов в функцию или метод<a href="#как-передаются-значения-аргументов-в-функцию-или-метод" class="hash-link" aria-label="Прямая ссылка на Как передаются значения аргументов в функцию или метод" title="Прямая ссылка на Как передаются значения аргументов в функцию или метод">​</a></h3><ul><li><a href="https://docs.python.org/3/faq/programming.html#how-do-i-write-a-function-with-output-parameters-call-by-reference" target="_blank" rel="noopener noreferrer">How do I write a function with output parameters (call by reference)?</a></li><li><a href="https://habr.com/ru/post/422951/" target="_blank" rel="noopener noreferrer">Интересности и полезности python. Часть 3</a></li></ul><p>В таких языках как C++ есть переменные, хранящиеся на стеке и в динамической памяти. При вызове функции мы помещаем все аргументы на стек, после чего передаём управление функции. Она знает размеры и смещения переменных на стеке, соответственно может их правильно интерпретировать.
При этом у нас есть два варианта: скопировать на стек память переменной или положить ссылку на объект в динамической памяти (или на более высоких уровнях стека).
Очевидно, что при изменении значений на стеке функции, значения в динамической памяти не поменяются, а при изменении области памяти по ссылке, мы модифицируем общую память, соответственно все ссылки на эту же область памяти «увидят» новое значение.</p><p>В python отказались от подобного механизма, заменой служит механизм <em>связывания (assignment)</em> имени переменной с объектом, например при создании переменной:
<code>var = &quot;john&quot;</code></p><p>Интерпретатор создаёт объект «john» и «имя» var, а затем связывает объект с данным именем.
При вызове функции, новых объектов не создаётся, вместо этого в её области видимости создаётся имя, которое связывается с существующим объектом.
Но в python есть изменяемые и неизменяемые типы. Ко вторым, например, относятся числа: при арифметических операциях существующие объекты не меняются, а создаётся новый объект, с которым потом связывается существующее имя. Если же со старым объектом после этого не связано ни одного имени, оно будет удалено с помощью механизма подсчёта ссылок.
Если же имя связано с переменной изменяемого типа, то при операциях с ней изменяется память объекта, соответственно все имена, связанные с данной областью памяти «увидят» изменения.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-замыкание">Что такое замыкание<a href="#что-такое-замыкание" class="hash-link" aria-label="Прямая ссылка на Что такое замыкание" title="Прямая ссылка на Что такое замыкание">​</a></h3><p>Синтаксически это выглядит как функция, находящаяся целиком в теле другой функции. При этом вложенная внутренняя функция содержит ссылки на локальные переменные внешней функции. Каждый раз при выполнении внешней функции происходит создание нового экземпляра внутренней функции, с новыми ссылками на переменные внешней.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="итераторы-и-генераторы">Итераторы и генераторы<a href="#итераторы-и-генераторы" class="hash-link" aria-label="Прямая ссылка на Итераторы и генераторы" title="Прямая ссылка на Итераторы и генераторы">​</a></h2><ul><li><a href="https://xakep.ru/2014/10/06/generatora-iteratory-python/" target="_blank" rel="noopener noreferrer">Генераторы-итераторы Python</a></li><li><a href="https://habr.com/ru/post/337314/" target="_blank" rel="noopener noreferrer">Итерируемый объект, итератор и генератор</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-контейнер">Что такое контейнер<a href="#что-такое-контейнер" class="hash-link" aria-label="Прямая ссылка на Что такое контейнер" title="Прямая ссылка на Что такое контейнер">​</a></h3><p>Контейнер – это тип данных, который инкапсулирует в себе значения других типов. Списки, кортежи, множества, словари и т.д. являются контейнерами.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-итерабельный-объект">Что такое итерабельный объект<a href="#что-такое-итерабельный-объект" class="hash-link" aria-label="Прямая ссылка на Что такое итерабельный объект" title="Прямая ссылка на Что такое итерабельный объект">​</a></h3><p><em>Итерабельный объект</em> (в оригинальной терминологии – «iterable») – это объект, который может возвращать значения по одному за раз.
Примеры: все контейнеры и последовательности (списки, строки и т.д.), файлы, а также экземпляры любых классов, в которых определён метод <code>__iter__()</code> или <code>__getitem__()</code>.
Итерабельные объекты могут быть использованы внутри цикла <code>for</code>, а также во многих других случаях, когда ожидается последовательность (функции <code>sum()</code>, <code>zip()</code>, <code>map()</code> и т.д.).</p><p><strong>Подробнее</strong>:</p><p>Рассмотрим итерируемый объект (<code>Iterable</code>). В стандартной библиотеке он объявлен как абстрактный класс <code>collections.abc.Iterable</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Iterable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">metaclass</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">ABCMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __slots__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@abstractmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__iter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">while</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">False</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">yield</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__subclasshook__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> cls </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> Iterable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> _check_methods</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__iter__&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> NotImplemented</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>У него есть абстрактный метод <code>__iter__</code> который должен вернуть объект итератора. И метод <code>__subclasshook__</code> который проверяет наличие у класса метод <code>__iter__</code>. Таким образом, получается, что итерируемый объект это любой объект который реализует метод <code>__iter__</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">SomeIterable1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">abc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Iterable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__iter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">SomeIterable2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__iter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">isinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SomeIterable1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">abc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Iterable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">isinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SomeIterable2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">abc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Iterable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Но есть один момент, это функция <code>iter()</code>. Именно эту функцией использует например цикл for для получения итератора. Функция <code>iter()</code> в первую очередь для получения итератора из объекта, вызывает его метод <code>__iter__</code>. Если метод не реализован, то она проверяет наличие метода <code>__getitem__</code> и если он реализован, то на его основе создается итератор. <code>__getitem__</code> должен принимать индекс с нуля. Если не реализован ни один из этих методов, тогда будет вызвано исключение <code>TypeError</code>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> string </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> ascii_letters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">SomeIterable3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__getitem__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> ascii_letters</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> SomeIterable3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-итератор">Что такое итератор<a href="#что-такое-итератор" class="hash-link" aria-label="Прямая ссылка на Что такое итератор" title="Прямая ссылка на Что такое итератор">​</a></h3><p><em>Итератор</em> (iterator) – это объект, который представляет поток данных. Повторяемый вызов метода <code>__next__()</code> (<code>next()</code> в Python 2) итератора или передача его встроенной функции <code>next()</code> возвращает последующие элементы потока.</p><p>Если больше не осталось данных, выбрасывается исключение <code>StopIteration</code>. После этого итератор исчерпан и любые последующие вызовы его метода <code>__next__()</code> снова генерируют исключение <code>StopIteration</code>.</p><p>Итераторы обязаны иметь метод <code>__iter__</code>, который возвращает сам объект итератора, так что любой итератор также является итерабельным объектом и может быть использован почти везде, где принимаются итерабельные объекты.</p><p><strong>Подробнее:</strong></p><p>Итераторы представлены абстрактным классом <code>collections.abc.Iterator</code>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Iterator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Iterable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __slots__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@abstractmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__next__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#C6105F">&#x27;Return the next item from the iterator. When exhausted, raise StopIteration&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> StopIteration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__iter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__subclasshook__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> cls </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> Iterator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> _check_methods</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__iter__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__next__&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> NotImplemented</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>__next__</code> Возвращает следующий доступный элемент и вызывает исключение <code>StopIteration</code>, когда элементов не осталось.
<code>__iter__</code> Возвращает <code>self</code>. Это позволяет использовать итератор там, где ожидается итерируемых объект, например <code>for</code>.
<code>__subclasshook__</code> Проверяет наличие у класса метода <code>__iter__</code> и <code>__next__</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-генератор">Что такое генератор<a href="#что-такое-генератор" class="hash-link" aria-label="Прямая ссылка на Что такое генератор" title="Прямая ссылка на Что такое генератор">​</a></h3><p>В зависимости от контекста, может означать либо функцию-генератор, либо итератор генератора (чаще всего, последнее).
Методы <code>__iter__</code> и <code>__next__</code> у генераторов создаются автоматически.</p><p>С точки зрения реализации, <em>генератор</em> в Python — это языковая конструкция, которую можно реализовать двумя способами: как функция с ключевым словом <code>yield</code> или как генераторное выражение. В результате вызова функции или вычисления выражения, получаем объект-генератор типа <code>types.GeneratorType</code>. Канонический пример - генератор, порождающий последовательность чисел Фибоначчи, которая, будучи бесконечна, не смогла бы поместиться ни в одну коллекцию. Иногда термин применяется для самой генераторной функции, а не только объекта, возвращенного ей в качестве результата.</p><p>Так как в объекте-генераторе определены методы <code>__next__</code> и <code>__iter__</code>, то есть реализован протокол итератора, с этой точки зрения, в Python любой генератор является итератором.</p><p>Когда выполнение функции-генераторы завершается (при помощи ключевого слова <code>return</code> или достижения конца функции), возникает исключение <code>StopIteration</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-генераторная-функция">Что такое генераторная функция<a href="#что-такое-генераторная-функция" class="hash-link" aria-label="Прямая ссылка на Что такое генераторная функция" title="Прямая ссылка на Что такое генераторная функция">​</a></h3><p><em>Генераторная функция</em> - функция, в теле которой встречается ключевое слово <code>yield</code>. Будучи вызвана, такая функция возвращает объект-генератор (generator object) (итератор генератора (generator iterator)).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делает-yield">Что делает yield<a href="#что-делает-yield" class="hash-link" aria-label="Прямая ссылка на Что делает yield" title="Прямая ссылка на Что делает yield">​</a></h3><p><code>yield</code> замораживает состояние функции-генератора и возвращает текущее значение. После следующего вызова <code>__next__()</code> функция-генератор продолжает своё выполнение с того места, где она была приостановлена.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-отличие-x-for-x-in-y-от-x-for-x-in-y">В чем отличие <!-- -->[<!-- -->x for x in y<!-- -->]<!-- --> от (x for x in y)<a href="#в-чем-отличие-x-for-x-in-y-от-x-for-x-in-y" class="hash-link" aria-label="Прямая ссылка на в-чем-отличие-x-for-x-in-y-от-x-for-x-in-y" title="Прямая ссылка на в-чем-отличие-x-for-x-in-y-от-x-for-x-in-y">​</a></h3><p>Первое выражение возвращает список (списковое включение), второе – генератор.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-особенного-в-генераторе">Что особенного в генераторе<a href="#что-особенного-в-генераторе" class="hash-link" aria-label="Прямая ссылка на Что особенного в генераторе" title="Прямая ссылка на Что особенного в генераторе">​</a></h3><p>Генератор хранит в памяти не все элементы, а только внутреннее состояние для вычисления очередного элемента. На каждом шаге можно вычислить только следующий элемент, но не предыдущий. Пройти генератор в цикле можно только один раз.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-объявить-генератор">Как объявить генератор<a href="#как-объявить-генератор" class="hash-link" aria-label="Прямая ссылка на Как объявить генератор" title="Прямая ссылка на Как объявить генератор">​</a></h3><ul><li>использовать синтаксис <code>(x for x in seq)</code></li><li>оператор <code>yield</code> в теле функции вместо <code>return</code></li><li>встроенная функция <code>iter</code>, которая вызывает у объекта метод <code>__iter__()</code>. Этот метод должен возвращать генератор.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-получить-из-генератора-список">Как получить из генератора список<a href="#как-получить-из-генератора-список" class="hash-link" aria-label="Прямая ссылка на Как получить из генератора список" title="Прямая ссылка на Как получить из генератора список">​</a></h3><p>Передать его в конструктор списка: <code>list(x for x in some_seq)</code>. Важно, что после этого по генератору уже нельзя будет итерироваться.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-подгенератор">Что такое подгенератор<a href="#что-такое-подгенератор" class="hash-link" aria-label="Прямая ссылка на Что такое подгенератор" title="Прямая ссылка на Что такое подгенератор">​</a></h3><p>В Python 3 существуют так называемые подгенераторы (subgenerators). Если в функции-генераторе встречается пара ключевых слов <code>yield from</code>, после которых следует объект-генератор, то данный генератор делегирует доступ к подгенератору, пока он не завершится (не закончатся его значения), после чего продолжает своё исполнение.</p><p>На самом деле <code>yield</code> является выражением. Оно может принимать значения, которые отправляются в генератор. Если в генератор не отправляются значения, результат данного выражения равен <code>None</code>.</p><p><code>yield from</code> также является выражением. Его результатом является то значение, которое подгенератор возвращает в исключении <code>StopIteration</code> (для этого значение возвращается при помощи ключевого слова <code>return</code>).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-методы-есть-у-генераторов">Какие методы есть у генераторов<a href="#какие-методы-есть-у-генераторов" class="hash-link" aria-label="Прямая ссылка на Какие методы есть у генераторов" title="Прямая ссылка на Какие методы есть у генераторов">​</a></h3><ul><li><code>__next__()</code> – начинает или продолжает исполнение функции-генератора. Результат текущего yield-выражения будет равен None. Выполнение затем продолжается до следующего yield-выражения, которое передаёт значение туда, где был вызван <code>__next__</code>. Если генератор завершается без возврата значения при помощи <code>yield</code>, возникает исключение <code>StopIteration</code>. Метод обычно вызывается неявно, то есть циклом <code>for</code> или встроенной функцией <code>next()</code>.</li><li><code>send(value)</code> – продолжает выполнение и отправляет значение в функцию-генератор. Аргумент value становится значением текущего yield-выражения. Метод <code>send()</code> возвращает следующее значение, возвращённое генератором, или выбрасывает исключение <code>StopIteration</code>, если генератор завершается без возврата значения. Если <code>send()</code> используется для запуска генератора, то единственным допустимым значением является <code>None</code>, так как ещё не было выполнено ни одно yield-выражение, которому можно присвоить это значение.</li><li><code>throw(type[, value[, traceback]])</code> – выбрасывает исключение типа type в месте, где был приостановлен генератор, и возвращает следующее значение генератора (или выбрасывает <code>StopIteration</code>). Если генератор не обрабатывает данное исключение (или выбрасывает другое исключение), то оно выбрасывается в месте вызова.</li><li><code>close()</code> – выбрасывает исключение <code>GeneratorExit</code> в месте, где был приостановлен генератор. Если генератор выбрасывает <code>StopIteration</code> (путём нормального завершения или по причине того, что он уже закрыт) или <code>GeneratorExit</code> (путём отсутствия обработки данного исключения), <code>close</code> просто возвращается к месту вызова. Если же генератор возвращает очередное значение, выбрасывается исключение <code>RuntimeError</code>. Метод <code>close()</code> ничего не делает, если генератор уже завершён.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="можно-ли-извлечь-элемент-генератора-по-индексу">Можно ли извлечь элемент генератора по индексу<a href="#можно-ли-извлечь-элемент-генератора-по-индексу" class="hash-link" aria-label="Прямая ссылка на Можно ли извлечь элемент генератора по индексу" title="Прямая ссылка на Можно ли извлечь элемент генератора по индексу">​</a></h3><p>Нет, будет ошибка. Генератор не поддерживает метод <code>__getitem__</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-возвращает-итерация-по-словарю">Что возвращает итерация по словарю<a href="#что-возвращает-итерация-по-словарю" class="hash-link" aria-label="Прямая ссылка на Что возвращает итерация по словарю" title="Прямая ссылка на Что возвращает итерация по словарю">​</a></h3><p>Ключ. Порядок следования ключей не гарантируется (в 3.6 гарантируется неофициально, в 3.7 гарантируется). Для маленьких словарей порядок будет тот же, что и в объявлении. Для больших порядок зависит от расположения элементов в памяти. Особый класс <code>OrderedDict</code> учитывает порядок добавления ключей.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> key </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;bar&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    process_key</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-итерировать-словарь-по-парам-ключ-значение">Как итерировать словарь по парам ключ-значение<a href="#как-итерировать-словарь-по-парам-ключ-значение" class="hash-link" aria-label="Прямая ссылка на Как итерировать словарь по парам ключ-значение" title="Прямая ссылка на Как итерировать словарь по парам ключ-значение">​</a></h3><p>Метод словаря <code>.items()</code> возвращает генератор кортежей <code>(key, value)</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-сопрограмма">Что такое сопрограмма<a href="#что-такое-сопрограмма" class="hash-link" aria-label="Прямая ссылка на Что такое сопрограмма" title="Прямая ссылка на Что такое сопрограмма">​</a></h3><p>Сопрограмма (англ. coroutine) — компонент программы, обобщающий понятие подпрограммы, который дополнительно поддерживает множество входных точек (а не одну, как подпрограмма) и остановку и продолжение выполнения с сохранением определённого положения.
Расширенные возможности генераторов в Python (выражения yield и yield from, отправка значений в генераторы) используются для реализации сопрограмм.
Сопрограммы полезны для реализации асинхронных неблокирующих операций и кооперативной многозадачности в одном потоке без использования функций обратного вызова (callback-функций) и написания асинхронного кода в синхронном стиле.
Python 3.5 включает в себе поддержку сопрограмм на уровне языка. Для этого используются ключевые слова async и await.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="классы-объекты">Классы, объекты<a href="#классы-объекты" class="hash-link" aria-label="Прямая ссылка на Классы, объекты" title="Прямая ссылка на Классы, объекты">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-получить-список-атрибутов-объекта">Как получить список атрибутов объекта<a href="#как-получить-список-атрибутов-объекта" class="hash-link" aria-label="Прямая ссылка на Как получить список атрибутов объекта" title="Прямая ссылка на Как получить список атрибутов объекта">​</a></h3><p>Функция <code>dir</code> возвращает список строк – полей объекта. Поле <code>__dict__</code> содержит словарь вида <code>{поле -&gt; значение}</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-магические-методы-для-чего-нужны">Что такое магические методы, для чего нужны<a href="#что-такое-магические-методы-для-чего-нужны" class="hash-link" aria-label="Прямая ссылка на Что такое магические методы, для чего нужны" title="Прямая ссылка на Что такое магические методы, для чего нужны">​</a></h3><p>Магическими метода называют методы, имена которых начинаются и заканчиваются двойным подчеркиванием. Магические они потому, что почти никогда не вызываются явно. Их вызывают встроенные функции или синтаксические конструкции. Например, функция <code>len()</code> вызывает метод <code>__len__()</code> переданного объекта. Метод <code>__add__(self, other)</code> вызывается автоматически при сложении оператором <code>+</code>.</p><p>Перечислим некоторые магические методы:</p><ul><li><code>__init__</code>: инициализатор класса</li><li><code>__add__</code>: сложение с другим объектом</li><li><code>__eq__</code>: проверка на равенство с другим объектом</li><li><code>__iter__</code>: возвращает итератор</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-в-классе-сослаться-на-родительский-класс">Как в классе сослаться на родительский класс<a href="#как-в-классе-сослаться-на-родительский-класс" class="hash-link" aria-label="Прямая ссылка на Как в классе сослаться на родительский класс" title="Прямая ссылка на Как в классе сослаться на родительский класс">​</a></h3><p>Функция <code>super</code> принимает класс и экземпляр:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NextClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FirstClass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NextClass</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="возможно-ли-множественное-наследование">Возможно ли множественное наследование<a href="#возможно-ли-множественное-наследование" class="hash-link" aria-label="Прямая ссылка на Возможно ли множественное наследование" title="Прямая ссылка на Возможно ли множественное наследование">​</a></h3><p>Да, можно указать более одного родителя в классе потомка.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-mro">Что такое MRO<a href="#что-такое-mro" class="hash-link" aria-label="Прямая ссылка на Что такое MRO" title="Прямая ссылка на Что такое MRO">​</a></h3><p><em>MRO</em> – method resolution order, порядок разрешения методов. Алгоритм, по которому следует искать метод в случае, если у класса два и более родителей.</p><p>В классических классах поиск при наследовании по ссылкам на имена осуществляется в следующем порядке:</p><ol><li>Сначала экземпляр</li><li>Затем его класс</li><li>Далее все суперклассы его класса с обходом сначала с глубину, а затем слева направо</li></ol><p>Используется первое обнаруженное вхождение. Такой порядок называется DFLR (Обход вглубину и слева направо).</p><p>При наследовании классов нового стиля применяется правило MRO (порядок разрешения методов), т.е линеаризованный обход дерева классов, причем вложенный элемент наследования становится доступным в атрибуте <code>__mro__</code> данного класса. Такой алгорим называется <em>C3-линеаризация</em>. Наследование по правилу MRO осуществляется приблизительно в следующем порядке.</p><ol><li>Перечисление всех классов, наследуемых экземпляром, по правилу поиска DFLR для классических классов, причем класс включается в результат поиска столько раз, сколько он встречается при обходе.</li><li>Просмотр в полученном списке дубликатов классов, из которых удаляются все, кроме последнего (крайнего справа) дубликата в списке.</li></ol><p>Упорядочение по правилу MRO применяется при наследовании и вызове встроенной функции super(), которая всегда вызывает следующий по правилу MRO класс (относительно точки вызова).</p><p><strong>Пример наследования в неромбовидных иерархаических деревьях:</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">D</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          attr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#  D:3   E:2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain">          </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#   |     |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">E</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          attr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#   B    C:1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">C</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">E</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">       attr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#    /   /</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">B</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain">          </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      A</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                         </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      X</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># DFLR = [X, A, B, D, C, E]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># MRO = [X, A, B, D, C, E, object]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># И в версии 3.х и в версии 2.х (всегда) выводит строку &quot;3&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Пример наследования в ромбовидных иерархаических деревьях:</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">D</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          attr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#  D:3   D:3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain">          </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#   |     |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">C</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">D</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">       attr </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain">      </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#   B    C:1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">B</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain">          </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#    /   /</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">X </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                         </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      A</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                   </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#      X</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># DFLR = [X, A, B, D, C, D]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># MRO = [X, A, B, C, D, object] (сохраняет только последний дубликат D)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Выводит строку &quot;1&quot; в версии 3.х, строку &quot;3&quot; в версии 2.х  (&quot;1&quot; если D(object))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-diamond-problem">Что такое Diamond problem<a href="#что-такое-diamond-problem" class="hash-link" aria-label="Прямая ссылка на Что такое Diamond problem" title="Прямая ссылка на Что такое Diamond problem">​</a></h3><p>При ромбовидном наследовании определить метод какого класса должен быть вызван</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-миксины">Что такое миксины<a href="#что-такое-миксины" class="hash-link" aria-label="Прямая ссылка на Что такое миксины" title="Прямая ссылка на Что такое миксины">​</a></h3><p>Миксин (mix-in, анг. “примесь”), паттерн проектирования в ООП, когда в цепочку наследования добавляется небольшой класс-помощник. Например, есть класс</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NowMixin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Тогда любой класс, наследованный с этим миксином, будет иметь метод <code>now()</code>.</p><p>В названия миксинов принято добавлять слово <code>Mixin</code>, так как не существует никакого механизма для понимания полноценный это класс или миксин. Миксин технически является самым обычным классом.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-контекстный-менеджер-как-написать-свой">Что такое контекстный менеджер. Как написать свой<a href="#что-такое-контекстный-менеджер-как-написать-свой" class="hash-link" aria-label="Прямая ссылка на Что такое контекстный менеджер. Как написать свой" title="Прямая ссылка на Что такое контекстный менеджер. Как написать свой">​</a></h3><p>В питоне есть оператор <code>with</code>. Размещенный внутри код выполняется с особенностью: до и после гарантированно срабатывают события входа в блок <code>with</code>и выхода из него. Объект, который определяет эту логику, называется контекстным менеджером.</p><p>События входа и выхода из блока определены методами <code>__enter__</code> и <code>__exit__</code>. Первый срабатывает в тот момент, когда ход исполнения программы переходит внутрь <code>with</code>. Метод может вернуть значение. Оно будет доступно низлежащему внутри блока <code>with</code> коду.</p><p><code>__exit__</code> срабатывает в момент выхода из блока, в т.ч. и по причине исключения. В этом случае в метод будет передана тройка значений <code>(exc_class, exc_instance, traceback)</code>.</p><p>Самый распространённый контекстный менеджер – класс, порожденный функцией <code>open</code>. Он гарантирует, что файл будет закрыт даже в том случае, если внутри блока возникнет ошибка.</p><p>Нужно стараться выходить из контекстного менеджера как можно быстрее, чтобы освобождать контекст и ресурсы.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;file.txt&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Пример реализации своего контекстного менеджера на основе класса:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Printable</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__enter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;enter&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__exit__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> traceback</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;exit&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Пример реализации своего контекстного менеджера с использованием встроенной библиотеки contextlib:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> contextlib </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> contextmanager</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@contextmanager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">printable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;enter&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">yield</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;exit&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Контекстные менеджеры также можно использовать для временной замены параметров, переменных окружения, транзакций БД.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="прокомментировать-выражение">Прокомментировать выражение<a href="#прокомментировать-выражение" class="hash-link" aria-label="Прямая ссылка на Прокомментировать выражение" title="Прямая ссылка на Прокомментировать выражение">​</a></h3><p><code>object() == object()</code></p><p>Всегда ложь, поскольку по умолчанию объекты сравниваются по полю id (адрес в памяти), если только не переопределен метод <code>__eq__</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-__slots__-плюсы-минусы">Что такое <!-- -->_<!-- -->_<!-- -->slots<!-- -->_<!-- -->_<!-- -->. Плюсы, минусы<a href="#что-такое-__slots__-плюсы-минусы" class="hash-link" aria-label="Прямая ссылка на что-такое-__slots__-плюсы-минусы" title="Прямая ссылка на что-такое-__slots__-плюсы-минусы">​</a></h3><p>Классы хранят поля и их значения в секретном словаре <code>__dict__</code>. Поскольку словарь – изменяемая структура, вы можете на лету добавлять и удалять из класса поля. Параметр <code>__slots__</code> в классе жестко фиксирует набор полей класса. Слоты используются когда у класса может быть очень много полей, например, в некоторых <code>ORM</code>, либо когда критична производительность, потому что доступ к слоту срабатывает быстрее, чем поиск в словаре, или когда в процессе выполнения программы создаются миллионы экземпляров класса, применение <code>__slots__</code> позволит сэкономить память.</p><p>Слоты активно используются в библиотеках <code>requests</code> и <code>falcon</code>.</p><p>Недостатотк: нельзя присвоить классу поле, которого нет в слотах. Не работают методы <code>__getattr__</code> и <code>__setattr__</code>.
Решение: включить в <code>__slots__</code> элемент <code>__dict__</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-смысл-параметров-_value-__value">В чем смысл параметров _value, __value<a href="#в-чем-смысл-параметров-_value-__value" class="hash-link" aria-label="Прямая ссылка на В чем смысл параметров _value, __value" title="Прямая ссылка на В чем смысл параметров _value, __value">​</a></h3><p>Поле класса с одним лидирующим подчеркиванием говорит о том, что параметр используется только внутри класса. При этом он доступен для обращения извне. Это ограничение доступа только на уровне соглашения.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Современные IDE вроде <code>PyCharm</code> подсвечивают обращение к полю с подчеркиванием, но ошибки в процессе исполнения не будет.</p><p>Поля с двойным подчеркиванием доступны внутри класса, но недоступны извне. Это достигается хитрым приемом: интерпретатор назначает таким полям имена вида <code>_&lt;ClassName&gt;__&lt;fieldName&gt;</code>. Описанный механизм называется <em>name mangling</em> или <em>name decoration</em></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> AttributeError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Foo&#x27;</span><span class="token plain"> </span><span class="token builtin">object</span><span class="token plain"> has no attribute </span><span class="token string" style="color:#C6105F">&#x27;__bar&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_Foo__bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">&gt;&gt;</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">42</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-__new__-и-чем-он-отличается-от-__init__-в-какой-последовательности-они-выполняются">Что такое <!-- -->_<!-- -->_<!-- -->new<!-- -->_<!-- -->_<!-- -->. И чем он отличается от <!-- -->_<!-- -->_<!-- -->init<!-- -->_<!-- -->_<!-- -->. В какой последовательности они выполняются<a href="#что-такое-__new__-и-чем-он-отличается-от-__init__-в-какой-последовательности-они-выполняются" class="hash-link" aria-label="Прямая ссылка на что-такое-__new__-и-чем-он-отличается-от-__init__-в-какой-последовательности-они-выполняются" title="Прямая ссылка на что-такое-__new__-и-чем-он-отличается-от-__init__-в-какой-последовательности-они-выполняются">​</a></h3><p>Основное различие между этими двумя методами состоит в том, что <code>__new__</code> обрабатывает создание объекта, а <code>__init__</code> обрабатывает его инициализацию.</p><p><code>__new__</code> вызывается автоматически при вызове имени класса (при создании экземпляра), тогда как <code>__init__</code> вызывается каждый раз, когда экземпляр класса возвращается <code>__new__</code>, передавая возвращаемый экземпляр в <code>__init__</code> в качестве параметра <code>self</code>, поэтому даже если вы сохранили экземпляр где-нибудь глобально/статически и возвращали его каждый раз из <code>__new__</code>, для него все-равно будет каждый раз вызываться <code>__init__</code>.</p><p>Из вышесказанного вытекает что сначала вызывается <code>__new__</code>, а потом <code>__init__</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-и-чем-отличается-old-style-от-new-style-classes">Что такое и чем отличается old-style от new-style classes<a href="#что-такое-и-чем-отличается-old-style-от-new-style-classes" class="hash-link" aria-label="Прямая ссылка на Что такое и чем отличается old-style от new-style classes" title="Прямая ссылка на Что такое и чем отличается old-style от new-style classes">​</a></h3><p>Классы нового стиля (3.х доступны только они, в 2.х при наследовании от <code>object</code>) отличаются от классических (по умолчанию в 2.х) следующими особенностями:</p><ul><li>Причиной создания new style classes послужила идея убрать отличие встроенных типов от определённых пользователем типов. <a href="https://www.python.org/download/releases/2.2.3/descrintro/" target="_blank" rel="noopener noreferrer">Unifying types and classes in Python 2.2</a></li><li>Ромбовидные шаблоны множественного наследования имеют несколько иной порядок поиска. Поиск в них осуществляется скорее в ширину, чем в глубину, перед тем как начать обход снизу вверх (см. вопрос про MRO)</li><li>Классы теперь обозначают типы, а типы являются классами. Так, в результате вызова встроенной функции <code>type(I)</code> возвращается класс, из которого получается экземпляр, а не тип экземпляра, что, как правило, равнозначно выражению <code>I.__class__</code>. От класса <code>type</code> могут быть произведены подклассы для создания специальных классов. Все классы наследуют от встроенного класса <code>object</code>, предоставляющего по умолчанию небольшой набор методов</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-утиная-типизация">Что такое утиная типизация<a href="#что-такое-утиная-типизация" class="hash-link" aria-label="Прямая ссылка на Что такое утиная типизация" title="Прямая ссылка на Что такое утиная типизация">​</a></h3><p>Неявная типизация, латентная типизация или <em>утиная типизация</em> (англ. Duck typing) – вид динамической типизации, применяемой в некоторых языках программирования (Perl, Smalltalk, Python, Objective-C, Ruby, JavaScript, Groovy, ColdFusion, Boo, Lua, Go, C#), когда границы использования объекта определяются его текущим набором методов и свойств, в противоположность наследованию от определённого класса.
То есть считается, что объект реализует интерфейс, если он содержит все методы этого интерфейса, независимо от связей в иерархии наследования и принадлежности к какому-либо конкретному классу.</p><p>Утиная типизация решает такие проблемы иерархической типизации, как:</p><ul><li>невозможность явно указать (путём наследования) на совместимость интерфейса со всеми настоящими и будущими интерфейсами, с которыми он идейно совместим;</li><li>экспоненциальное увеличение числа связей в иерархии типов при хотя бы частичной попытке это сделать.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="модули-пакеты">Модули, пакеты<a href="#модули-пакеты" class="hash-link" aria-label="Прямая ссылка на Модули, пакеты" title="Прямая ссылка на Модули, пакеты">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-модуль">Что такое модуль<a href="#что-такое-модуль" class="hash-link" aria-label="Прямая ссылка на Что такое модуль" title="Прямая ссылка на Что такое модуль">​</a></h3><p>Модуль – функционально законченный фрагмент программы, оформленный в виде отдельного файла с исходным кодом или поименованной непрерывной её части. Модули позволяют разбивать сложные задачи на более мелкие в соответствии с принципом модульности.
Файл, который содержит исходный код на языке Python, является модулем.
Модули могут объединяться в пакеты и, далее, в библиотеки.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-можно-получить-имя-модуля">Как можно получить имя модуля<a href="#как-можно-получить-имя-модуля" class="hash-link" aria-label="Прямая ссылка на Как можно получить имя модуля" title="Прямая ссылка на Как можно получить имя модуля">​</a></h3><p>Название модуля доступно в его глобальной переменной <code>__name__</code>. Если модуль не импортирован, а запущен как скрипт, то <code>__name__</code> устанавливается в значение <code>&quot;__main__&quot;</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-модульное-программирование">Что такое модульное программирование<a href="#что-такое-модульное-программирование" class="hash-link" aria-label="Прямая ссылка на Что такое модульное программирование" title="Прямая ссылка на Что такое модульное программирование">​</a></h3><p>Модульное программирование – это организация программы как совокупности небольших независимых блоков, называемых модулями, структура и поведение которых подчиняются определенным правилам. Использование модульного программирования позволяет упростить тестирование программы и обнаружение ошибок. Аппаратно-зависимые подзадачи могут быть строго отделены от других подзадач, что улучшает мобильность создаваемых программ.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-python-ищет-модули-при-импорте">Как Python ищет модули при импорте<a href="#как-python-ищет-модули-при-импорте" class="hash-link" aria-label="Прямая ссылка на Как Python ищет модули при импорте" title="Прямая ссылка на Как Python ищет модули при импорте">​</a></h3><p>При импортировании модулей интерпретатор Python ищет их в директориях и архивах, список которых доступен как для чтения, так и для модификации в виде переменной path встроенного модуля sys.
По умолчанию sys.path состоит из директории с запускаемым скриптом, содержимого переменной окружения PYTHONPATH и стандартного расположения модулей, специфичного для конкретной платформы и интерпретатора.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-пакет">Что такое пакет<a href="#что-такое-пакет" class="hash-link" aria-label="Прямая ссылка на Что такое пакет" title="Прямая ссылка на Что такое пакет">​</a></h3><p>Модули могут объединяться в пакеты. Пакеты служат как пространства имён для модулей и способ их структурирования.
Любой пакет является модулем, но не каждый модуль является пакетом.
Как правило, модули представляются в виде файлов, а пакеты – каталогов в файловой системе (но не всегда).
Для того, чтобы каталог был пакетом, в нём должен находиться файл <code>__init__.py</code>. Он автоматически выполняется при импортировании соответствующего модуля и может содержать определённые действия для инициализации или быть пустым.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-вы-можете-сказать-о-конструкции-import-packageitem">Что вы можете сказать о конструкции import package.item<a href="#что-вы-можете-сказать-о-конструкции-import-packageitem" class="hash-link" aria-label="Прямая ссылка на Что вы можете сказать о конструкции import package.item" title="Прямая ссылка на Что вы можете сказать о конструкции import package.item">​</a></h3><p>При использовании оператора from package import item, item может быть пакетом, модулем или любым именем, описанным в пакете. При использовании оператора import package.item, item должен быть модулем или пакетом.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="исключения">Исключения<a href="#исключения" class="hash-link" aria-label="Прямая ссылка на Исключения" title="Прямая ссылка на Исключения">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-обработка-исключений">Что такое обработка исключений<a href="#что-такое-обработка-исключений" class="hash-link" aria-label="Прямая ссылка на Что такое обработка исключений" title="Прямая ссылка на Что такое обработка исключений">​</a></h3><p>Обработка <em>исключительных ситуаций</em> или обработка <em>исключений</em> (англ. exception handling) — механизм языков программирования, предназначенный для описания реакции программы на ошибки времени выполнения и другие возможные проблемы (исключения), которые могут возникнуть при выполнении программы и приводят к невозможности (бессмысленности) дальнейшей отработки программой её базового алгоритма.</p><p>Код на Python может сгенерировать исключение при помощи ключевого слова raise. После него указывается объект исключения. Также можно указать класс исключения, в таком случае будет автоматически вызван конструктор без параметров. raise может выбрасывать в качестве исключений только экземпляры класса BaseException и его наследников, а также (в Python 2) экземпляры классов старого типа.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="для-чего-могут-применять-конструкцию-try-finally-без-except">Для чего могут применять конструкцию try finally без except<a href="#для-чего-могут-применять-конструкцию-try-finally-без-except" class="hash-link" aria-label="Прямая ссылка на Для чего могут применять конструкцию try finally без except" title="Прямая ссылка на Для чего могут применять конструкцию try finally без except">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># some code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">finally</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># some code</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если в блоке try произойдет ошибка, то блок finally все-равно будет выполнен и внутри него можно будет сделать &quot;cleanup&quot;, например.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-правильно-по-разному-обрабатывать-исключения">Как правильно по-разному обрабатывать исключения<a href="#как-правильно-по-разному-обрабатывать-исключения" class="hash-link" aria-label="Прямая ссылка на Как правильно по-разному обрабатывать исключения" title="Прямая ссылка на Как правильно по-разному обрабатывать исключения">​</a></h3><p>Блоки except обрабатываются сверху вниз и управление передаётся не больше, чем одному обработчику. Поэтому при необходимости по-разному обрабатывать исключения, находящиеся в иерархии наследования, сначала нужно указывать обработчики менее общих исключений, а затем – более общих.
Также именно поэтому <em>bare except</em> может быть только последним (иначе SyntaxError). Причём если сначала расположить обработчики более общих исключений, то обработчики менее общих будут просто проигнорированы.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-будет-если-ошибку-не-обработает-блок-except">Что будет если ошибку не обработает блок except<a href="#что-будет-если-ошибку-не-обработает-блок-except" class="hash-link" aria-label="Прямая ссылка на Что будет если ошибку не обработает блок except" title="Прямая ссылка на Что будет если ошибку не обработает блок except">​</a></h3><p>Если ни один из заданных блоков except не перехватывает возникнувшее исключение, то оно будет перехвачено ближайшим внешним блоков try/except, в котором есть соответствующий обработчик. Если же программа не перехватывает исключение вообще, то интерпретатор завершает выполнение программы и выводит информацию об исключении в стандартный поток ошибок sys.stderr.
Из этого правила есть два исключения:</p><ul><li>Если исключение возникло в деструкторе объекта, выполнение программы не завершается, а в стандартный поток ошибок выводится предупреждение “Exception ignored” с информацией об исключении.</li><li>При возникновении исключения SystemExit происходит только завершение программы без вывода информации об исключении на экран (не касается предыдущего пункта, в деструкторе поведение данного исключения будет таким же, как и остальных).</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делать-если-нужно-перехватить-исключение-выполнить-действия-и-опять-возбудить-это-же-исключение">Что делать если нужно перехватить исключение, выполнить действия и опять возбудить это же исключение<a href="#что-делать-если-нужно-перехватить-исключение-выполнить-действия-и-опять-возбудить-это-же-исключение" class="hash-link" aria-label="Прямая ссылка на Что делать если нужно перехватить исключение, выполнить действия и опять возбудить это же исключение" title="Прямая ссылка на Что делать если нужно перехватить исключение, выполнить действия и опять возбудить это же исключение">​</a></h3><p>Для того, чтобы в обработчике исключения выполнить определённые действия, а затем передать исключение дальше, на один уровень обработчиков выше (то есть, выбросить то же самое исключение ещё раз), используется ключевое слово raise без параметров.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">/</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">except</span><span class="token plain"> ZeroDivisionError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># some logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">raise</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-сцепление-исключений">Что такое сцепление исключений<a href="#что-такое-сцепление-исключений" class="hash-link" aria-label="Прямая ссылка на Что такое сцепление исключений" title="Прямая ссылка на Что такое сцепление исключений">​</a></h3><p>В Python 3 при возбуждении исключения в блоке except, старое исключение сохраняется в атрибуте данных <code>__context__</code> и если новое исключение не обработано, то будет выведена информация о том, что новое исключение возникло при обработке старого («During handling of the above exception, another exception occurred:»).
Также, можно связывать исключения в одну цепь или заменять старые новыми. Для этого используется конструкция <code>raise новое_исключение from старое_исключение</code> либо <code>raise новое_исключение from None</code>.
В первом случае указанное исключение сохраняется в атрибуте <code>__cause__</code> и атрибут <code>__suppress_context__</code> (который подавляет вывод исключения из <code>__context__</code>) устанавливается в True. Тогда, если новое исключение не обработано, будет выведена информация о том, что старое исключение является причиной нового («The above exception was the direct cause of the following exception:»).
Во втором случае <code>__suppress_context__</code> устанавливается в True и <code>__cause__</code> в None. Тогда при выводе исключения оно, фактически, будет заменено новым (хотя старое исключение всё ещё хранится в <code>__context__</code>).</p><p>В Python 2 нет сцепления исключений. Любое исключение, выброшенное в блоке except, заменяет старое.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="зачем-нужен-блок-else">Зачем нужен блок else<a href="#зачем-нужен-блок-else" class="hash-link" aria-label="Прямая ссылка на Зачем нужен блок else" title="Прямая ссылка на Зачем нужен блок else">​</a></h3><p>Блок else выполняется, если в процессе выполнения блока try не возникло исключений. Он предназначен для того, чтобы отделить код, который может вызвать исключение, которое должно быть обработано в данном блоке try/except, от кода, который может вызвать исключение того же класса, которое должно быть перехвачено на уровне выше, и свести к минимуму количество операторов в блоке try.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-можно-передать-в-конструктор-исключения">Что можно передать в конструктор исключения<a href="#что-можно-передать-в-конструктор-исключения" class="hash-link" aria-label="Прямая ссылка на Что можно передать в конструктор исключения" title="Прямая ссылка на Что можно передать в конструктор исключения">​</a></h3><p>Исключения могут принимать в качестве параметра конструктора любые неименованные аргументы. Они помещаются в атрибуте данных args в виде кортежа (неизменяемого списка). Чаще всего используется один строковой параметр, который содержит сообщение об ошибке. Во всех исключениях определён метод <code>__str__</code>, который по умолчанию вызывает str(self.args).
В Python 2 также имеется атрибут message, в который помещается <code>args[0]</code>, если <code>len(args) == 1</code>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-есть-классы-исключений">Какие есть классы исключений<a href="#какие-есть-классы-исключений" class="hash-link" aria-label="Прямая ссылка на Какие есть классы исключений" title="Прямая ссылка на Какие есть классы исключений">​</a></h3><ul><li>Базовые:<ul><li>BaseException – базовый класс для всех исключений.</li><li>Exception – класс-наследник BaseException, базовый класс для для всех стандартных исключений, которые не указывают на обязательное завершение программы, и всех пользовательских исключений.</li><li>StandardError (Python 2) – базовый класс для всех встроенных исключений, кроме StopIteration, GeneratorExit, KeyboardInterrupt и SystemExit.</li><li>ArithmeticError – базовый класс для всех исключений, связанных с арифметическими операциями.</li><li>BufferError – базовый класс для исключений, связанных с операциями над буфером.</li><li>LookupError – базовый класс для исключений, связанных с неверным ключом или индексом коллекции.</li><li>EnvironmentError (Python 2) – базовый класс для исключений, связанных с ошибками, которые происходят вне интерпретатора Python. В Python 3 его роль выполняет OSError.</li></ul></li><li>Некоторые из конкретных стандартных исключений:<ul><li>AssertionError – провал условия в операторе assert.</li><li>AttributeError – ошибка обращения к атрибуту.</li><li>FloatingPointError – ошибка операции над числами с плавающей точкой.</li><li>ImportError – ошибка импортирования модуля или имени из модуля.</li><li>IndexError – неверный индекс последовательности (например, списка).</li><li>KeyboardInterrupt – завершение программы путём нажатия Ctrl+C в консоли.</li><li>MemoryError – нехватка памяти.</li><li>NameError – имя не найдено.</li><li>NotImplementedError – действие не реализовано. Предназначено, среди прочего, для создания абстрактных методов.</li><li>OSError – системная ошибка.</li><li>OverflowError – результат арифметической операции слишком большой, чтобы быть представлен.</li><li>RuntimeError – общая ошибка времени выполнения, которая не входит ни в одну из категорий.</li><li>SyntaxError – ошибка синтаксиса.</li><li>IndentationError – подкласс SyntaxError – неверный отступ.</li><li>TabError – подкласс IndentationError – смешанное использование символов табуляции и пробелов.</li><li>SystemError – некритичная внутренняя ошибка интерпретатора. При возникновении данного исключения следует оставить отчёт об ошибке на сайте <a href="https://bugs.python.org/" target="_blank" rel="noopener noreferrer">bugs.python.org</a></li><li>SystemExit – исключение, которое генерируется функцией sys.exit(). Служит для завершения работы программы.</li><li>TypeError – ошибка несоответствия типов данных.</li><li>UnboundLocalError – подкласс NameError – обращение к несуществующей локальной переменной.</li><li>ValueError – генерируется, когда функции или операции передан объект корректного типа, но с некорректным значением, причём эту ситуацию нельзя описать более точным исключением, таким как IndexError.</li><li>ZeroDivisionError – деление на ноль.</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-каких-случаях-можно-обработать-syntaxerror">В каких случаях можно обработать SyntaxError<a href="#в-каких-случаях-можно-обработать-syntaxerror" class="hash-link" aria-label="Прямая ссылка на В каких случаях можно обработать SyntaxError" title="Прямая ссылка на В каких случаях можно обработать SyntaxError">​</a></h3><p>Ошибка синтаксиса возникает, когда синтаксический анализатор Python сталкивается с участком кода, который не соответствует спецификации языка и не может быть интерпретирован.
Поскольку, в случае синтаксической ошибки в главном модуле, она возникает до начала выполнения программы и не может быть перехвачена, учебник для начинающих в документации языка Python даже разделяет синтаксические ошибки и исключения. Однако SyntaxError – это тоже исключение, которое наследуется от Exception, и существуют ситуации, когда оно может возникнуть во время исполнения и быть обработано, а именно:</p><ul><li>ошибка синтаксиса в импортируемом модуле;</li><li>ошибка синтаксиса в коде, который представляется строкой и передаётся функции eval или exec.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="можно-ли-создавать-собственные-исключения">Можно ли создавать собственные исключения<a href="#можно-ли-создавать-собственные-исключения" class="hash-link" aria-label="Прямая ссылка на Можно ли создавать собственные исключения" title="Прямая ссылка на Можно ли создавать собственные исключения">​</a></h3><p>Можно. Они должны быть наследниками класса Exception. Принято называть исключения так, что имя их класса заканчивается словом Error.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="для-чего-нужны-предупреждения-warnings-и-как-создать-собственное">Для чего нужны предупреждения (warnings) и как создать собственное<a href="#для-чего-нужны-предупреждения-warnings-и-как-создать-собственное" class="hash-link" aria-label="Прямая ссылка на Для чего нужны предупреждения (warnings) и как создать собственное" title="Прямая ссылка на Для чего нужны предупреждения (warnings) и как создать собственное">​</a></h3><p>Предупреждения обычно выводятся на экран в ситуациях, когда не гарантируется ошибочное поведение и программа, как правило, может продолжать работу, однако пользователя следует уведомить о чём-либо.
Базовым классом для предупреждений является Warning, который наследуется от Exception.
Базовым классом-наследником Warning для пользовательских предупреждений является UserWarning.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="для-чего-нужен-модуль-warning">Для чего нужен модуль warning<a href="#для-чего-нужен-модуль-warning" class="hash-link" aria-label="Прямая ссылка на Для чего нужен модуль warning" title="Прямая ссылка на Для чего нужен модуль warning">​</a></h3><p>В модуле warning собраны функции для работы с предупреждениями.
Основной является функция warn, которая принимает один обязательный параметр message, который может быть либо строкой-сообщением, либо экземпляром класса или подкласса Warning (в таком случае параметр category устанавливается автоматически) и два опциональных параметра: category (по умолчанию – UserWarning) – класс предупреждения и stacklevel (по умолчанию – 1) – уровень вложенности функций, начиная с которого необходимо выводить содержимое стека вызовов (полезно, например, для функций-обёрток для вывода предупреждений, где следует задать stacklevel=2, чтобы предупреждение относилось к месту вызова данной функции, а не самой функции).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="декораторы">Декораторы<a href="#декораторы" class="hash-link" aria-label="Прямая ссылка на Декораторы" title="Прямая ссылка на Декораторы">​</a></h2><ul><li><a href="https://habr.com/ru/post/141411/" target="_blank" rel="noopener noreferrer">Понимаем декораторы в Python&#x27;e, шаг за шагом. Шаг 1</a></li><li><a href="https://habr.com/ru/post/141501/" target="_blank" rel="noopener noreferrer">Понимаем декораторы в Python&#x27;e, шаг за шагом. Шаг 2</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-декораторы-зачем-нужны">Что такое декораторы. Зачем нужны<a href="#что-такое-декораторы-зачем-нужны" class="hash-link" aria-label="Прямая ссылка на Что такое декораторы. Зачем нужны" title="Прямая ссылка на Что такое декораторы. Зачем нужны">​</a></h3><p>Декоратор в широком смысле - паттерн проектирования, когда один объект изменяет поведение другого. В Питоне декоратор, как правило, это функция A, которая принимает функцию B и возвращает функцию C. При этом функция C задействует в себе функцию B.</p><p>Задекорировать функцию значит заменить ее на результат работы декоратора.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-может-быть-декоратором-к-чему-может-быть-применен-декоратор">Что может быть декоратором. К чему может быть применен декоратор<a href="#что-может-быть-декоратором-к-чему-может-быть-применен-декоратор" class="hash-link" aria-label="Прямая ссылка на Что может быть декоратором. К чему может быть применен декоратор" title="Прямая ссылка на Что может быть декоратором. К чему может быть применен декоратор">​</a></h3><p>Декоратором может быть любой вызываемый объект: функция, лямбда, класс, экземпляр класса. В последнем случае определите метод <code>__call__</code>.</p><p>Применять декоратор можно к любому объекту. Чаще всего к функциям, методам и классам. Декорирование встречается настолько часто, что под него выделен особый оператор <code>@</code>.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">auth_only</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@auth_only</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">dashboard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Если бы оператора декорирования не существовало, мы бы записали код выше так:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">auth_only</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">dashboard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dashboard </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> auth_only</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dashboard</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-будет-если-декоратор-не-возвращает-ничего">Что будет, если декоратор не возвращает ничего<a href="#что-будет-если-декоратор-не-возвращает-ничего" class="hash-link" aria-label="Прямая ссылка на Что будет, если декоратор не возвращает ничего" title="Прямая ссылка на Что будет, если декоратор не возвращает ничего">​</a></h3><p>Если в теле функции нет оператора <code>return</code>, вызов вернет <code>None</code>. Помним, результат декоратора замещает декорируемый объект. В нашем случае декоратор вернет <code>None</code> и функция, которую мы декорируем, тоже станет <code>None</code>. При попытке вызвать ее после декорирования получим ошибку &quot;NoneType is not callable&quot;.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-отличие-foobar-от-foobar">В чем отличие \@foobar от \@foobar()<a href="#в-чем-отличие-foobar-от-foobar" class="hash-link" aria-label="Прямая ссылка на В чем отличие \@foobar от \@foobar()" title="Прямая ссылка на В чем отличие \@foobar от \@foobar()">​</a></h3><p>Первое -- обычное декорирование функцией foobar.</p><p>Второй случай -- декорирование функцией, которую вернет вызов foobar. По-другому это называется параметрический декоратор или фабрика декораторов. См. следующий вопрос.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-фабрика-декораторов">Что такое фабрика декораторов<a href="#что-такое-фабрика-декораторов" class="hash-link" aria-label="Прямая ссылка на Что такое фабрика декораторов" title="Прямая ссылка на Что такое фабрика декораторов">​</a></h3><p>Это функция, которая возвращает декоратор. Например, вам нужен декоратор для проверки прав. Логика проверки одинакова, но прав может быть много. Чтобы не плодить копипасту, напишем фабрику декораторов.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> functools </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> wraps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">has_perm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">perm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">decorator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token decorator annotation punctuation" style="color:#393A34">@wraps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">wrapper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> perm </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> view</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> HTTPRedirect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;/login&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> wrapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> decorator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@has_perm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;view_user&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">users</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="зачем-нужен-wraps">Зачем нужен wraps<a href="#зачем-нужен-wraps" class="hash-link" aria-label="Прямая ссылка на Зачем нужен wraps" title="Прямая ссылка на Зачем нужен wraps">​</a></h3><p><code>wraps</code> - декоратор из стандартной поставки Python, модуль <code>functools</code>. Он назначает функции-врапперу те же поля <code>__name__</code>, <code>__module__</code>, <code>__doc__</code>, что и у исходной функции, которую вы декорируете. Это нужно для того, чтобы после декорирования функция-враппер в стектрейсах выглядела как декорируемая функция.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="метаклассы">Метаклассы<a href="#метаклассы" class="hash-link" aria-label="Прямая ссылка на Метаклассы" title="Прямая ссылка на Метаклассы">​</a></h2><ul><li><a href="https://proglib.io/p/metaclasses-in-python/" target="_blank" rel="noopener noreferrer">Метаклассы в Python: что это такое и с чем его едят</a></li><li><a href="https://habr.com/ru/post/145835/" target="_blank" rel="noopener noreferrer">Метаклассы в Python</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-метаклассы">Что такое метаклассы<a href="#что-такое-метаклассы" class="hash-link" aria-label="Прямая ссылка на Что такое метаклассы" title="Прямая ссылка на Что такое метаклассы">​</a></h3><p>Метакласс это «штука», которая создаёт классы.</p><p>Мы создаём класс для того, чтобы создавать объекты, так? А классы являются объектами. Метакласс это то, что создаёт эти самые объекты.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-type-как-работает-поиск-метакласса-при-создании-объекта">Что такое type. Как работает поиск метакласса при создании объекта<a href="#что-такое-type-как-работает-поиск-метакласса-при-создании-объекта" class="hash-link" aria-label="Прямая ссылка на Что такое type. Как работает поиск метакласса при создании объекта" title="Прямая ссылка на Что такое type. Как работает поиск метакласса при создании объекта">​</a></h3><p><code>type</code> это метакласс, который Питон внутренне использует для создания всех классов.</p><p>Когда вы пишете:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Bar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Питон делает следующее:</p><ul><li>Есть ли у класса Foo атрибут <code>__metaclass__</code>?</li><li>Если да, создаёт в памяти объект-класс с именем Foo, используя то, что указано в <code>__metaclass__</code>.</li><li>Если Питон не находит <code>__metaclass__</code>, он ищет <code>__metaclass__</code> в родительском классе Bar и попробует сделать то же самое.</li><li>Если же <code>__metaclass__</code> не находится ни в одном из родителей, Питон будет искать <code>__metaclass__</code> на уровне модуля.</li><li>И если он не может найти вообще ни одного <code>__metaclass__</code>, он использует <code>type</code> для создания объекта-класса.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-работают-метаклассы">Как работают метаклассы<a href="#как-работают-метаклассы" class="hash-link" aria-label="Прямая ссылка на Как работают метаклассы" title="Прямая ссылка на Как работают метаклассы">​</a></h3><ul><li>перехватить создание класса</li><li>изменить класс</li><li>вернуть модифицированный</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="зачем-вообще-использовать-метаклассы">Зачем вообще использовать метаклассы<a href="#зачем-вообще-использовать-метаклассы" class="hash-link" aria-label="Прямая ссылка на Зачем вообще использовать метаклассы" title="Прямая ссылка на Зачем вообще использовать метаклассы">​</a></h3><p>Основное применение метаклассов это создание API. Типичный пример — Django ORM.</p><p>Она позволяет написать что-то в таком духе:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Person</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CharField</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_length</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  age </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">IntegerField</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Однако если вы выполните следующий код:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">guy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Person</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&#x27;bob&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> age</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&#x27;35&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> guy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>вы получите не <code>IntegerField</code>, а <code>int</code>, причём значение может быть получено прямо из базы данных.</p><p>Это возможно, потому что <code>models.Model</code> определяет <code>__metaclass__</code>, который сотворит некую магию и превратит класс <code>Person</code>, который мы только что определили простым выражением в сложную привязку к базе данных.</p><p>Django делает что-то сложное выглядящее простым, выставляя наружу простой API и используя метаклассы, воссоздающие код из API и незаметно делающие всю работу.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ввод-вывод">Ввод-Вывод<a href="#ввод-вывод" class="hash-link" aria-label="Прямая ссылка на Ввод-Вывод" title="Прямая ссылка на Ввод-Вывод">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-файловый-объект">Что такое файловый объект<a href="#что-такое-файловый-объект" class="hash-link" aria-label="Прямая ссылка на Что такое файловый объект" title="Прямая ссылка на Что такое файловый объект">​</a></h3><p>Файловый объект – объект, предоставляющий файл-ориентированный API (методы <code>read()</code>, <code>write()</code> и т.д.) для доступа к ресурсу. В зависимости от способа создания, файловый объект может предоставлять доступ к реальному файлу на диске или другому виду устройства хранения или передачи данных (стандартные потоки ввода/вывода, буферы в памяти, сокеты и т.д.).
Файловые объекты также называют потоками.
Файловые объекты являются контекстными менеджерами.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-есть-виды-файловых-объектов">Какие есть виды файловых объектов<a href="#какие-есть-виды-файловых-объектов" class="hash-link" aria-label="Прямая ссылка на Какие есть виды файловых объектов" title="Прямая ссылка на Какие есть виды файловых объектов">​</a></h3><p>На уровне типов данных в Python 2 нет отличия между текстовыми и бинарными файлами. При открытии можно указать текстовый либо бинарный режим, но это влияет только на преобразования концов строк при выполнении под ОС Windows, а под Unix-системами, где преобразования концов строк не требуются, не влияет ни на что.</p><p>В Python 3 существует три вида файловых объектов: текстовые файлы (text files), «обычные» (небуферизированные) бинарные файлы (raw binary files) и буферизированные бинарные файлы (buffered binary files). Разные виды потоков представляются соответствующими классами модуля io.</p><p>Модуль io был обратно портирован в последние версии Python 2, поэтому в Python 2 также при желании можно использовать систему ввода-вывода, аналогичную Python 3.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-отличие-текстовых-и-бинарных-файлов">В чем отличие текстовых и бинарных файлов<a href="#в-чем-отличие-текстовых-и-бинарных-файлов" class="hash-link" aria-label="Прямая ссылка на В чем отличие текстовых и бинарных файлов" title="Прямая ссылка на В чем отличие текстовых и бинарных файлов">​</a></h3><p>Текстовые файлы записывают и считывают данные типа str и автоматически выполняют преобразования кодировок и концов строк. Бинарные файлы записывают и считывают данные типов bytes и bytearray и не производят никаких манипуляций с данными: всё записывается и считывается в таком же виде, как и сохраняется.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-пользоваться-функцией-open">Как пользоваться функцией open<a href="#как-пользоваться-функцией-open" class="hash-link" aria-label="Прямая ссылка на Как пользоваться функцией open" title="Прямая ссылка на Как пользоваться функцией open">​</a></h3><p>Сигнатура функции в Python 2: <code>open(file, mode=&#x27;r&#x27;, buffering=-1)</code>.</p><p>Сигнатура функции в Python 3 (и в Python 2 при использовании функции io.open):
<code>open(file, mode=&#x27;r&#x27;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</code>.</p><p>Основные параметры:</p><ul><li>file – имя файла или файловый дескриптор;</li><li>mode – режим открытия файла;</li><li>encoding – кодировка файла;</li><li>buffering – использовать ли буферизацию: отрицательное число (по умолчанию, указывать явно не нужно) – стандартное значение для данного вида файлового объекта, 0 – отключить буферизацию, 1 – построчная буферизация (для текстовых файлов), другое значение – включить буферизацию и задать соответствующий размер буфера.</li></ul><p>Обязательным параметром является только первый. Чаще всего функция <code>open()</code> используется с двумя параметрами.</p><p>mode может начинаться с символов «r» (чтение), «w» (запись, очищает файл, если уже существует), «x» (исключительное создание, неуспешно, если файл уже существует), «a» (добавление, запись в конец файла).
Также параметр mode может иметь вторую букву для определения типа файла: «t» для текстового (по умолчанию) и «b» для бинарного.
Также можно добавить символ «+» для открытия в режиме чтения и записи одновременно. Порядок последних двух символов не имеет значения: «rb+» и «r+b» задают один и тот же режим.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="для-чего-необходимо-закрывать-файлы">Для чего необходимо закрывать файлы<a href="#для-чего-необходимо-закрывать-файлы" class="hash-link" aria-label="Прямая ссылка на Для чего необходимо закрывать файлы" title="Прямая ссылка на Для чего необходимо закрывать файлы">​</a></h3><p>После окончания работы с файлом следует обязательно его закрыть при помощи метода <code>close()</code>, особенно если он был открыт для записи. При использовании буферизированного вывода данные, которые записываются в файл, не попадают в него сразу, а записываются в буфер.
Содержимое буфера записывается в файл при его заполнении или вызове методов <code>flush()</code> или <code>close()</code>. Кроме того, если файл открыт для записи, он будет заблокирован для открытия для записи другими процессами до момента закрытия. Все открытые файлы автоматически закрываются при удалении соответствующих файловых объектов из памяти сборщиком мусора интерпретатора Python и при завершении работы самого интерпретатора, однако следует держать файлы открытыми минимально требуемое время.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делают-методы-tell-и-seek">Что делают методы tell и seek<a href="#что-делают-методы-tell-и-seek" class="hash-link" aria-label="Прямая ссылка на Что делают методы tell и seek" title="Прямая ссылка на Что делают методы tell и seek">​</a></h3><p>Метод <code>tell()</code> возвращает текущую позицию считывания/записи в файле. Метод <code>seek(offset, whence)</code> устанавливает её. Параметр offset задаёт отступ, а whence – точку, от которой данный отступ считается: <code>io.SEEK_SET(0)</code> – начало файла, <code>io.SEEK_CUR(1)</code> – текущая позиция, <code>io.SEEK_END(2)</code> – конец файла.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делают-stringio-и-bytesio">Что делают StringIO и BytesIO<a href="#что-делают-stringio-и-bytesio" class="hash-link" aria-label="Прямая ссылка на Что делают StringIO и BytesIO" title="Прямая ссылка на Что делают StringIO и BytesIO">​</a></h3><p>Классы <code>io.StringIO</code> и <code>io.BytesIO</code>, представляют собой потоки для считывания и записи в строки или байтовые строки в памяти. Они могут быть использованы для того, чтобы использовать строки и байтовые строки в качестве текстовых и бинарных файлов.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="являются-ли-файловые-объекты-контекстными-менеджерами">Являются ли файловые объекты контекстными менеджерами<a href="#являются-ли-файловые-объекты-контекстными-менеджерами" class="hash-link" aria-label="Прямая ссылка на Являются ли файловые объекты контекстными менеджерами" title="Прямая ссылка на Являются ли файловые объекты контекстными менеджерами">​</a></h3><p>Да, являются</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-сериализация">Что такое сериализация<a href="#что-такое-сериализация" class="hash-link" aria-label="Прямая ссылка на Что такое сериализация" title="Прямая ссылка на Что такое сериализация">​</a></h3><p>Сериализация – это процесс сохранения объектов в двоичном или строковом виде для хранения, передачи и восстановления. Обратный процесс называется десериализацией. Термины-синонимы маршалинг/анмаршалинг</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jsondumps--jsondump--jsonloads--jsonload">json.dumps / json.dump , json.loads / json.load<a href="#jsondumps--jsondump--jsonloads--jsonload" class="hash-link" aria-label="Прямая ссылка на json.dumps / json.dump , json.loads / json.load" title="Прямая ссылка на json.dumps / json.dump , json.loads / json.load">​</a></h3><p>Функция dumps модуля json сохраняет JSON-представление объекта в строку. Функция dump – в текстовый файл.
Функция loads модуля json загружает объект из строки. Функция load – из текстового файла.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делать-если-нужно-сериализовать-данные-которые-не-поддерживаются-стандартным-модулем-json">Что делать если нужно сериализовать данные, которые не поддерживаются стандартным модулем json<a href="#что-делать-если-нужно-сериализовать-данные-которые-не-поддерживаются-стандартным-модулем-json" class="hash-link" aria-label="Прямая ссылка на Что делать если нужно сериализовать данные, которые не поддерживаются стандартным модулем json" title="Прямая ссылка на Что делать если нужно сериализовать данные, которые не поддерживаются стандартным модулем json">​</a></h3><p>Можно использовать pickle или расширить классы JSONEncoder и JSONDecoder.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pickledumps--pickledump-pickleloads--pickleload">pickle.dumps / pickle.dump, pickle.loads / pickle.load<a href="#pickledumps--pickledump-pickleloads--pickleload" class="hash-link" aria-label="Прямая ссылка на pickle.dumps / pickle.dump, pickle.loads / pickle.load" title="Прямая ссылка на pickle.dumps / pickle.dump, pickle.loads / pickle.load">​</a></h3><p>Функции dump, dumps, load и loads модуля pickle аналогичны по своему предназначению соответствующим функциям модуля JSON, но работают с байтовыми строками и бинарными файлами.</p><p>Опциональный параметр protocol данных функций задаёт версию протокола. Последнюю версию протокола можно получить как константу pickle.HIGHEST_PROTOCOL, текущую версию по умолчанию – pickle.DEFAULT_PROTOCOL.</p><p>На момент написания данного текста существует пять версий протокола:</p><ul><li>0 и 1 – это устаревшие версии, которые использовались в Python 2.2 и ниже;</li><li>2 – это основная версия протокола для Python 2;</li><li>3 – версия протокола, которая появилась в Python 3, стандартный протокол в Python 3 на текущий момент, не может быть десериализован в Python 2;</li><li>4 – версия протокола, появившаяся в Python 3.4, поддерживает очень большие по объёму памяти объекты, поддерживает большее количество типов объектов, добавлены некоторые оптимизации.</li><li>5 - версия протокола, появившаяся в Python 3.8. Он добавляет поддержку данных out-of-band и ускорение для in-band данных. PEP 574 более подробно описывает изменения.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="тестирование">Тестирование<a href="#тестирование" class="hash-link" aria-label="Прямая ссылка на Тестирование" title="Прямая ссылка на Тестирование">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="пирамида-тестирования">Пирамида тестирования<a href="#пирамида-тестирования" class="hash-link" aria-label="Прямая ссылка на Пирамида тестирования" title="Прямая ссылка на Пирамида тестирования">​</a></h3><div class="language-md codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-md codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token url operator" style="color:#D73A49">!</span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">Рис. Пирамида тестирования</span><span class="token url" style="color:#36acaa">](</span><span class="token url" style="color:#36acaa">attachments/eb2d6637.png</span><span class="token url" style="color:#36acaa">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-mocking">Что такое mocking<a href="#что-такое-mocking" class="hash-link" aria-label="Прямая ссылка на Что такое mocking" title="Прямая ссылка на Что такое mocking">​</a></h3><ul><li><a href="https://habr.com/ru/post/141209/" target="_blank" rel="noopener noreferrer">Модуль Mock: макеты-пустышки в тестировании</a></li></ul><p>Mock на английском значит «имитация», «подделка». Принцип его работы простой: если нужно тестировать функцию, то всё, что не относится к ней самой (например, чтение с диска или из сети), можно подменить макетами-пустышками. При этом тестируемые функции не нужно адаптировать для тестов: Mock подменяет объекты в других модулях, даже если код не принимает их в виде параметров. То есть, тестировать можно вообще без адаптации под тесты.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делать-если-тестируемая-функция-использует-удалённое-подключение-к-внешним-сервисам-которое-иногда-видает-ошибку-таймаута-404-и-им-подобные">Что делать, если тестируемая функция использует удалённое подключение к внешним сервисам, которое иногда видает ошибку таймаута, 404 и им подобные<a href="#что-делать-если-тестируемая-функция-использует-удалённое-подключение-к-внешним-сервисам-которое-иногда-видает-ошибку-таймаута-404-и-им-подобные" class="hash-link" aria-label="Прямая ссылка на Что делать, если тестируемая функция использует удалённое подключение к внешним сервисам, которое иногда видает ошибку таймаута, 404 и им подобные" title="Прямая ссылка на Что делать, если тестируемая функция использует удалённое подключение к внешним сервисам, которое иногда видает ошибку таймаута, 404 и им подобные">​</a></h3><p>Если мы говорим про юнит тесты, то они не должны вызывать внешние ресурсы, то есть делать http запросы и тд. Следовательно нужно либо замокать http-клиент, который использует функция для вызова сервиса, либо, что обычно является лучшим решением, передавать то что вызывает этот сервис в функцию зависимостью (если конечно мы не тестируем сам клиент для вызова сервиса).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-делать-если-тестируемая-функция-занимает-много-времени-на-выполнение-повторяющихся-операций-внутри-неё">Что делать, если тестируемая функция занимает много времени на выполнение повторяющихся операций внутри неё<a href="#что-делать-если-тестируемая-функция-занимает-много-времени-на-выполнение-повторяющихся-операций-внутри-неё" class="hash-link" aria-label="Прямая ссылка на Что делать, если тестируемая функция занимает много времени на выполнение повторяющихся операций внутри неё" title="Прямая ссылка на Что делать, если тестируемая функция занимает много времени на выполнение повторяющихся операций внутри неё">​</a></h3><p>Например, внутри цикл от 1 до 1000000, где что-то считывается, записывается, рассчитывается.</p><p>Допустим у этой функции не проблем с декомпозицией - это функция, которая выполняет одно действие и разбивать ее на несколько других не имеет никакого смысла. В таком случае я бы:</p><ul><li>сделал бы возможным заменить из теста верхнюю границу цикла (через параметр или мокая константу, настройку и т.д.)</li><li>если функция вызывает для расчетов другую ресурсоёмкую функцию, стороннюю или из своей кодовой базы, то возможно замокал бы ее и проверил что она вызывается с нужными параметрами</li><li>по возможности подготовил бы для теста такой входящий набор данных, при котором она выполялась быстро</li></ul><p>Если функция не соответсвует условиям, описанным в первом предложении, следовало бы сначала заняться ее декомпозицией.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-вы-знаете-виды-тестов">Какие вы знаете виды тестов<a href="#какие-вы-знаете-виды-тестов" class="hash-link" aria-label="Прямая ссылка на Какие вы знаете виды тестов" title="Прямая ссылка на Какие вы знаете виды тестов">​</a></h3><ul><li><a href="https://habr.com/ru/post/358950/" target="_blank" rel="noopener noreferrer">Пирамида тестов на практике</a></li><li><a href="https://medium.com/front-end-in-regions-grodno/%D1%82%D0%B5%D1%81%D1%82%D1%8B-%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B5-%D0%B4%D0%BE%D0%BB%D0%B6%D0%B5%D0%BD-%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%87%D0%B8%D0%BA-a04cab35f45b" target="_blank" rel="noopener noreferrer">Тесты, которые должен писать разработчик</a></li><li><a href="https://techrocks.ru/2018/12/08/different-types-of-testing/" target="_blank" rel="noopener noreferrer">Различные виды тестирования и их особенности</a></li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unit-тесты">Unit-тесты<a href="#unit-тесты" class="hash-link" aria-label="Прямая ссылка на Unit-тесты" title="Прямая ссылка на Unit-тесты">​</a></h4><p><em>Что проверяется?</em>
Модульные тесты проверяют, правильно ли работает каждый отдельный модуль (юнит) вашего кода. В идеале при планировании и написании модульных тестов нужно изолировать функционал, который нельзя разделить на более мелкие составляющие, и протестировать его.</p><p>  Модульные тесты не должны проверять внешние зависимости или взаимодействия. Вам определенно нужно сымитировать (mock out) api-вызовы. Борцы за чистоту модульных тестов будут также настаивать на имитации вызовов базы данных, чтобы убедиться, что ваш код, получая корректный input из внешних источников, ведет себя правильно. Модульные тесты должны быть быстрыми, иначе они значительно замедляют разработку.</p><p><em>Когда их запускать?</em>
Вы должны писать и запускать модульные тесты параллельно со своим кодом.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="интеграционные-тесты-integration-tests">Интеграционные тесты (Integration tests)<a href="#интеграционные-тесты-integration-tests" class="hash-link" aria-label="Прямая ссылка на Интеграционные тесты (Integration tests)" title="Прямая ссылка на Интеграционные тесты (Integration tests)">​</a></h4><p>Этот термин употребляют чаще к тестам, покрывающим непосредственно публичный API сервиса. Фокус устремлен на проверку взаимодействия разных систем по принципу “сервис-клиент”.</p><p><em>Что проверяется?</em>
Интеграционные тесты проверяют взаимодействие между двумя (или больше, чем двумя) отдельными юнитами вашего кода.</p><p>  Ваше приложение состоит из отдельных модулей, выполняющих определенные маленькие функции. Каждый из них может хорошо работать в изолированном состоянии, но ломаться в связке с другими.</p><p>  Интеграционные тесты также проверяют интеграцию вашего кода с внешними зависимостями, вроде соединений с базой данных или сторонними API.</p><p><em>Когда их запускать?</em>
Интеграционные тесты это следующий шаг после модульных тестов.</p><p><em>Что, если тесты провалены?</em>
Провал интеграционных тестов означает, что две (или больше) функции вашего приложения не работают вместе. Это могут быть два написанных вами модуля, которые приходят в противоречие из-за какой-то сложной бизнес-логики. Также провал может случиться из-за того, что изменилась структура ответа стороннего API. Провал тестов может быть предупреждением о плохой обработке ошибок в случае сбоя подключения к базе данных.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="функциональное-тестирование">Функциональное тестирование<a href="#функциональное-тестирование" class="hash-link" aria-label="Прямая ссылка на Функциональное тестирование" title="Прямая ссылка на Функциональное тестирование">​</a></h4><ul><li>Функциональное тестирование может быть определено как тестирование отдельных функций модулей.</li><li>Это относится к тестированию программного продукта на индивидуальном уровне, чтобы проверить его функциональность.</li><li>Оно сильно отличается от модульного или интеграционного тестирования; вы не можете написать бесчисленное множество тест-кейсов для функционального тестирования, поскольку оно является более сложным, чем модульное.</li><li>Инструменты функционального тестирования стремятся проверить функциональные возможности (работоспособность) программного обеспечения. Тестовые примеры используются для проверки ожидаемых и неожиданных результатов тестирования программного обеспечения.</li><li>Этот тип тестирования проводится больше с точки зрения пользователя. То есть, он рассматривает ожидание пользователя в выбранном типе ввода данных.</li><li>Selenium является одним из наиболее распространенных инструментов, используемых для функционального тестирования.</li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="системный-тест-system-test-service-test">Системный тест (System test, Service test)<a href="#системный-тест-system-test-service-test" class="hash-link" aria-label="Прямая ссылка на Системный тест (System test, Service test)" title="Прямая ссылка на Системный тест (System test, Service test)">​</a></h4><p>  Автоматизированные тесты, проверяющие работу всей интегрированной системы. По сути, они представляют собой предельный случай интеграционных тестов. Системные тесты не проверяют бизнес-правила напрямую. Вместо этого они проверяют, что компоненты системы правильно связаны друг с другом, а взаимодействие между ними проходит по исходному плану. Тесты производительности и пропускной способности обычно относятся к этой категории.</p><p>Системное — это тестирование программы в целом. Для небольших проектов это, как правило, ручное тестирование — запустил, пощелкал, убедился, что (не) работает. Можно автоматизировать. К автоматизации есть два подхода.</p><p>Эти тесты пишутся системными архитекторами и ведущими специалистами с технической стороны. Как правило, они пишутся на том же языке и в той же среде, что и интеграционные тесты пользовательского интерфейса. Системные тесты выполняются относительно редко (в зависимости от продолжительности их выполнения), но чем чаще – тем лучше.</p><p>Системные тесты покрывают 10 % системы. Это объясняется тем, что они предназначены для проверки правильности не поведения системы, а ее конструкции. Правильность поведения нижележащего кода и компонентов уже была проверена на нижних уровнях пирамиды.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="проверка-работоспособности-smoke-test-sanity-check">Проверка работоспособности (Smoke test, Sanity check)<a href="#проверка-работоспособности-smoke-test-sanity-check" class="hash-link" aria-label="Прямая ссылка на Проверка работоспособности (Smoke test, Sanity check)" title="Прямая ссылка на Проверка работоспособности (Smoke test, Sanity check)">​</a></h4><p>  Это частный случай интеграционного теста. Обычно это очень небольшие тесты, которые прогоняются перед запуском системы, чтобы убедиться в работоспособности стороннего ПО, которое необходимо для корректного функционирования нашей системы. В случае провала таких тестов, мы можем оповестить пользователя о проблеме или и вовсе остановить запуск системы.</p><p>  Дымовое тестирование - пришло из сферы проверки оборудования, если, после подачи питания, появляется дым и запах гари, то оборудование неисправно.</p><p>Также дымовыми тестами можно сопровождать рефакторинг legacy кода, потому что написание полноценных юниттестов может быть сильно затратно по времени.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="регрессионное-тестирование-regression-testing">Регрессионное тестирование (Regression testing)<a href="#регрессионное-тестирование-regression-testing" class="hash-link" aria-label="Прямая ссылка на Регрессионное тестирование (Regression testing)" title="Прямая ссылка на Регрессионное тестирование (Regression testing)">​</a></h4><p>  Это может быть любой вид теста из описанных выше, который пишется после того, как была обнаружена проблема. Тест должен эмулировать в точности шаги для воспроизведения проблемы. Наличие такого теста после исправления проблемы дает гарантию, что точно такой же баг, больше не появится в системе.</p><p><em>Что проверяется?</em>
Регрессионные тесты проверяют набор сценариев, которые раньше работали и должны быть относительно стабильными.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="прочее">Прочее<a href="#прочее" class="hash-link" aria-label="Прямая ссылка на Прочее" title="Прямая ссылка на Прочее">​</a></h4><ul><li>Приемочное тестирование</li><li>Проверка на уязвимости (Penetration test, Pentest)</li><li>Нагрузочное тестирование (Load testing)</li><li>Тестирование производительности (Performance testing)</li><li>Фаззинг тест (Fuzzing test, Fuzztest, Random test)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="чем-интеграционное-тестирование-отличается-от-функционального">Чем интеграционное тестирование отличается от функционального<a href="#чем-интеграционное-тестирование-отличается-от-функционального" class="hash-link" aria-label="Прямая ссылка на Чем интеграционное тестирование отличается от функционального" title="Прямая ссылка на Чем интеграционное тестирование отличается от функционального">​</a></h3><ul><li><a href="http://juice-health.ru/program/software-testing/497-integration-and-functional-testing" target="_blank" rel="noopener noreferrer">Сравнение интеграционного и функционального тестирования</a></li></ul><p>Интеграционное и функциональное тестирования - это две фазы в процессе тестирования программного обеспечения. Первое проводится после модульного тестирования, а второе - метод тестирования черного ящика.</p><p><em>Функциональное тестирование также упоминается как тестирование Е2Е для тестирования браузера.</em></p><div class="language-md codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-md codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url operator" style="color:#D73A49">!</span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">Рис. Интеграционное тестирование против функционального тестирования</span><span class="token url" style="color:#36acaa">](</span><span class="token url" style="color:#36acaa">attachments/aed78f00.png</span><span class="token url" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="функциональное-программирование">Функциональное программирование<a href="#функциональное-программирование" class="hash-link" aria-label="Прямая ссылка на Функциональное программирование" title="Прямая ссылка на Функциональное программирование">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-функциональное-программирование">Что такое функциональное программирование<a href="#что-такое-функциональное-программирование" class="hash-link" aria-label="Прямая ссылка на Что такое функциональное программирование" title="Прямая ссылка на Что такое функциональное программирование">​</a></h3><ul><li><a href="https://medium.com/@kiky.tokamuro/%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5-%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B2-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D0%B0%D1%85-be5ebe4a6053" target="_blank" rel="noopener noreferrer">Функциональное программирование в примерах</a></li></ul><p>Функциональное программирование – раздел дискретной математики и парадигма программирования, в которой процесс вычисления трактуется как вычисление значений функций в математическом понимании последних (в отличие от функций как подпрограмм в процедурном программировании).
Противопоставляется парадигме императивного программирования, которая описывает процесс вычислений как последовательное изменение состояний (в значении, подобном таковому в теории автоматов)</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-у-python-с-поддержкой-функционального-программирования">Как у Python с поддержкой функционального программирования<a href="#как-у-python-с-поддержкой-функционального-программирования" class="hash-link" aria-label="Прямая ссылка на Как у Python с поддержкой функционального программирования" title="Прямая ссылка на Как у Python с поддержкой функционального программирования">​</a></h3><p>Python частично поддерживает парадигму функционального программирования и позволяет писать код в функциональном стиле. Кроме того, в нём присутствуют определённые возможности, характерные для функциональных языков или впервые появившиеся в функциональных языках (списковые включения, лямбда-функции, функции высшего порядка и т.д.).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-объект-первого-класса">Что такое объект первого класса<a href="#что-такое-объект-первого-класса" class="hash-link" aria-label="Прямая ссылка на Что такое объект первого класса" title="Прямая ссылка на Что такое объект первого класса">​</a></h3><p>Объектами первого класса (англ. first-class object, first-class entity, first-class citizen) в контексте конкретного языка программирования называются сущности, которые могут быть переданы как параметр, возвращены из функции, присвоены переменной.</p><p>Объект называют «объектом первого класса», если он:</p><ul><li>может быть сохранен в переменной или структурах данных;</li><li>может быть передан в функцию как аргумент;</li><li>может быть возвращен из функции как результат;</li><li>может быть создан во время выполнения программы;</li><li>внутренне самоидентифицируем (независим от именования).</li></ul><p>Термин «объект» используется здесь в общем смысле, и не ограничивается объектами языка программирования.
В Python, как и в функциональных языках, функции являются объектами первого класса.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-функция-высшего-порядка">Что такое функция высшего порядка<a href="#что-такое-функция-высшего-порядка" class="hash-link" aria-label="Прямая ссылка на Что такое функция высшего порядка" title="Прямая ссылка на Что такое функция высшего порядка">​</a></h3><p>Функция высшего порядка – функция, принимающая в качестве аргументов другие функции или возвращающая другую функцию в качестве результата. Основная идея состоит в том, что функции имеют тот же статус, что и другие объекты данных.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-каррирование">Что такое каррирование<a href="#что-такое-каррирование" class="hash-link" aria-label="Прямая ссылка на Что такое каррирование" title="Прямая ссылка на Что такое каррирование">​</a></h3><p><em>Карринг</em> — это преобразование функции от многих аргументов в набор функций, каждая из которых является функцией от одного аргумента. Мы можем передать часть аргументов в функцию и получить обратно функцию, ожидающую остальные аргументы. Это преобразование было введено М. Шейнфинкелем и Г. Фреге и получило свое название в честь Х. Карри.</p><p>Создадим простую функцию greet, которая принимает в качестве аргументов приветствие и имя:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">greet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;, &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Hello&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;German&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Небольшое улучшение позволит нам создать новую функцию для любого типа приветствия и передать этой новой функции имя:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">greet_curried</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">greet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;, &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> greet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet_hello </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> greet_curried</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Hello&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet_hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;German&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet_hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Ivan&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Или напрямую <code>greet_curried</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">greet_curried</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Hi&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Roma&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">А дальше можно сделать это с любым количеством аргументов</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">greet_deeply_curried</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">w_separator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">separator</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">w_emphasis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emphasis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">w_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greeting </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> separator </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> name </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> emphasis</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> w_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> w_emphasis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> w_separator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> greet_deeply_curried</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Hello&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;German&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Ivan&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="опишите-функции-map-reduce-filter-модуля-functools">Опишите функции map, reduce, filter модуля functools<a href="#опишите-функции-map-reduce-filter-модуля-functools" class="hash-link" aria-label="Прямая ссылка на Опишите функции map, reduce, filter модуля functools" title="Прямая ссылка на Опишите функции map, reduce, filter модуля functools">​</a></h3><p>Функция <code>map</code> применяет функцию к каждому элементу последовательности. В Python 2 возвращает список, в Python 3 – объект-итератор.</p><p>Функция <code>filter</code> оставляет лишь те элементы последовательности, для которых заданная функция истинна. В Python 2 возвращает список, в Python 3 – объект-итератор.</p><p>Функция <code>reduce</code> (в Python 2 встроенная, в Python 3 находится в модуле functools) принимает функцию от двух аргументов, последовательность и опциональное начальное значение и вычисляет свёртку (fold) последовательности как результат последовательного применения данной функции к текущему значению (так называемому аккумулятору) и следующему элементу последовательности.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-еще-вы-знаете-функции-из-модуля-functools">Какие еще вы знаете функции из модуля functools<a href="#какие-еще-вы-знаете-функции-из-модуля-functools" class="hash-link" aria-label="Прямая ссылка на Какие еще вы знаете функции из модуля functools" title="Прямая ссылка на Какие еще вы знаете функции из модуля functools">​</a></h3><p>Модуль functools содержит большое количество стандартных функций высшего порядка. Среди них особенно полезны:</p><ul><li>lru_cache – декоратор, который кеширует значения функций, которые не меняют свой результат при неизменных аргументах; полезен для кеширования данных, мемоизации (сохранения результатов для возврата без вычисления функции) значений рекурсивных функций (например, такого типа, как функция вычисления n-го числа Фибоначчи) и т.д.;</li><li>partial – частичное применение функции (вызов функции с меньшим количеством аргументов, чем она ожидает, и получение функции, которая принимает оставшиеся параметры).</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-вы-функции-знаете-из-модуля-itertools">Какие вы функции знаете из модуля itertools<a href="#какие-вы-функции-знаете-из-модуля-itertools" class="hash-link" aria-label="Прямая ссылка на Какие вы функции знаете из модуля itertools" title="Прямая ссылка на Какие вы функции знаете из модуля itertools">​</a></h3><p>Модуль itertools содержит функции для работы с итераторами и создания итераторов.
Некоторые из его функций:</p><ul><li><code>product</code> – декартово произведение итераторов (для избегания вложенных циклов for);</li><li><code>permutations</code> – генерация перестановок;</li><li><code>combinations</code> – генерация сочетаний;</li><li><code>combinations_with_replacement</code> – генерация размещений;</li><li><code>chain</code> – соединение нескольких итераторов в один;</li><li><code>takewhile</code> – получение значений последовательности, пока значение функции-предиката для её элементов истинно;</li><li><code>dropwhile</code> – получение значений последовательности начиная с элемента, для которого значение функции-предиката перестанет быть истинно.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="для-чего-нужен-модуль-operator">Для чего нужен модуль operator<a href="#для-чего-нужен-модуль-operator" class="hash-link" aria-label="Прямая ссылка на Для чего нужен модуль operator" title="Прямая ссылка на Для чего нужен модуль operator">​</a></h3><p>Модуль operator содержит функции, которые соответствуют стандартным операторам. Таким образом, вместо lambda x, y: x + y можно использовать уже готовую функцию operator.add и т.д.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gil-потоки-процессы">GIL, потоки, процессы<a href="#gil-потоки-процессы" class="hash-link" aria-label="Прямая ссылка на GIL, потоки, процессы" title="Прямая ссылка на GIL, потоки, процессы">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-gil-какие-у-него-есть-проблемы">Что такое GIL. Какие у него есть проблемы<a href="#что-такое-gil-какие-у-него-есть-проблемы" class="hash-link" aria-label="Прямая ссылка на Что такое GIL. Какие у него есть проблемы" title="Прямая ссылка на Что такое GIL. Какие у него есть проблемы">​</a></h3><ul><li><a href="https://wiki.python.org/moin/GlobalInterpreterLock" target="_blank" rel="noopener noreferrer">GlobalInterpreterLock</a></li><li><a href="https://habr.com/ru/post/84629/" target="_blank" rel="noopener noreferrer">Как устроен GIL в Python</a></li></ul><p>В любой момент может выполняться только один поток Python. Глобальная блокировка интерпретатора — GIL — тщательно контролирует выполнение тредов. GIL гарантирует каждому потоку эксклюзивный доступ к переменным интерпретатора (и соответствующие вызовы C-расширений работают правильно).</p><p>Принцип работы прост. Потоки удерживают GIL, пока выполняются. Однако они освобождают его при блокировании для операций ввода-вывода. Каждый раз, когда поток вынужден ждать, другие, готовые к выполнению, потоки используют свой шанс запуститься.</p><p>Когда поток начинает работу, он выполняет захват GIL. Спустя какое-то время планировщик процессов решает, что текущий поток поработал достаточно, и передает управление следующему потоку. Поток №2 видит, что GIL захвачен, так что он не продолжает работу, а погружает себя в сон, уступая процессор потоку №1.</p><p>Но поток не может удерживать GIL бесконечно. До Python 3.3 GIL переключался каждые 100 инструкций машинного кода. В поздних версиях GIL может быть удержан потоком не дольше 5 мс. GIL так-же освобождается, если поток совершает системный вызов, работает с диском или сетью.</p><p>Проблема в том, что из-за GIL далеко не все задачи могут быть решены в тредах. Напротив, их использование чаще всего снижает быстродействие программы (при CPU-bound задачах). С использованием тредов требуется следить за доступом к общим ресурсам: словарям, файлам, соединением к БД.</p><ul><li>GIL упрощает интеграцию non thread safe библиотек на С. Благодаря GIL у нас так много быстрых модулей и биндингов почти ко всему.</li><li>Библиотекам на C доступен механизм управления GIL. Так например NumPy отпускает его на долгих операциях.</li></ul><p>По сути, GIL в питоне делает бесполезной идею применять потоки для параллелизма в вычислительных задачах. Они будут работать последовательно даже на многопроцессорной системе. На CPU Bound задачах программа не ускорится, а только замедлится, так как теперь потокам придется делить пополам процессорное время. При этом I/O операции GIL не замедлит, так как перед системным вызовом поток отпускает GIL.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="работали-ли-вы-с-asyncio-в-чём-его-особенность">Работали ли Вы с asyncio. В чём его особенность<a href="#работали-ли-вы-с-asyncio-в-чём-его-особенность" class="hash-link" aria-label="Прямая ссылка на Работали ли Вы с asyncio. В чём его особенность" title="Прямая ссылка на Работали ли Вы с asyncio. В чём его особенность">​</a></h3><ul><li><a href="https://webstudio-uwk.ru/asinhronnoe-programmirovanie-v-python/" target="_blank" rel="noopener noreferrer">Асинхронное программирование в Python</a></li></ul><p>Представим, что мы пишем HTTP или WebSocket сервер, который каждое подключение обрабатывает в отдельном потоке.</p><p>Здесь вполне можно создать 100, может даже 500 потоков, чтобы обработать нужное количество одновременных соединений. Для коротких запросов это даже будет работать и позволит выдержать нагрузку в 5000 RPS на самом дешевом инстансе в DO за пять баксов — вполне неплохо. Если у вас меньше, возможно здесь и не нужны никакие AsyncIO/Tornado/Twisted.</p><p>Но что, если их количество стремится к бесконечности? Скажем, это большой чат с кучей каналов, где количество одновременных участников не ограничено. В такой ситуации создать столько потоков, чтобы хватило каждому пользователю я бы уже не рискнул. И вот почему:</p><p>Как говорилось выше, пока GIL захвачен одним потоком, другие работать не будут. Планировщик операционной системы, при этом, о GIL ничего не знает и все равно будет отдавать процессор заблокированный потокам. Такой поток, конечно, увидит что GIL захвачен и сразу же уснет, но на переключение контекста процессора будет тратиться драгоценное время.</p><p>Переключение контекста — вообще дорогая для процессора операция, которая требует сброса регистров, кэша и таблицы отображения страниц памяти. Чем больше потоков запущено, тем больше процессор совершает холостых переключений на потоки, заблокированные GIL, прежде чем дойдет до того самого, который этот GIL удерживает. Не очень-то эффективно.</p><p>Есть старые добрые сопрограммы — то, что сейчас предлагает AsyncIO и Tornado. Их еще называют корутинами или просто потоками на уровне пользователя. Модная нынче штука, но, далеко не новая, а использовалась еще во времена, когда в ходу были ОС без поддержки многозадачности.</p><p>В отличи от потоков, сопрограммы выполняют только полезную работу, а переключение между ними происходит только в тот момент, когда сопрограмма ожидает завершения какой-то внешней операции.</p><p>Как и в случае с тредами, асинхронщина бесполезна для вычислений. Тут ситуация даже хуже, так как зависший на вычислениях поток рано или поздно GIL отпустит, а вот блокирующий код в сопрограмме заблокирует весь поток, до тех пор, пока не исполнится весь. В отличии от нативных тредов, у сопрограмм отсутствует прерывание по таймеру. Передача управления следующей сопрограмме происходит вручную, при явном вызове конструкции await (или yield, если используются generator-based корутины). Поэтому важно следить, чтобы в асинхронных программах не было блокирующего кода и использовались только асинхронные вызовы, а все вычисления происходили в отдельных процессах.</p><p>Потоки будут проще, если у вас типичное веб-приложение, которое не зависит от внешних сервисов, и относительно конечное количество клиентов, для которых время ответа будет предсказуемо-коротким.</p><p>AsyncIO подойдет, если приложение большую часть времени тратит на чтение/запись данных, а не их обработку. Например, у вас много медленных запросов — вебсокеты, long polling или есть медленные внешние синхронные бекенды, запросы к которым неизвестно когда завершатся.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-asyncawait-для-чего-они-нужны-и-как-их-использовать">Что такое async/await, для чего они нужны и как их использовать<a href="#что-такое-asyncawait-для-чего-они-нужны-и-как-их-использовать" class="hash-link" aria-label="Прямая ссылка на Что такое async/await, для чего они нужны и как их использовать" title="Прямая ссылка на Что такое async/await, для чего они нужны и как их использовать">​</a></h3><p>Ключевое слово <code>async</code> идет до <code>def</code>, чтобы показать, что метод является асинхронным. Ключевое слово <code>await</code> показывает, что вы ожидаете завершения сопрограммы.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> asyncio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> aiohttp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">urls </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;http://www.google.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;http://www.yandex.ru&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;http://www.python.org&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">async</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call_url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Starting {}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">await</span><span class="token plain"> aiohttp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;{}: {} bytes: {}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">futures </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">call_url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> url </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> urls</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loop </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> asyncio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_event_loop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">loop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run_until_complete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">asyncio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">futures</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Программа состоит из метода async. Во время выполнения он возвращает сопрограмму, которая затем находится в ожидании.</p><p><code>async/await</code> нужен для того, чтобы не блокировать поток выполнения на время ожидания какого-нибудь асинхронного события. Конструкция <code>async/await</code> превращает по сути процедуру в корутину (сопрограмму): она прекращает своё выполнение на время <code>await</code>, дожидается асинхронного события, и возобновляет работу.</p><p>В не-async-варианте ожидание получается блокирующим, или нужно вручную делать трюки: запускать операцию и подписываться на её окончание. Async делает код более простым, линейным.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-в-питоне-реализуется-многопоточность-какими-модулями">Как в питоне реализуется многопоточность. Какими модулями<a href="#как-в-питоне-реализуется-многопоточность-какими-модулями" class="hash-link" aria-label="Прямая ссылка на Как в питоне реализуется многопоточность. Какими модулями" title="Прямая ссылка на Как в питоне реализуется многопоточность. Какими модулями">​</a></h3><p>Многопоточность достигается модулем Threading. Это нативные Posix-треды. Такие треды исполняются операционной системой, а не виртуальной машиной.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-отличие-тредов-от-мультипроцессинга">В чем отличие тредов от мультипроцессинга<a href="#в-чем-отличие-тредов-от-мультипроцессинга" class="hash-link" aria-label="Прямая ссылка на В чем отличие тредов от мультипроцессинга" title="Прямая ссылка на В чем отличие тредов от мультипроцессинга">​</a></h3><p>Главное отличие в разделении памяти. Процессы независимы друг от друга, имеют раздельные адресные пространства, идентификаторы, ресурсы. Треды исполняются в совместном адресном порстранстве, имеют общий доступ к памяти, переменным, загруженным модулям.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-задачи-хорошо-параллелятся-какие-плохо">Какие задачи хорошо параллелятся, какие плохо<a href="#какие-задачи-хорошо-параллелятся-какие-плохо" class="hash-link" aria-label="Прямая ссылка на Какие задачи хорошо параллелятся, какие плохо" title="Прямая ссылка на Какие задачи хорошо параллелятся, какие плохо">​</a></h3><p>Хорошо параллелятся задачи, которые порождают долгий IO. Когда тред упирается в ожидание сокета или диска, интерпретатор бросает этот тред и стартует следующий. Это значит, не будет простоя из-за ожидания. Наоборот, если ходить в сеть в одном треде (в цикле), то каждый раз придется ждать ответа.</p><p>Однако, если затем в треде обрабатывает полученные данные, то выполнятся будет только он один. Это не только не даст прироста в скорости, но и замедлит программу из-за переключения на другие треды.</p><p>Короткий ответ: хорошо ложатся на треды задачи по работе с сетью. Например, выкачать сто урлов. Полученные данные обрабатывайте вне тредов.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="нужно-посчитать-100-уравнений-делать-это-в-тредах-или-нет">Нужно посчитать 100 уравнений. Делать это в тредах или нет<a href="#нужно-посчитать-100-уравнений-делать-это-в-тредах-или-нет" class="hash-link" aria-label="Прямая ссылка на Нужно посчитать 100 уравнений. Делать это в тредах или нет" title="Прямая ссылка на Нужно посчитать 100 уравнений. Делать это в тредах или нет">​</a></h3><p>Нет, потому что в этой задаче нет ввода-вывода. Интерпретатор только будет тратить лишнее время на переключение тредов. Сложные математические задачи лучше выносить в отдельные процессы, либо использовать фреймворк для распределенных задач Celery, либо подключать как C-библиотеки.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="треды-в-питоне--это-нативные-треды-или-нет">Треды в Питоне — это нативные треды или нет<a href="#треды-в-питоне--это-нативные-треды-или-нет" class="hash-link" aria-label="Прямая ссылка на Треды в Питоне — это нативные треды или нет" title="Прямая ссылка на Треды в Питоне — это нативные треды или нет">​</a></h3><p>Да, это нативные Posix-совместимые треды, которые исполняются на уровне операционной системы.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-гринлеты-общее-понятие-примеры-реализаций">Что такое гринлеты. Общее понятие. Примеры реализаций<a href="#что-такое-гринлеты-общее-понятие-примеры-реализаций" class="hash-link" aria-label="Прямая ссылка на Что такое гринлеты. Общее понятие. Примеры реализаций" title="Прямая ссылка на Что такое гринлеты. Общее понятие. Примеры реализаций">​</a></h3><p>Greenlet == Green thread == Зеленые треды == легковесные треды внутри виртуальной машины. Могут называться корутинами, сопроцессами, акторами и т.д. в зависимости от платформы. Операционная система не видит их. С точки зрения ОС запущен один процесс виртуальной машины, а что внутри нее – неизвестно. Такими тредами управляет сама вируальная машина: порождает, исполняет, согласует доступ к ресурсам.</p><p>Примеры: корутины в языках Go и Lua, легковесные процессы в Erlang, модуль greenlet для Python. Модуль gevent использует гринлеты</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-варианты-реализации-шаблона-singleton-на-питоне">Какие варианты реализации шаблона Singleton на питоне<a href="#какие-варианты-реализации-шаблона-singleton-на-питоне" class="hash-link" aria-label="Прямая ссылка на Какие варианты реализации шаблона Singleton на питоне" title="Прямая ссылка на Какие варианты реализации шаблона Singleton на питоне">​</a></h2><ul><li><a href="https://stackoverflow.com/questions/6760685/creating-a-singleton-in-python" target="_blank" rel="noopener noreferrer">Creating a singleton in Python</a></li></ul><p><strong>Декоратор:</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">singleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    instances </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">getinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> class_ </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> instances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            instances</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> class_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> instances</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> getinstance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@singleton</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MyClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseClass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Достоиства:</em></p><ul><li>Декораторы зачастую более интуитивны, чем множественное наследование.</li></ul><p><em>Недостатки:</em></p><ul><li>Хотя объекты, созданные с использованием <code>MyClass()</code>, будут настоящими singleton объектами, сам <code>MyClass</code> является функцией, а не классом, поэтому вы не можете вызывать методы класса из него.</li><li>Увеличивает сложность тестирования</li></ul><p><strong>Base class:</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Singleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _instance </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token builtin">isinstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> class_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            class_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instance </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">class_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> class_</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MyClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Singleton</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BaseClass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Достоиства:</em></p><ul><li>Это настоящий класс.</li></ul><p><em>Недостатки:</em></p><ul><li>Множественное наследование усложняет код. <code>__new__</code> может быть перезаписан во время наследования от второго базового класса?</li></ul><p><strong>Метаклассы:</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Singleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _instances </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__call__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> cls </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instances</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instances</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Singleton</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__call__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_instances</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">#Python2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MyClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseClass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __metaclass__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Singleton</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">#Python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MyClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseClass</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metaclass</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">Singleton</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Достоиства:</em></p><ul><li>Это настоящий класс</li><li>Автомагически покрывает наследование</li><li>Используем метаклассы по их прямому назначению</li></ul><p><em>Недостатки:</em></p><ul><li>А они есть?</li></ul><p><strong>Модуль:</strong></p><p><em>Достоиства:</em></p><ul><li>Простота</li></ul><p><em>Недостатки:</em></p><ul><li>Не инициализируется лениво</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-вы-знаете-инструменты-для-проверки-кодстайл">Какие вы знаете инструменты для проверки кодстайл<a href="#какие-вы-знаете-инструменты-для-проверки-кодстайл" class="hash-link" aria-label="Прямая ссылка на Какие вы знаете инструменты для проверки кодстайл" title="Прямая ссылка на Какие вы знаете инструменты для проверки кодстайл">​</a></h2><ul><li><a href="https://proglib.io/p/python-code-analysis/" target="_blank" rel="noopener noreferrer">Инструменты для анализа кода Python. Часть 1</a></li><li><a href="https://proglib.io/p/python-code-analysis-tools/" target="_blank" rel="noopener noreferrer">Инструменты для анализа кода Python. Часть 2</a></li></ul><p><strong>Pycodestyle</strong> — простая консольная утилита для анализа кода Python, а именно для проверки кода на соответствие PEP8. Один из старейших анализаторов кода, до 2016 года носил название pep8, но был переименован по просьбе создателя языка Python Гвидо ван Россума.</p><p><strong>Pydocstyle</strong> проверяет наличие docstring у модулей, классов, функций и их соответствие официальному соглашению PEP257.</p><p><strong>Pylint</strong> совместил в себе как поиск логических так и стилистических ошибок. Этот мощный, гибко настраиваемый инструмент для анализа кода Python отличается большим количеством проверок и разнообразием отчетов.</p><p><strong>Vulture</strong> — небольшая утилита для поиска “мертвого” кода в программах Python. Она использует модуль ast стандартной библиотеки и создает абстрактные синтаксические деревья для всех файлов исходного кода в проекте. Далее осуществляется поиск всех объектов, которые были определены, но не используются. Vulture полезно применять для очистки и нахождения ошибок в больших базовых кодах.</p><p><strong>Flake8</strong> — обвязка к входящим в нее утилитам — pyflakes, pycodestyle, mccabe. Flake8 имеет схожий с pylint основной функционал. Однако она имеет ряд отличий и особенностей:</p><ul><li>Возможности статистических отчетов ограничены подсчетом количества каждой из ошибок (—statistics) и их общим количеством (—count).</li><li>Для запуска в несколько потоков (<code>—jobs=&lt;num&gt;</code>) используется модуль multiprocessing, по этой причине многопоточность не будет работать на Windows системах.</li><li>Отсутствует возможность генерации отчетов в формате json, при вызове с ключом —bug-report создается только заголовок для отчета с указанием платформы и версий входящих утилит.</li><li>Комментарии в коде блокирующие вывод. Добавление в строку с ошибкой комментария # noqa, уберет ее из отчета.</li><li>Во время редактирования для подавления отдельных ошибок “на лету” можно перечислить исключаемые ошибки в ключе <code>—extend-ignore=&lt;errors&gt;</code></li><li>Проверка синтаксиса в строках doctest (—doctests).</li><li>Наличие Version Control Hooks. Интеграция с системами контроля версий происходит буквально с помощью двух команд (поддерживаются git и mercurial).</li><li>Расширяемость. Flake8 для анализа кода Python позволяет создавать и использовать плагины. С помощью плагинов в Flake8 можно: добавить дополнительные проверки, использовать другие форматы отчетов или автоматически исправлять найденные ошибки. На PyPi можно найти большое количество open-source плагинов.</li></ul><p><strong>Prospector</strong> — это инструмент для анализа кода Python. Объединяет функциональность других инструментов анализа Python, таких как pylint, pep8, mccabe, Pyflakes, Dodgy, pydocstyle (экспериментально, возможны ошибки). Дополнительно можно подключить mypy, pyroma, vulture. Главной особенностью prospector является наличие предустановленных профилей, которые содержат настройки входящих в него утилит, призванных подавить наиболее придирчивые предупреждения и оставить только важные сообщения.</p><p><strong>Pylama</strong> — инструмент аудита кода для Python и JavaScript. Служит оберткой на такими утилитами как: pydocstyle, pycodestyle, pyflakes, mccabe, pylint, radon (инструмент для сбора и вычисления различных метрик из исходного кода). Для работы с работы с JavaScript кодом используется gjslint.</p><p><strong>autopep8</strong> модифицирует код, не совместимый с PEP8. Проверка соответствия соглашениям осуществляется с помощью утилиты pycodestyle. В autopep8 есть поддержка многопоточности, рекурсивного обхода каталогов, возможность сохранения настроек в файле, задание диапазона строк для исправления, фильтрация ошибок и непосредственное изменение проверяемого файла.</p><p><strong>yapf</strong> похож на autopep8, но использует другой подход, который основан на «clang-format», разработанном Дэниелом Джаспером. Отформатированный yapf код, будет не только соблюдать принятые соглашения, но и выглядеть так, словно был написан хорошим программистом. Вторым важным отличием является возможность задавать стили. Для этого воспользуйтесь ключом —style и в качестве аргумента передайте файл с настройками или одно из предопределенных значений (pep8, google, chromium, facebook).</p><p><strong>black</strong> — это бескомпромиссный форматировщик, который работает быстро и экономит время и умственную энергию программистов для более важных вопросов.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-listdict-comprehension">Что такое list/dict comprehension<a href="#что-такое-listdict-comprehension" class="hash-link" aria-label="Прямая ссылка на Что такое list/dict comprehension" title="Прямая ссылка на Что такое list/dict comprehension">​</a></h2><p>Выражение заключенное в квадратные/фигурные скобки, в котором используются ключевые слова <code>for</code> и <code>in</code> для построения списка/словаря путем обработки и фильтрации элементов из одного или нескольких итерируемых объектов. Списковое включение работает энергично.</p><p><em>Энергичный</em> - итерируемый объект, который сразу строит все свои элементы. В Python включения - энергичные операции. Противоположность - <em>ленивый</em>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-между-одинарным-и-двойным-подчеркиванием">Какая разница между одинарным и двойным подчеркиванием<a href="#какая-разница-между-одинарным-и-двойным-подчеркиванием" class="hash-link" aria-label="Прямая ссылка на Какая разница между одинарным и двойным подчеркиванием" title="Прямая ссылка на Какая разница между одинарным и двойным подчеркиванием">​</a></h2><ul><li><a href="https://hackernoon.com/understanding-the-underscore-of-python-309d1a029edc" target="_blank" rel="noopener noreferrer">Understanding the underscore of Python</a></li></ul><p>Есть 5 кейсов использования подчеркивая в Python:</p><ol><li>Для хранения значения последнего выражения в REPL</li><li>Игнорирования значения</li><li>Для опеределения специального значения функции или переменной<ul><li>одинарное в начале или конце названия</li><li>двойное в начале</li><li>двойное в начале и конце</li></ul></li><li>Для использования в качестве функции локализации</li><li>Для разделения символов числа (<code>1_00 == 100</code>)</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="отличие-copy-от-deepcopy">Отличие copy() от deepcopy()<a href="#отличие-copy-от-deepcopy" class="hash-link" aria-label="Прямая ссылка на Отличие copy() от deepcopy()" title="Прямая ссылка на Отличие copy() от deepcopy()">​</a></h2><ul><li><a href="https://stackabuse.com/deep-vs-shallow-copies-in-python/" target="_blank" rel="noopener noreferrer">Deep vs Shallow Copies in Python</a></li></ul><p>Глубокая копия <code>deepcopy()</code> создает новую и отдельную копию всего объекта или списка со своим уникальным адресом памяти. Это означает, что любые изменения, внесенные вами в новую копию объекта или списка, не будут отражаться в исходной. Этот процесс происходит следующим образом: сначала создается новый список или объект, а затем рекурсивно копируются все элементы из исходного в новый.</p><p>Поверхностное копирование <code>copy()</code> также создает отдельный новый объект или список, но вместо копирования дочерних элементов в новый объект оно просто копирует ссылки на их адреса памяти. Следовательно, если вы сделаете изменение в исходном объекте, оно будет отражено в скопированном объекте, и наоборот. Короче говоря, обе копии зависят друг от друга.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-garbage-collector-в-чём-его-плюсы-и-минусы">Что такое garbage collector. В чём его плюсы и минусы<a href="#что-такое-garbage-collector-в-чём-его-плюсы-и-минусы" class="hash-link" aria-label="Прямая ссылка на Что такое garbage collector. В чём его плюсы и минусы" title="Прямая ссылка на Что такое garbage collector. В чём его плюсы и минусы">​</a></h2><ul><li><a href="https://habr.com/ru/post/417215/" target="_blank" rel="noopener noreferrer">Всё, что нужно знать о сборщике мусора в Python</a></li></ul><p>GC (generational garbage collector) - это сборщик мусора, создавался он в первую очередь для обнаружения и удаления циклических ссылок.
<code>gc</code> является встроенным в python модулем и при необходимости его можно выключить и запускать вручную (или не запускать). Чтобы понимать для чего был создан GC нужно понимать как в Python работает менеджер памяти и как эта память высвобождается.</p><p>В отличие от других популярных языков, Python не освобождает всю память обратно операционной системе как только он удаляет какой либо объект. Вместо этого, он использует дополнительный менеджер памяти, предназначенный для маленьких объектов (размер которых меньше чем 512 байт). Для работы с такими объектами он выделяет большие блоки памяти, в которых в дальнейшем будет хранится множество маленьких объектов.</p><p>Как только один из маленьких объектов удаляется — память из под него не переходит операционной системе, Python оставляет её для новых объектов с таким же размером. Если в одном из выделенных блоков памяти не осталось объектов, то Python может высвободить его операционной системе. Как правило, высвобождение блоков случается когда скрипт создает множество временных объектов.</p><p>Таким образом, если долгоживущий Python процесс с течением времени начинает потреблять больше памяти, то это совсем не означает, что в вашем коде есть проблема с утечкой памяти.</p><p>Стандартный интерпретатор питона (CPython) использует сразу два алгоритма сборки мусора, подсчет ссылок и generational garbage collector (далее GC), более известный как стандартный модуль gc из Python.</p><p>Алгоритм подсчета ссылок очень простой и эффективный, но у него есть один большой недостаток. Он не умеет определять циклические ссылки. Именно из-за этого, в питоне существует дополнительный сборщик, именуемый поколенческий GC, который следит за объектами с потенциальными циклическими ссылками.</p><p>В Python, алгоритм подсчета ссылок является фундаментальным и не может быть отключен, тогда как GC опционален и может быть отключен.</p><p>В отличие от алгоритма подсчета ссылок, циклический GC не работает в режиме реального времени и запускается периодически. Каждый запуск сборщика создаёт микропаузы в работе кода, поэтому CPython (стандартный интерпретатор) использует различные эвристики, для определения частоты запуска сборщика мусора.</p><p>Циклический сборщик мусора разделяет все объекты на 3 поколения (генерации). Новые объекты попадают в первое поколение. Если новый объект выживает после процесса сборки мусора, то он перемещается в следующее поколение. Чем выше поколение, тем реже оно сканируется на мусор. Так-как новые объекты зачастую имеют очень маленький срок жизни (являются временными), то имеет смысл опрашивать их чаще, чем те, которые уже прошли через несколько этапов сборки мусора.</p><p>В каждой генерации есть специальный счетчик и порог срабатывания, при достижении которых срабатывает процесс сборки мусора. Каждый счетчик хранит количество аллокаций минус количество деаллокаций в данной генерации. Как только в Python создается какой либо контейнерный объект, он проверяет эти счетчики. Если условия срабатывают, то начинается процесс сборки мусора.</p><p>Если сразу несколько или больше поколений преодолели порог, то выбирается наиболее старшее поколение. Это сделано из-за того, что старые поколения также сканируют все предыдущие. Чтобы сократить число пауз сборки мусора для долгоживущих объектов, самая старшая генерация имеет дополнительный набор условий.</p><p>Стандартные пороги срабатывания для поколений установлены на 700, 10 и 10 соответственно, но вы всегда можете их изменить с помощью функций gc.get_threshold и gc.set_threshold.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-интроспекция">Что такое интроспекция<a href="#что-такое-интроспекция" class="hash-link" aria-label="Прямая ссылка на Что такое интроспекция" title="Прямая ссылка на Что такое интроспекция">​</a></h2><ul><li><a href="http://zetcode.com/lang/python/introspection/" target="_blank" rel="noopener noreferrer">Introspection in Python</a></li></ul><p><em>Интроспекция</em> — это способность программы исследовать тип или свойства объекта во время работы программы. Вы можете поинтересоваться, каков тип объекта, является ли он экземпляром класса. Некоторые языки даже позволяют узнать иерархию наследования объекта. Возможность интроспекции есть в таких языках, как Ruby, Java, PHP, Python, C++ и других. В целом, инстроспекция — это очень простое и очень мощное явление. Вот несколько примеров использования инстроспекции:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Java</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if(obj instanceof Person){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Person p = (Person)obj;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p.walk();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//PHP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ($obj instanceof Person) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   // делаем что угодно</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>В Python самой распространённой формой интроспекции является использование метода dir для вывода списка атрибутов объекта:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic"># Python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> val</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">bar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">dir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#D73A49">=</span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;__class__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__delattr__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__dict__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__doc__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__getattribute__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__hash__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__init__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__module__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#C6105F">&#x27;__new__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__reduce__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__reduce_ex__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__repr__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__setattr__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__str__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__weakref__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;bar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;x&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-рефлексия">Что такое рефлексия<a href="#что-такое-рефлексия" class="hash-link" aria-label="Прямая ссылка на Что такое рефлексия" title="Прямая ссылка на Что такое рефлексия">​</a></h2><p>Интроспекция позволяет вам изучать атрибуты объекта во время выполнения программы, а рефлексия — манипулировать ими. <em>Рефлексия</em> — это способность компьютерной программы изучать и модифицировать свою структуру и поведение (значения, мета-данные, свойства и функции) во время выполнения. Простым языком: она позволяет вам вызывать методы объектов, создавать новые объекты, модифицировать их, даже не зная имён интерфейсов, полей, методов во время компиляции. Из-за такой природы рефлексии её труднее реализовать в статически типизированных языках, поскольку ошибки типизации возникают во время компиляции, а не исполнения программы (подробнее об этом здесь). Тем не менее, она возможна, ведь такие языки, как Java, C# и другие допускают использование как интроспекции, так и рефлексии (но не C++, он позволяет использовать лишь интроспекцию).</p><p>По той же причине рефлексию проще реализовать в интерпретируемых языках, поскольку когда функции, объекты и другие структуры данных создаются и вызываются во время работы программы, используется какая-то система распределения памяти. Интерпретируемые языки обычно предоставляют такую систему по умолчанию, а для компилируемых понадобится дополнительный компилятор и интерпретатор, который следит за корректностью рефлексии.</p><p><em>Пример</em>:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic"># Без рефлексии</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># С рефлексией</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">globals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;Foo&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;hello&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Django</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-middleware-для-чего-как-реализуется">Что такое Middleware, для чего, как реализуется<a href="#что-такое-middleware-для-чего-как-реализуется" class="hash-link" aria-label="Прямая ссылка на Что такое Middleware, для чего, как реализуется" title="Прямая ссылка на Что такое Middleware, для чего, как реализуется">​</a></h2><p>Middleware – особый объект, который обычно изменяет входящий запрос или исходящий ответ. Например, добавляет заголовки, делает предварительные проверки. Middleware нужен, когда требуется подвергнуть обработке все запросы приложения.</p><p>На уровне языка это объект с методами <code>process_request</code> и <code>process_response</code>. Методы должны вернуть принятый объект (запрос или ответ) для дальнейшей обработки или выкинуть исключение, если что-то не в порядке. В этом случает дальнейшая обработка прекращается.</p><p>Чтобы включить Middleware, достаточно добавить путь к нему в список <code>MIDDLEWARE</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="назовите-основные-мидлвари-зачем-они-нужны">Назовите основные мидлвари. Зачем они нужны<a href="#назовите-основные-мидлвари-зачем-они-нужны" class="hash-link" aria-label="Прямая ссылка на Назовите основные мидлвари. Зачем они нужны" title="Прямая ссылка на Назовите основные мидлвари. Зачем они нужны">​</a></h2><ul><li><code>SessionMiddleware</code> – поддержка сессий. Добавляет в запрос объект <code>session</code></li><li><code>CsrfViewMiddleware</code> – проверяет, что POST-запросы отправлены с текущего домена</li><li><code>AuthenticationMiddleware</code> – авторизует пользователя. Добавляет в запрос поле <code>user</code></li><li><code>MessageMiddleware</code> – передает пользователю короткие сообщения</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="опишите-алгоритм-работы-csrf-middleware">Опишите алгоритм работы CSRF middleware<a href="#опишите-алгоритм-работы-csrf-middleware" class="hash-link" aria-label="Прямая ссылка на Опишите алгоритм работы CSRF middleware" title="Прямая ссылка на Опишите алгоритм работы CSRF middleware">​</a></h2><p>На каждый запрос система генерирует уникальный токен и выставляет его в куках. В каждой форме размещается скрытое поле <code>csrf-token</code> с этим же токеном. При отправке формы методом <code>POST</code> Джанго проверяет, что поле формы и значение в куках совпадают. Если нет, это значит, что запрос подделан или отправлен с другого домена.</p><p>Чтобы освободить какую-то вьюху от проверки (если это API, например), достаточно обернуть ее декоратором <code>csrf_except</code>.</p><p>Промежуточный слой CSRF и шаблонный тег предоставляют легкую-в-использовании защиту против Межсайтовой подделки запроса. Этот тип атак случается, когда злонамеренный Web сайт содержит ссылку, кнопку формы или некоторый javascript, который предназначен для выполнения некоторых действий на вашем Web сайте, используя учетные данные авторизованного пользователя, который посещал злонамеренный сайт в своем браузере. Сюда также входит связанный тип атак, ‘login CSRF’, где атакуемый сайт обманывает браузер пользователя, авторизируясь на сайте с чужими учетными данными.</p><p>Первая защита против CSRF атак - это гарантирование того, что GET запросы (и другие ‘безопасные’ методы, определенные в 9.1.1 Safe Methods, HTTP 1.1, <a href="https://tools.ietf.org/html/rfc2616.html#section-9.1.1" target="_blank" rel="noopener noreferrer">RFC 2616#section-9.1.1</a>) свободны от побочных эффектов. Запросы через ‘небезопасные’ методы, такие как POST, PUT и DELETE могут быть защищены при помощи шагов, описанных ниже.</p><p><em>Как это работает:</em></p><p>CSRF базируется на следующих вещах:</p><ol><li><p>CSRF кука, которая устанавливается как случайное число (сессия независимого случайного слова, как это еще иногда называют), к которой другие сайты не будут иметь доступа. Эта кука устанавливается при помощи CsrfViewMiddleware. Она должно быть постоянной, но так как нет способа установить куки, у которых никогда не истекает время жизни, то она отправляется с каждым ответом, который вызывал django.middleware.csrf.get_token() (функция использовалась внутри для получения CSRF токена).</p></li><li><p>Все POST формы содержат скрытое поле ‘csrfmiddlewaretoken’. Значение поля равно CSRF куке. Эта часть выполняет шаблонным тегом.</p></li><li><p>Все HTTP запросы, которые не GET, HEAD, OPTIONS или TRACE, должны содержать CSRF куку, и поле ‘csrfmiddlewaretoken’ с правильным значением. Иначе пользователь получит 403 ошибку. Эта проверка выполняется в CsrfViewMiddleware.</p></li><li><p>В дополнение для HTTPS запросов в CsrfViewMiddleware проверяется “referer”(источник запроса). Это необходимо для предотвращения MITM-атаки(Man-In-The-Middle), которая возможна при использовании HTTPS и токена не привязанного к сессии, т.к. клиенты принимают(к сожалению) HTTP заголовок ‘Set-Cookie’, несмотря на то, что коммуникация с сервером происходит через HTTPS. (Такая проверка не выполняется для HTTP запросов т.к. “Referer” заголовок легко подменить при использовании HTTP.) Если указана настройка CSRF_COOKIE_DOMAIN, значение “referer” будет сравниваться с этим значением. Значение поддерживает под-домены. Например, CSRF_COOKIE_DOMAIN = &#x27;.example.com&#x27; позволить отправлять POST запросы с <a href="http://www.example.com" target="_blank" rel="noopener noreferrer">www.example.com</a> и api.example.com. Если настройка не указана, “referer” должен быть равен HTTP заголовку Host. Чтобы расширить список доступных доменов, кроме текущего хоста и домена кук, используйте CSRF_TRUSTED_ORIGINS.</p></li></ol><p>Такой подход гарантирует, что только формы, отправленные с доверенных доменов, могут передавать POST данные.</p><p>GET игнорируются сознательно (и все другие запросы, которые считаются “безопасными” в соответствии с RFC 2616). Эти запросы никогда не должны выполнять каких-либо потенциально опасные действия, и CSRF атаки через GET запрос должен быть безвредным. RFC 2616 определяет POST, PUT и DELETE как “небезопасные”.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-сигналы-зачем-нужны-назовите-основные">Что такое сигналы? Зачем нужны? Назовите основные<a href="#что-такое-сигналы-зачем-нужны-назовите-основные" class="hash-link" aria-label="Прямая ссылка на Что такое сигналы? Зачем нужны? Назовите основные" title="Прямая ссылка на Что такое сигналы? Зачем нужны? Назовите основные">​</a></h2><p>Сигналы – это события в экосистеме Джанго. С помощью сигналов подсистемы оповещают приложение о том, что случилось. Чтобы читать сигналы, программист регистрирет обработчики сигналов. Сигналы распространяются синхронно. Это значит, подписав на один сигнал сотню обработчиков, мы увеличим время, необходимое на отдачу ответа.</p><p>Основные сигналы это начало запроса и его окончание, перед сохранением модели и после, обращение к базе данных.</p><p><strong>Важно:</strong> сигналы моделей работают поштучно, то есть для одной модели. При пакетной обработке, например, <code>queryset.all().delete()</code> или <code>queryset.all().update({&#x27;foo&#x27;=42})</code>, события об удалении или изменения не будут вызваны.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-реализуется-связь-m2m-на-уровне-базы-данных">Как реализуется связь m2m на уровне базы данных<a href="#как-реализуется-связь-m2m-на-уровне-базы-данных" class="hash-link" aria-label="Прямая ссылка на Как реализуется связь m2m на уровне базы данных" title="Прямая ссылка на Как реализуется связь m2m на уровне базы данных">​</a></h2><p>Если есть модели A и B со связью многие ко многим, то создается таблица-мост с именем <code>a_to_b</code>, которая хранит ключ на A, ключ на B и дополнительные сведения, например, время, когда была создана связь. Эта таблица сцепляется с A и B оператором <code>JOIN</code>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="чем-лучше-отправлять-форму--get-или-post">Чем лучше отправлять форму — GET или POST<a href="#чем-лучше-отправлять-форму--get-или-post" class="hash-link" aria-label="Прямая ссылка на Чем лучше отправлять форму — GET или POST" title="Прямая ссылка на Чем лучше отправлять форму — GET или POST">​</a></h2><p>Форму можно отправлять обоими способами. В первом случае переменные прикрепляются к строке запроса после вопросительного знака. Во втором – передаются в теле запроса.</p><p>Техническое ограничение метода GET в том, что им нельзя передать файл, в отличие от POST.</p><p>Форму желательно передавать методом POST по следующим причинам:</p><ul><li>GET-запросы могут быть кешированы, особенно в браузерах семейства IE</li><li>GET-запросы оседают в логах провайдера, сервера, истории браузера. Пароль и логин в таком случае может засветиться во многих местах</li><li>некоторые вирусы отслеживают содержимое адресной строки и пересылают третьим лицам.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-работает-serializer-в-django-rest-framework">Как работает Serializer в Django REST Framework<a href="#как-работает-serializer-в-django-rest-framework" class="hash-link" aria-label="Прямая ссылка на Как работает Serializer в Django REST Framework" title="Прямая ссылка на Как работает Serializer в Django REST Framework">​</a></h2><p>Serializer преобразует информацию, хранящуюся в базе данных и определенную с помощью моделей Django, в формат, который легко и эффективно передается через API.</p><p>Модели Django интуитивно представляют данные, хранящиеся в базе, но API должен передавать информацию в менее сложной структуре. Хотя данные будут представлены как экземпляры классов Model, их необходимо перевести в формат JSON для передачи через API.</p><p>Сериализатор DRF производит это преобразование. Когда пользователь передает информацию (например, создание нового экземпляра) через API, сериализатор берет данные, проверяет их и преобразует в нечто, что Django может сложить в экземпляр модели. Аналогичным образом, когда пользователь обращается к информации через API, соответствующие экземпляры передаются в сериализатор, который преобразовывает их в формат, который может быть легко передан пользователю как JSON.</p><p>Наиболее распространенной формой, которую принимает сериализатор DRF, является тот, который привязан непосредственно к модели Django:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ThingSerializer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serializers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModelSerializer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Meta</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Thing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fields </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘name’</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Настройки fields позволяют точно указать, какие поля доступны этому сериализатору. В качестве альтернативы, может быть установлен exclude вместо fields, которое будет включать все поля модели, кроме тех, которые указаны в exclude.</p><p>Сериализаторы — это невероятно гибкий и мощный компонент DRF. Хотя подключение сериализатора к модели является наиболее распространенным, сериализаторы могут использоваться для создания любой структуры данных Python через API в соответствии с определенными параметрами.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-meta-в-классах-django-и-для-чего-нужен">Что такое Meta в классах Django и для чего нужен<a href="#что-такое-meta-в-классах-django-и-для-чего-нужен" class="hash-link" aria-label="Прямая ссылка на Что такое Meta в классах Django и для чего нужен" title="Прямая ссылка на Что такое Meta в классах Django и для чего нужен">​</a></h2><p>Django во многом работает через метаклассы.</p><p>Если коротко, то метаклассы - это классы, которые конструируют другие классы. Объявляются они через атрибут класса <code>__metaclass__</code> (в джанге через слой совместимости с python 3 через модуль six до версии 2).</p><p>Поэтому когда Django конструирует ваш класс, она делает это с помощью своего метакласса. Чтобы при конструировании ей знать какие-то параметры вашего класса, ну, например модель или поля в вашем случае, она ищет в вашем классе класс с названием Meta.</p><p>Вообще вся эта магия с метаклассами очень важна в джанге и поэтому лучше саму логику становления класса не переопределять.</p><p>Если взять за пример Serializer, то можно посмотреть на код джанги:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@six</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">add_metaclass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SerializerMetaclass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Serializer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseSerializer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>SerializerMetaclass - это тот самый метакласс, который конструирует класс ModelForm.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="за-что-отвечает-meta-в-сериализаторе">За что отвечает Meta в сериализаторе<a href="#за-что-отвечает-meta-в-сериализаторе" class="hash-link" aria-label="Прямая ссылка на За что отвечает Meta в сериализаторе" title="Прямая ссылка на За что отвечает Meta в сериализаторе">​</a></h2><p>В классе Meta сериализатора можно задать модель по которой будет создан сериализатор, поля, которые будут включены (или exclude для исключения), <code>list_serializer_class</code>, например для того чтобы задать специфическую валидацию списков и тд.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-в-быстродействии-между-django-и-flask-и-почему">Какая разница в быстродействии между django и Flask (и почему)<a href="#какая-разница-в-быстродействии-между-django-и-flask-и-почему" class="hash-link" aria-label="Прямая ссылка на Какая разница в быстродействии между django и Flask (и почему)" title="Прямая ссылка на Какая разница в быстродействии между django и Flask (и почему)">​</a></h2><p>Насчет быстродействия затрудняюсь ответить, потому что это довольно каверзный вопрос, тестов лично я не проводил. Но, что касается отличий этих двух фреймворков:</p><ul><li>Flask предоставляет простоту, гибкость и аккуратность в работе, позволяя пользователю самому выбирать, как реализовать те или иные вещи.</li><li>Django предоставляет пакет «все включено»: у вас есть панель админа, интерфейсы баз данных, ORM, и структура каталогов для ваших приложений и проектов.</li></ul><p>Под каждую задачу нужно брать свой инструмент, Django хорошо подойдет для новостных сайтов, блогов и тд, благодаря тому что у него уже из коробки есть многое (в том числе админка), да и создавался он именно под такой тип сайтов. Flask же из коробки напротив, практически ничего не имеет и лучше подойдет для каких-либо микросервисов или приложений для которых стек технологий с которыми поставляется Django не подходит.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-в-django-работает-система-аутентификации">Как в django работает система аутентификации<a href="#как-в-django-работает-система-аутентификации" class="hash-link" aria-label="Прямая ссылка на Как в django работает система аутентификации" title="Прямая ссылка на Как в django работает система аутентификации">​</a></h2><p>Django поставляется с системой аутентификации пользователей. Она обеспечивает пользовательские аккаунты, группы, права и сессии на основе куки.</p><p>Система аутентификации Django отвечает за оба аспекта: аутентификацию и авторизацию. Если коротко, то аутентификация проверяет пользователя, а авторизация определяет, что аутентифицированный пользователь может делать. Далее термин “аутентификация” будет использоваться для обозначения обоих аспектов (<a href="https://docs.djangoproject.com/en/2.2/topics/auth/" target="_blank" rel="noopener noreferrer">User authentication in Django</a>).</p><p>Система аутентификации состоит из:</p><ul><li>Пользователей</li><li>Прав: Бинарные (да/нет) флаги, определяющие наличие у пользователя права выполнять определённые действия.</li><li>Групп: Общий способ назначения меток и прав на множество пользователей.</li><li>Настраиваемой системы хеширования паролей</li><li>Инструментов для форм и представлений для аутентификации пользователей или для ограничения доступа к контенту</li><li>Системы плагинов</li></ul><p>Аутентификационная система Django старается быть очень простой и не предоставляет некоторые фичи, распространённые в других системах веб аутентификации. Такие фичи реализованы в сторонних пакетах:</p><ul><li>Проверка сложности пароля</li><li>Ограничение попыток входа</li><li>Аутентификация через сторонние сервисы (OAuth, например)</li></ul><h1>Веб-разработка</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-cgi-плюсы-минусы">Что такое CGI. Плюсы, минусы<a href="#что-такое-cgi-плюсы-минусы" class="hash-link" aria-label="Прямая ссылка на Что такое CGI. Плюсы, минусы" title="Прямая ссылка на Что такое CGI. Плюсы, минусы">​</a></h2><p>Common Gateway Interface. Соглашение о том, как веб-сервер взаимодействует с программой, написанной на каком-то языке. Веб-сервер запускает программу как исполняемый файл. Параметры запроса, например, метод, путь, заголовки и т.д. передаются через переменные окружения.</p><p>Программа должна прочитать эти переменные и записать в стандартный поток вывода HTTP-ответ.</p><p>Плюсы:</p><ul><li>Протокол не накладывает условия на язык, на котором написана программа. Это     может быть и скрипт, и бинарный файл.</li><li>Протокол экстремально прост.</li><li>Программа не хранит состояние, что удобно для отладки.</li></ul><p>Минусы:</p><ul><li>Запуск процесса ОС на каждый запрос отрабатывает очень медленно.</li><li>Передача данных через <code>stdout</code> медленней юникс-сокетов.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-защитить-куки-от-воровства-и-от-подделки">Как защитить куки от воровства и от подделки<a href="#как-защитить-куки-от-воровства-и-от-подделки" class="hash-link" aria-label="Прямая ссылка на Как защитить куки от воровства и от подделки" title="Прямая ссылка на Как защитить куки от воровства и от подделки">​</a></h2><p>Зависит от того, насколько строгие критерии безопасности на сайте. Если в куках хранятся вспомогательные данные, например, индекс последнего выбранного в дропдауне элемента, правилами ниже можно пренебречь.</p><p>Для платежных систем, сайтов с приватными данными приведенные правила обязательны.</p><ul><li>Выставлять кукам флаг <code>httponly</code>. Браузер не даст прочесть и изменить такие куки на клиенте Джаваскриптом.</li><li>Использовать флаг <code>secure</code>. Куки будут переданы только по безопасному соединению.</li><li>Устанавливать короткий срок жизни куки.</li><li>Устанавливать короткий срок сессии на сервере.</li><li>Добавлять в ключ сессии заголовок <code>User-Agent</code>. Тогда если украсть куки и установить на другой машине, ключ сессии будет другим.</li><li>Аналогично пункту выше, но добавлять <code>IP</code> пользователя.</li><li>Подписывать куки секретным ключом. Добавлять поле <code>sig</code>, которое равно <code>HMAC-SHA1(cookie-body, secret_key)</code>. На сервере проверять, что подпись совпадает.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-между-аутентификацией-и-авторизацией">Какая разница между аутентификацией и авторизацией<a href="#какая-разница-между-аутентификацией-и-авторизацией" class="hash-link" aria-label="Прямая ссылка на Какая разница между аутентификацией и авторизацией" title="Прямая ссылка на Какая разница между аутентификацией и авторизацией">​</a></h2><p><strong>Идентификация</strong> (от латинского identifico — отождествлять): присвоение субъектам и объектам идентификатора и / или сравнение идентификатора с перечнем присвоенных идентификаторов. Например, представление человека по имени отчеству - это идентификация.</p><p><strong>Аутентификация</strong> (от греческого: αυθεντικός ; реальный или подлинный): проверка соответствия субъекта и того, за кого он пытается себя выдать, с помощью некой уникальной информации (отпечатки пальцев, цвет радужки, голос и тд.), в простейшем случае - с помощью имени входа и пароля.</p><p><strong>Авторизация</strong> - это проверка и определение полномочий на выполнение некоторых действий (например, чтение файла /var/mail/eltsin) в соответствии с ранее выполненной аутентификацией.</p><p>Все три процедуры взаимосвязаны:</p><ol><li>Сначала определяют имя (логин или номер) – идентификация</li><li>Затем проверяют пароль (ключ или отпечаток пальца) – аутентификация</li><li>И в конце предоставляют доступ – авторизация</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-xss-примеры-как-защитить-приложение">Что такое XSS. Примеры. Как защитить приложение<a href="#что-такое-xss-примеры-как-защитить-приложение" class="hash-link" aria-label="Прямая ссылка на Что такое XSS. Примеры. Как защитить приложение" title="Прямая ссылка на Что такое XSS. Примеры. Как защитить приложение">​</a></h2><p>XSS – межсайтовые запросы. Страница, подверженная уязвимости, вынуждает пользователя выполнить запрос к другой странице, либо запустить нежелательный js-код.</p><p>Например, пользователь отправил комментарий, в котором был код:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#22863A">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript function" style="color:#8250DF">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#C6105F">&#x27;foo&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#22863A">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Движок сайта не фильтрует текст комментария, поэтому тег <code>&lt;script&gt;</code> становится частью страницы и исполняется браузером. Каждый, кто зайдет на страницу с опасным комментарием, увидит всплывающее окно с тестом <code>foo</code>.</p><p>Другой пример. Страница поиска принимает поисковой терм <code>q</code>. В заголовке фраза “Результат поиска по запросу” + текст параметра. Если не экранировать параметр, то запрос <code>/search?q=&lt;script&gt;alert(&#x27;foo&#x27;);&lt;/script&gt;</code> приведет к аналогичному результату.</p><p>Зная, что страница выполняет js-код, хакер может подгрузить на страницу контекстную рекламу, баннеры, заставить браузей перейти на любую страницу, похитить куки.</p><p>Уязвимость устраняется экранированием небезопасных символов, чисткой (санацией) HTML-тегов.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rest--soap">REST &amp; SOAP<a href="#rest--soap" class="hash-link" aria-label="Прямая ссылка на REST &amp; SOAP" title="Прямая ссылка на REST &amp; SOAP">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-rest">Что такое REST<a href="#что-такое-rest" class="hash-link" aria-label="Прямая ссылка на Что такое REST" title="Прямая ссылка на Что такое REST">​</a></h3><ul><li><a href="https://restfulapi.net/rest-architectural-constraints/" target="_blank" rel="noopener noreferrer">REST Principles and Architectural Constraints</a></li></ul><p>REST (Representational state transfer «передача состояния представления») – соглашение о том, как выстраивать сервисы. Под REST часто имеют в виду т.н HTTP REST API. Как правило, это веб-приложение с набором урлов – конечных точек. Урлы принимают и возвращают данные в формате JSON. Тип операции задают методом HTTP-запроса, например:</p><ul><li><code>GET</code> – получить объект или список объектов</li><li><code>POST</code> – создать объект</li><li><code>PUT</code> – обновить существующий объект</li><li><code>PATCH</code> – частично обновить существующий объект</li><li><code>DELETE</code> – удалить объект</li><li><code>HEAD</code> – получить метаданные объекта</li></ul><p>REST-архитектура активно использует возможности протокола HTTP, чтобы избежать т.н. “велосипедов” – собственных решений. Например, параметры кеширования передаются стандартными заголовками <code>Cache</code>, <code>If-Modified-Since</code>, <code>ETag</code>. Авторизациция – заголовком <code>Authentication</code>.</p><p>REST это архитектурный стиль для проектирования слабо связанных HTTP приложений, что часто используется при разработке веб-сервисов. REST не диктует правил как это должно быть имплементировано на low уровне, он лишь дает высокоуровненые гайдлайны и оставляет тебе свободу для того чтобы воплотить собственную реализацию.</p><p>Для веб-служб, построенных с учётом REST (то есть не нарушающих накладываемых им ограничений), применяют термин «RESTful».</p><p>В отличие от веб-сервисов (веб-служб) на основе SOAP, не существует «официального» стандарта для RESTful веб-API. Дело в том, что REST является архитектурным стилем, в то время как SOAP является протоколом.</p><p>REST определяет 6 архитектурных ограничений, соблюдение которых позволит создать настоящий RESTful API:</p><ol><li>Единообразие интерфейса</li><li>Клиент-сервер</li><li>Отсутствие состояния</li><li>Кэширование</li><li>Слои</li><li>Код по требованию (необязательное ограничение)</li></ol><p><strong>Единообразие интерфейса</strong>
Вы должны придумать API интерфейс для ресурсов системы, доступный для пользователей системы и следовать ему во что бы то ни стало. Ресурс в системе должен иметь только один логичный URI, который должен обеспечивать способ получения связанных или дополнительных данных. Всегда лучше ассоциировать (синонимизировать) ресурс с веб страницей.</p><p>Любой ресурс не должен быть слишком большим и содержать все и вся в своем представлении. Когда это уместно, ресурс должен содержать ссылки (HATEOAS: Hypermedia as the Engine of Application State), указывающие на относительные URI для получения связанной информации.</p><p>Кроме того, представления ресурсов в системе должны следовать определенным рекомендациям, таким как соглашения об именах, форматы ссылок или формат данных (xml или / и json).</p><blockquote><p>Как только разработчик ознакомится с одним из ваших API, он сможет следовать аналогичному подходу для других API.</p></blockquote><p><strong>Клиент-сервер</strong>
По сути, это означает, что клиентское приложение и серверное приложение ДОЛЖНЫ иметь возможность развиваться по отдельности без какой-либо зависимости друг от друга. Клиент должен знать только URI ресурса и больше ничего. Сегодня это нормальная практика в веб-разработке, поэтому с вашей стороны ничего особенного не требуется. Будь проще.</p><blockquote><p>Серверы и клиенты также могут заменяться и разрабатываться независимо, если интерфейс между ними не изменяется.</p></blockquote><p><strong>Отсутствие состояния</strong>
Рой Филдинг черпал вдохновение из HTTP, и это отражается в этом ограничении. Сделайте все клиент-серверное взаимодействие без состояний. Сервер не будет хранить информацию о последних  HTTP-запросах клиента. Он будет рассматривать каждый запрос как новый. Нет сессии, нет истории.</p><p>Если клиентское приложение должно быть приложением с отслеживанием состояния для конечного пользователя, когда пользователь входит в систему один раз и после этого выполняет другие авторизованные операции, то каждый запрос от клиента должен содержать всю информацию, необходимую для обслуживания запроса, включая сведения об аутентификации и авторизации.</p><blockquote><p>Клиентский контекст не должен храниться на сервере между запросами. Клиент отвечает за управление состоянием приложения.</p></blockquote><p><strong>Кэширование</strong>
В современном мире кэширование данных и ответов имеет первостепенное значение везде, где это применимо/возможно. Кэширование повышает производительность на стороне клиента и расширяет возможности масштабирования для сервера, поскольку нагрузка уменьшается.</p><p>В REST кэширование должно применяться к ресурсам, когда это применимо, и тогда эти ресурсы ДОЛЖНЫ быть объявлены кешируемыми. Кэширование может быть реализовано на стороне сервера или клиента.</p><blockquote><p>Хорошо настроенное кэширование частично или полностью исключает некоторые взаимодействия клиент-сервер, что еще больше повышает масштабируемость и производительность.</p></blockquote><p><strong>Слои</strong>
REST позволяет вам использовать многоуровневую архитектуру системы, в которой вы развертываете API-интерфейсы на сервере A, храните данные на сервере B, a запросы аутентифицируете, например, на сервере C. Клиент обычно не может сказать, подключен ли он напрямую к конечному серверу или к посреднику.</p><p><strong>Код по требованию (необязательное ограничение)</strong>
Это опциональное ограничение. Большую часть времени вы будете отправлять статические представления ресурсов в форме XML или JSON. Но когда вам нужно, вы можете вернуть исполняемый код для поддержки части вашего приложения, например, клиенты могут вызывать ваш API для получения кода визуализации виджета интерфейса пользователя. Это разрешено</p><p>Все вышеперечисленные ограничения помогают вам создать действительно RESTful API, и вы должны следовать им. Тем не менее, иногда вы можете столкнуться с нарушением одного или двух ограничений. Не беспокойтесь, вы все еще создаете API RESTful, но не «труЪ RESTful».</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-soap">Что такое SOAP<a href="#что-такое-soap" class="hash-link" aria-label="Прямая ссылка на Что такое SOAP" title="Прямая ссылка на Что такое SOAP">​</a></h3><p>SOAP (от англ. Simple Object Access Protocol - простой протокол доступа к объектам; вплоть до спецификации 1.2) - протокол обмена структурированными сообщениями в распределённой вычислительной среде. Первоначально SOAP предназначался в основном для реализации удалённого вызова процедур (RPC). Сейчас протокол используется для обмена произвольными сообщениями в формате XML, а не только для вызова процедур. Официальная спецификация последней версии 1.2 протокола никак не расшифровывает название SOAP. SOAP является расширением протокола XML-RPC.
SOAP может использоваться с любым протоколом прикладного уровня: SMTP, FTP, HTTP, HTTPS и др. Однако его взаимодействие с каждым из этих протоколов имеет свои особенности, которые должны быть определены отдельно. Чаще всего SOAP используется поверх HTTP.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="в-чем-разница-между-rest-и-soap-веб-сервисами">В чем разница между REST и SOAP веб сервисами<a href="#в-чем-разница-между-rest-и-soap-веб-сервисами" class="hash-link" aria-label="Прямая ссылка на В чем разница между REST и SOAP веб сервисами" title="Прямая ссылка на В чем разница между REST и SOAP веб сервисами">​</a></h3><p>Некоторые отличия:</p><ul><li>REST поддерживает различные форматы: text, JSON, XML; SOAP - только XML,</li><li>REST работает только по HTTP(S), а SOAP может работать с различными протоколами,</li><li>REST может работать с ресурсами. Каждый URL это представление какого-либо ресурса. SOAP работает с операциями, которые реализуют какую-либо бизнес логику с помощью нескольких интерфейсов,</li><li>SOAP на основе чтения не может быть помещена в кэш, а REST в этом случае может быть закэширован,</li><li>SOAP поддерживает SSL и WS-security, в то время как REST - только SSL, SOAP поддерживает ACID (Atomicity, Consistency, Isolation, Durability). REST поддерживает транзакции, но не один из ACID не совместим с двух фазовым коммитом.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="можем-ли-мы-посылать-soap-сообщения-с-вложением">Можем ли мы посылать SOAP сообщения с вложением<a href="#можем-ли-мы-посылать-soap-сообщения-с-вложением" class="hash-link" aria-label="Прямая ссылка на Можем ли мы посылать SOAP сообщения с вложением" title="Прямая ссылка на Можем ли мы посылать SOAP сообщения с вложением">​</a></h3><p>Да, это возможно. Можно посылать вложением различные форматы: PDF, изображения или другие двоичные данные. Сообщения SOAP работают вместе с расширением MIME, в котором предусмотрено multipart/related</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-бы-вы-решили-какой-из-rest-или-soap-веб-сервисов-использовать">Как бы вы решили какой из REST или SOAP веб сервисов использовать<a href="#как-бы-вы-решили-какой-из-rest-или-soap-веб-сервисов-использовать" class="hash-link" aria-label="Прямая ссылка на Как бы вы решили какой из REST или SOAP веб сервисов использовать" title="Прямая ссылка на Как бы вы решили какой из REST или SOAP веб сервисов использовать">​</a></h3><p>REST против SOAP можно перефразировать как &quot;Простота против Стандарта&quot;. В случае REST (простота) у вас будет скорость, расширяемость и поддержка многих форматов. В случае с SOAP у вас будет больше возможностей по безопасности (WS-security) и транзакционная безопасность (ACID).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-способы-для-мониторинга-веб-приложений-в-production-вы-использовали-или-знаете">Какие способы для мониторинга веб-приложений в production вы использовали или знаете<a href="#какие-способы-для-мониторинга-веб-приложений-в-production-вы-использовали-или-знаете" class="hash-link" aria-label="Прямая ссылка на Какие способы для мониторинга веб-приложений в production вы использовали или знаете" title="Прямая ссылка на Какие способы для мониторинга веб-приложений в production вы использовали или знаете">​</a></h2><ul><li><a href="https://habr.com/ru/company/pc-administrator/blog/304356/" target="_blank" rel="noopener noreferrer">51 инструмент для APM и мониторинга серверов</a></li></ul><h1>HTTP</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-устроен-протокол-http">Как устроен протокол HTTP<a href="#как-устроен-протокол-http" class="hash-link" aria-label="Прямая ссылка на Как устроен протокол HTTP" title="Прямая ссылка на Как устроен протокол HTTP">​</a></h2><p>HTTP – текстовый протокол, работающий поверх TCP/IP. HTTP состоит из запроса и ответа. Их структуры похожи: стартовая строка, заголовки, тело ответа.</p><p>Стартовая строка запроса состоит из метода, пути и версии протокола:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /index.html HTTP/1.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Стартовая строка ответа состоит из версии протокола, кода ответа и текстовой расшифровке ответа.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HTTP/1.1 200 OK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Заголовки – это набор пар ключ-значение, например, <code>User-Agent</code>, <code>Content-Type</code>. В заголовках передают метаданные запроса: язык пользователя, авторизацию, перенаправление. Заголовок <code>Host</code> должен быть в запросе всегда.</p><p>Тело ответа может быть пустым, либо может передавать пары переменных, файлы, бинарные данные. Тело отделяется от заголовков пустой строкой.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="написать-raw-запрос-главной-яндекса">Написать raw запрос главной Яндекса<a href="#написать-raw-запрос-главной-яндекса" class="hash-link" aria-label="Прямая ссылка на Написать raw запрос главной Яндекса" title="Прямая ссылка на Написать raw запрос главной Яндекса">​</a></h2><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET / HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: ya.ru</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-клиенту-понять-удался-запрос-или-нет">Как клиенту понять, удался запрос или нет<a href="#как-клиенту-понять-удался-запрос-или-нет" class="hash-link" aria-label="Прямая ссылка на Как клиенту понять, удался запрос или нет" title="Прямая ссылка на Как клиенту понять, удался запрос или нет">​</a></h2><p>Проверить статус ответа. Ответы разделены старшему разряду. Имеем пять групп со следующей семантикой:</p><ul><li><code>1xx</code>: используется крайне редко. В этой группе только один статус <code>100 Continue</code>.</li><li><code>2xx</code>: запрос прошел успешно (данные получены или созданы)</li><li><code>3xx</code>: перенаправление на другой ресурс</li><li><code>4xx</code>: ошибка по вине пользователя (нет такой страницы, нет прав на доступ)</li><li><code>5xx</code>: ошибка по вине сервера (ошибка в коде, сети, конфигурации)</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-нужно-отправить-браузеру-чтобы-перенаправить-на-другую-страницу">Что нужно отправить браузеру, чтобы перенаправить на другую страницу<a href="#что-нужно-отправить-браузеру-чтобы-перенаправить-на-другую-страницу" class="hash-link" aria-label="Прямая ссылка на Что нужно отправить браузеру, чтобы перенаправить на другую страницу" title="Прямая ссылка на Что нужно отправить браузеру, чтобы перенаправить на другую страницу">​</a></h2><p>Минимальный ответ должен иметь статус <code>301</code> или <code>302</code>. Заголовок <code>Location</code> указывает адрес ресурса, на который следует перейти.</p><p>В теле ответа можно разместить <code>HTML</code> со ссылкой на новый ресурс. Тогда пользователи старых браузеров смогут перейти вручную.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-управлять-кешированием-в-http">Как управлять кешированием в HTTP<a href="#как-управлять-кешированием-в-http" class="hash-link" aria-label="Прямая ссылка на Как управлять кешированием в HTTP" title="Прямая ссылка на Как управлять кешированием в HTTP">​</a></h2><p>Существуют несколько способов кешировать данные на уровне протокола.</p><ul><li>Заголовки <code>Cache</code> и <code>Cache-Control</code> регулируют сразу несколько критериев кеша: время жизни, политику обновления, поведение прокси-сервера, тип данных (публичные, приватные).</li><li>Заголовки <code>Last-Modified</code> и <code>If-Modified-Since</code> задают кеширование в зависимости от даты обновления документа.</li><li>Заголовок <code>Etag</code> кеширует документ по его уникальному хешу.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-кэшируются-файлы-на-уровне-протокола">Как кэшируются файлы на уровне протокола<a href="#как-кэшируются-файлы-на-уровне-протокола" class="hash-link" aria-label="Прямая ссылка на Как кэшируются файлы на уровне протокола" title="Прямая ссылка на Как кэшируются файлы на уровне протокола">​</a></h2><p>Когда <code>Nginx</code> отдает статичный файл, он добавляет заголовок <code>Etag</code> – <code>MD5</code>-хеш файла. Клиент запоминает этот хеш. В следующий раз при запросе файла клиент посылает хеш. Сервер проверяет хеш клиента для этого файла. Если хеш не совпадает (файл обновили), сервер отвечает с кодом <code>200</code> и выгружает актуальный файл с новым хешем. Если хеши равны, сервер отвечает с кодом <code>304 Not Modified</code> с пустым телом. В этом случае браузер подставляет локальную копию файла.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-http">Что такое HTTP<a href="#что-такое-http" class="hash-link" aria-label="Прямая ссылка на Что такое HTTP" title="Прямая ссылка на Что такое HTTP">​</a></h2><ul><li><a href="https://habr.com/ru/post/215117/" target="_blank" rel="noopener noreferrer">Простым языком об HTTP</a></li><li><a href="https://developer.mozilla.org/ru/docs/Web/HTTP/Overview" target="_blank" rel="noopener noreferrer">Обзор протокола HTTP - HTTP</a></li></ul><p>HTTP — широко распространённый протокол передачи данных, изначально предназначенный для передачи гипертекстовых документов (то есть документов, которые могут содержать ссылки, позволяющие организовать переход к другим документам).</p><p>Аббревиатура HTTP расшифровывается как HyperText Transfer Protocol, «протокол передачи гипертекста». В соответствии со спецификацией OSI, HTTP является протоколом прикладного (верхнего, 7-го) уровня. Актуальная на данный момент версия протокола, HTTP 1.1, описана в спецификации RFC 2616.</p><p>Протокол HTTP предполагает использование клиент-серверной структуры передачи данных. Клиентское приложение формирует запрос и отправляет его на сервер, после чего серверное программное обеспечение обрабатывает данный запрос, формирует ответ и передаёт его обратно клиенту. После этого клиентское приложение может продолжить отправлять другие запросы, которые будут обработаны аналогичным образом.</p><p>Задача, которая традиционно решается с помощью протокола HTTP — обмен данными между пользовательским приложением, осуществляющим доступ к веб-ресурсам (обычно это веб-браузер) и веб-сервером. На данный момент именно благодаря протоколу HTTP обеспечивается работа Всемирной паутины.</p><p>Также HTTP часто используется как протокол передачи информации для других протоколов прикладного уровня, таких как SOAP, XML-RPC и WebDAV. В таком случае говорят, что протокол HTTP используется как «транспорт».</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="чем-отличаются-http-и-https">Чем отличаются HTTP и HTTPS<a href="#чем-отличаются-http-и-https" class="hash-link" aria-label="Прямая ссылка на Чем отличаются HTTP и HTTPS" title="Прямая ссылка на Чем отличаются HTTP и HTTPS">​</a></h2><p>HTTP — прикладной протокол передачи данный, используемый для получения информации с веб-сайтов.</p><p>HTTPS — расширение протокола HTTP, поддерживающее шифрование по протоколам SSL и TLS.</p><h1>Общее</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ооп">ООП<a href="#ооп" class="hash-link" aria-label="Прямая ссылка на ООП" title="Прямая ссылка на ООП">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="инкапсуляция">Инкапсуляция<a href="#инкапсуляция" class="hash-link" aria-label="Прямая ссылка на Инкапсуляция" title="Прямая ссылка на Инкапсуляция">​</a></h3><p><em>Инкапсуляция</em> - механизм языка, позволяющий объединить данные и методы, работающие с этими данными, в единый объект и скрыть детали реализации от пользователя.</p><p>Подлинное назначение инкапсуляции — собрать в одном месте знания, относящиеся к устройству некой сущности, правилам обращения и операциям с ней. Инкапсуляция появилась гораздо раньше, чем принято думать. Модули в программах на C — это инкапсуляция. Подпрограммы на ассемблере — это инкапсуляция. Противоположность инкапсуляции — размазывание знаний о функционировании чего-либо по всей программе.</p><p><em>Пример</em>: работа с денежными величинами. Не секрет, что во многих e-commerce системах денежные величины реализованы в виде чисел с плавающей запятой. Думаю, все из нас в курсе, что при простом сложении двух «целых» чисел, представленных в виде переменных с плавающих запятой, может образоваться «немного не целое число». Поэтому при такой реализации там и тут приходится вставлять вызов функции округления. Это и есть размазывание знаний об устройстве сущности по всей программе. Инкапсуляция в данном случае — собрать (спрятать) в одном месте знание о том, что деньги представлены в виде величины с плавающей запятой, и что её постоянно приходится округлять при самых невинных операциях. Спрятать так, чтобы при использовании сущности «деньги» речь об округлении даже не заходила. При инкапсуляции не будет никаких проблем заменить реализацию «денег» с числа с плавающей на число с фиксированной запятой.</p><p>Можно сказать, что сокрытие – это одна из задач инкапсуляции. Но само по себе сокрытие данных инкапсуляцией не является. Также сказать, что инкапсуляция – это сокрытие данных, тоже было бы неверно. Потому что её задачи выходят за рамки сокрытия.</p><p>Если мы говорим, что данный метод инкапсулирует некий алгоритм, то подразумеваем, что в данном методе происходит определённое вычисление, детали которого нам знать необязательно, но результатам которого мы можем доверять и пользоваться ими. Также мы можем сказать, что объект, в котором инкапсулированы данные, может скрывать их – то есть защищать от несанкционированного доступа. Таким образом, разграничивать понятие инкапсуляции и сокрытия данных всё-таки нужно и важно видеть грань между ними. Инкапсуляция – технология объединения собственно данных и методов их обработки. В результате и сами данные, и алгоритмы работы с ними становятся логически неотделимы. Типичный пример из C++ – поля и методы класса.</p><p>Итак, если инкапсуляция обеспечивает своего рода целостность объекта, то сокрытие - скрывает детали о процессе. Для &quot;настройки&quot; доступа к данным в классе и к классу непосредственно используются так называемые модификаторы доступа. Так вот использование этих модификаторов доступа и есть сокрытие.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="наследование">Наследование<a href="#наследование" class="hash-link" aria-label="Прямая ссылка на Наследование" title="Прямая ссылка на Наследование">​</a></h3><p><em>Наследование</em> - механизм языка, который позволяет описывать новый класс на основе существующего. В &quot;истинном&quot; ООП нужно для обеспечения реализации полиморфизма, как самостоятельная единица, не нужно и даже вредно, потому что является причиной сильного связывания. Наследованию лучше предпочитать композицию.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="полиморфизм">Полиморфизм<a href="#полиморфизм" class="hash-link" aria-label="Прямая ссылка на Полиморфизм" title="Прямая ссылка на Полиморфизм">​</a></h3><p><em>Полиморфизм</em> имеет несколько форм:</p><ul><li>Специальный (Ad-Hoc) (в некоторых языках представлен механизмом перегрузки методов)</li><li>Параметрический (в некоторых языках представлен дженериками)</li><li>Полиморфизм подтипов (достигается с помощью механизмов наследования и апкаста). Когда говорят о полиморфизме чаще всего имеют в виду его</li></ul><p><em>Полиморфизм</em> - возможность схожим типам данных, которые явно заданы иерархией наследования иметь различные реализации (с помощью переопределения методов и апкаста)</p><p>Также в языках программирования и теории типов полиморфизмом называется способность функции обрабатывать данные разных типов.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="абстракция">Абстракция<a href="#абстракция" class="hash-link" aria-label="Прямая ссылка на Абстракция" title="Прямая ссылка на Абстракция">​</a></h3><p><em>Абстракция</em> гласит что мы должны выделять важные характеристики объекта. Мысль в том, чтобы мы могли определить минимально необходимый набор этих характеристик для того чтобы можно было решить поставленную задачу.
Часто путают с инкапсуляцией, потому что и то и другое косвенно влияет на формирование публичного интерфейса типа.
Довольно тривиальная парадигма и поэтому часто не указывается как таковая.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-принципы-программирования-вы-знаете">Какие принципы программирования вы знаете<a href="#какие-принципы-программирования-вы-знаете" class="hash-link" aria-label="Прямая ссылка на Какие принципы программирования вы знаете" title="Прямая ссылка на Какие принципы программирования вы знаете">​</a></h2><ul><li><a href="https://areknawo.com/10-coding-principles-and-acronyms-demystified/" target="_blank" rel="noopener noreferrer">10 Coding principles and acronyms demystified!</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kiss">KISS<a href="#kiss" class="hash-link" aria-label="Прямая ссылка на KISS" title="Прямая ссылка на KISS">​</a></h3><p>Принцип <em>Keep It Stupid Simple</em> («Придерживайся простоты») велит вам следить за тем, чтобы код оставался как можно более простым. Чем код проще, тем легче в нем разобраться, как вам, так и другим людям, занимающимся его поддержкой. Под простотой главным образом имеется в виду отказ от использования хитроумных приемов и ненужного усложнения.</p><p>В качестве примеров нарушения этого принципа можно назвать написание отдельной функции только лишь для осуществления операции сложения или использование побитового оператора (right shift &gt;&gt; 1) для деления целых чисел на 2. Последнее, безусловно, более эффективно, чем обычное (/2), но при этом очень сильно снижается понятность кода. Применяя такой подход, вы осуществляете clever coding («заумный кодинг») и over-optimization (чрезмерную оптимизацию). И то, и другое в долгосрочной перспективе не слишком хорошо сказывается на здоровье вашего кода.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dry">DRY<a href="#dry" class="hash-link" aria-label="Прямая ссылка на DRY" title="Прямая ссылка на DRY">​</a></h3><p>Принцип <em>Don’t Repeat Yourself</em> («Не повторяйся») напоминает нам, что каждое повторяемое поведение в коде следует обособлять (например, выделять в отдельную функцию) для возможности многократного использования. Когда у вас в кодовой базе есть два совершенно одинаковых фрагмента кода, это не хорошо. Это часто приводит к рассинхронизации и прочим багам, не говоря уже о том, что от этого увеличивается размер программы.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="yagni">YAGNI<a href="#yagni" class="hash-link" aria-label="Прямая ссылка на YAGNI" title="Прямая ссылка на YAGNI">​</a></h3><p>Принцип <em>You Aren’t Gonna Need It</em> («Тебе это не понадобится») говорит о том, что нежелательно оставлять в продакшене «точки расширения» (места, предназначенные только для того, чтобы позволить вам в будущем легко добавить новый функционал). Конечно, мы не говорим о случаях, когда речь идет об уже заказанном функционале. Такие точки расширения вносят ненужную сложность и увеличивают размер вашей кодовой базы.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="slap">SLAP<a href="#slap" class="hash-link" aria-label="Прямая ссылка на SLAP" title="Прямая ссылка на SLAP">​</a></h3><p>Принцип <em>Single Level of Abstraction Principle</em> («Принцип единого уровня абстракций») означает, что функции должны иметь единый уровень абстракции. Скажем, функция, читающая input, не должна также обрабатывать полученные данные. Для этого она должна задействовать отдельную функцию, находящуюся на другом, более низком уровне абстракции. Чем более общей является функция и чем больше других функций она использует, тем выше она располагается в абстракционной иерархии.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="solid-принципы">SOLID принципы<a href="#solid-принципы" class="hash-link" aria-label="Прямая ссылка на SOLID принципы" title="Прямая ссылка на SOLID принципы">​</a></h3><p><em>SOLID</em> - это аббревиатура от 5 принципов, описанных Робертом Мартином, которые способствуют созданию хорошего объектно-ориентированного (и не только) кода.</p><p><strong>S</strong>: Single Responsibility Principle (Принцип единственной ответственности).</p><blockquote><p>Каждый класс должен решать лишь одну задачу.</p></blockquote><p><strong>O</strong>: Open-Closed Principle (Принцип открытости-закрытости).</p><blockquote><p>Программные сущности (классы, модули, функции) должны быть открыты для расширения, но не для модификации.</p></blockquote><p><strong>L</strong>: Liskov Substitution Principle (Принцип подстановки Барбары Лисков).</p><blockquote><p>Необходимо, чтобы подклассы могли бы служить заменой для своих суперклассов.</p></blockquote><p><strong>I</strong>: Interface Segregation Principle (Принцип разделения интерфейса).</p><blockquote><p>Создавайте узкоспециализированные интерфейсы, предназначенные для конкретного клиента. Клиенты не должны зависеть от интерфейсов, которые они не используют.</p></blockquote><p><strong>D</strong>: Dependency Inversion Principle (Принцип инверсии зависимостей).</p><blockquote><p>Объектом зависимости должна быть абстракция, а не что-то конкретное.</p></blockquote><ul><li>Модули верхних уровней не должны зависеть от модулей нижних уровней. Оба типа модулей должны зависеть от абстракций.</li><li>Абстракции не должны зависеть от деталей. Детали должны зависеть от абстракций.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-code-cohesion--code-coupling">Что такое code cohesion &amp; code coupling<a href="#что-такое-code-cohesion--code-coupling" class="hash-link" aria-label="Прямая ссылка на Что такое code cohesion &amp; code coupling" title="Прямая ссылка на Что такое code cohesion &amp; code coupling">​</a></h2><p><strong>Связанность модулей (coupling)</strong>, часто называемую <strong>зацеплением</strong>, характеризует степень независимости модулей. При проектировании систем необходимо стремиться, чтобы модули имели минимальную зависимость друг от друга, т.е. были минимально «сцеплены» между собой (отсюда и термин «сцепление» или связанность). Это требование вытекает из одного из основных принципов системного подхода, требующего минимизации информационных потоков между подсистемами.</p><p><strong>Связность (cohesion)</strong> характеризует целостность, «плотность» модуля, т.е. насколько модуль является простым с точки зрения его использования. В идеале модуль должен выполнять одну единственную функцию и иметь минимальное число «ручек управления». Примером модуля имеющего максимальную связность является модуль проверки орфографии, вычисления заработной платы сотрудника, вычисления логарифма функции. Если связанность является характеристикой системы, то связность характеризует отдельно взятый модуль.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-шаблоны-проектирования-вы-знаете">Какие шаблоны проектирования вы знаете<a href="#какие-шаблоны-проектирования-вы-знаете" class="hash-link" aria-label="Прямая ссылка на Какие шаблоны проектирования вы знаете" title="Прямая ссылка на Какие шаблоны проектирования вы знаете">​</a></h2><ul><li>&quot;Марк Саммерфилд - Python на практике&quot;</li><li><a href="https://github.com/pkolt/design_patterns" target="_blank" rel="noopener noreferrer">GitHub - pkolt/design_patterns: Паттерны проектирования</a></li><li><a href="https://github.com/faif/python-patterns" target="_blank" rel="noopener noreferrer">GitHub - faif/python-patterns: A collection of design patterns/idioms in Python</a></li><li><a href="https://python-patterns.guide/" target="_blank" rel="noopener noreferrer">Python Design Patterns</a></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="порождающие-creational">Порождающие (Creational)<a href="#порождающие-creational" class="hash-link" aria-label="Прямая ссылка на Порождающие (Creational)" title="Прямая ссылка на Порождающие (Creational)">​</a></h3><p>Порождающие паттерны проектирования описывают, как создавать объекты. Обычно объект создается путем вызова констуктора, но иногда требуется большая гибкость именно для этого порождающие паттерны и полезны.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="абстрактная-фабрика-abstract-factory">Абстрактная фабрика (Abstract factory)<a href="#абстрактная-фабрика-abstract-factory" class="hash-link" aria-label="Прямая ссылка на Абстрактная фабрика (Abstract factory)" title="Прямая ссылка на Абстрактная фабрика (Abstract factory)">​</a></h4><p>Предназначен для случаев, когда требуется создать сложный объект, состоящий из других объектов, причем все составляющие объекты принадлежат одному &quot;семейству&quot;. Предоставляет интерфейс для создания семейств взаимосвязанных или взаимозависимых объектов, не специфицируя их конкретных классов.</p><p>Например, в системе с GUI может быть абстрактная фабрика виджетов, которой наследуют три конкретных фабрики: MacWidgetFactory, XfceWidgetFactory, WindowsWidgetFactory, каждая из которых предоставляет методы для создания одних и тех же объектов (make_button(), make_spinbox() и т.д), стилизованных, однако, как принято на конкретной платформе. Это дает возможность создать обобщенную функцию create_dialog(), которая принимает экземпляр фабрики в качестве аргумента и создает диалоговое окно, выглядещее как в OS X, Xfce или Windows - в зависимости от того какую фабрику мы передали.</p><p>Классы абстрактной фабрики часто реализуются фабричными методами, но могут быть реализованы и с помощью паттерна прототип.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In Java and other languages, the Abstract Factory Pattern serves to provide an interface for</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">creating related/dependent objects without need to specify their</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">actual class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The idea is to abstract the creation of objects depending on business</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">logic, platform choice, etc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In Python, the interface we use is simply a callable, which is &quot;builtin&quot; interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">in Python, and in normal circumstances we can simply use the class itself as</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">that callable, because classes are first class objects in Python.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This particular implementation abstracts the creation of a pet and</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">does so depending on the factory we chose (Dog or Cat, or random_animal)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This works because both Dog/Cat and random_animal respect a common</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">interface (callable for creation and .speak()).</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Now my application can create pets abstractly and decide later,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">based on my own criteria, dogs over cats.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://sourcemaking.com/design_patterns/abstract_factory</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://ginstrom.com/scribbles/2007/10/08/design-patterns-python-style/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Provides a way to encapsulate a group of individual factories.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PetShop</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;A pet shop&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> animal_factory</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;pet_factory is our abstract factory.  We can set it at will.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pet_factory </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> animal_factory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">show_pet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Creates and shows a pet using the abstract factory&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pet </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pet_factory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;We have a lovely {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;It says {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">speak</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Dog</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">speak</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;woof&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Dog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Cat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">speak</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;meow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Cat&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Additional factories:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Create a random animal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">random_animal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Let&#x27;s be dynamic!&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">choice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Dog</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Cat</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Show pets with various factories</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># A Shop that sells only cats</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cat_shop </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> PetShop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Cat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cat_shop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show_pet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># A shop that sells random animals</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shop </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> PetShop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">random_animal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show_pet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># OUTPUT #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># We have a lovely Cat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># It says meow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># We have a lovely Dog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># It says woof</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ====================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># We have a lovely Cat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># It says meow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ====================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># We have a lovely Cat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># It says meow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ====================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="построитель-builder">Построитель (Builder)<a href="#построитель-builder" class="hash-link" aria-label="Прямая ссылка на Построитель (Builder)" title="Прямая ссылка на Построитель (Builder)">​</a></h4><p>Построитель аналогичен паттерну Абстрактная фабрика в том смысле, что оба предназначены для создания сложных объектов, составленных из других объектов. Но отличается тем, что не только предоставляет методы для построения сложного объекта, но и хранит внутри себя его полное представление.</p><p>Этот паттерн допускает такую же композиционную структуру как и Абстрактная фабрика (то есть сложные объекты, составленные из нескольких более простых) но особенно удобен в ситуациях, когда представление составного объета должно быть отделено от алгоритмов композиции</p><p>Отделяет конструирование сложного объекта от его представления, так что в результате одного и того же процесса конструирования могут получаться разные представления. От абстрактной фабрики отличается тем, что делает акцент на пошаговом конструировании объекта. Строитель возвращает объект на последнем шаге, тогда как абстрактная фабрика возвращает объект немедленно. Строитель часто используется для создания паттерна компоновщик.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">It decouples the creation of a complex object and its representation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">so that the same process can be reused to build objects from the same</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">family.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This is useful when you must separate the specification of an object</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">from its actual representation (generally for abstraction).</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The first example achieves this by using an abstract base</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">class for a building, where the initializer (__init__ method) specifies the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">steps needed, and the concrete subclasses implement these steps.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In other programming languages, a more complex arrangement is sometimes</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">necessary. In particular, you cannot have polymorphic behaviour in a constructor in C++ -</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">see https://stackoverflow.com/questions/1453131/how-can-i-get-polymorphic-behavior-in-a-c-constructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">- which means this Python technique will not work. The polymorphism</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">required has to be provided by an external, already constructed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">instance of a different class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In general, in Python this won&#x27;t be necessary, but a second example showing</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">this kind of arrangement is also included.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://sourcemaking.com/design_patterns/builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Decouples the creation of a complex object and its representation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Abstract Building</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Building</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Floor: {0.floor} | Size: {0.size}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Concrete Buildings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">House</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Building</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">floor </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;One&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Big&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Flat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Building</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">floor </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;More than One&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Small&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># In some very complex cases, it might be desirable to pull out the building</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># logic into another function (or a method on another class), rather than being</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># in the base class &#x27;__init__&#x27;. (This leaves you in the strange situation where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># a concrete class does not have a useful constructor)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ComplexBuilding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Floor: {0.floor} | Size: {0.size}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ComplexHouse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ComplexBuilding</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">floor </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;One&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Big and fancy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">construct_building</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    building </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    building</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build_floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    building</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> building</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; house = House()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; house</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Floor: One | Size: Big</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; flat = Flat()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; flat</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Floor: More than One | Size: Small</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Using an external constructor function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; complex_house = construct_building(ComplexHouse)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; complex_house</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Floor: One | Size: Big and fancy</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="фабричный-метод-factory-method">Фабричный метод (Factory method)<a href="#фабричный-метод-factory-method" class="hash-link" aria-label="Прямая ссылка на Фабричный метод (Factory method)" title="Прямая ссылка на Фабричный метод (Factory method)">​</a></h4><p>Паттерн Фабричный метод применяется, когда мы хотим, чтобы подклассы выбирали, какой класс инстанциировать, когда запрашивается объект. Это полезно само по себе, но можно пойти дальше и использовать в случае, когда класс заранее неизвестен (например, зависит от информации, прочитанной из файла или введенных пользователем данных).</p><p>Абстрактная фабрика часто реализуется с помощью фабричных методов.
Фабричные методы часто вызываются внутри шаблонных методов.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">A Factory is an object for creating other objects.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The code shows a way to localize words in two languages: English and</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Greek. &quot;get_localizer&quot; is the factory function that constructs a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">localizer depending on the language chosen. The localizer object will</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">be an instance from a different class according to the language</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">localized. However, the main code does not have to worry about which</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">localizer will be instantiated, since the method &quot;localize&quot; will be called</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">in the same way independently of the language.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where can the pattern be used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Factory Method can be seen in the popular web framework Django:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://django.wikispaces.asu.edu/*NEW*+Django+Design+Patterns For</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">example, in a contact form of a web page, the subject and the message</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">fields are created using the same form factory (CharField()), even</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">though they have different implementations according to their</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">purposes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://ginstrom.com/scribbles/2007/10/08/design-patterns-python-style/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Creates objects without having to specify the exact class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">GreekLocalizer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;A simple localizer a la gettext&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">translations </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#C6105F">&quot;dog&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;σκύλος&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;cat&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;γάτα&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">localize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;We&#x27;ll punt if we don&#x27;t have a translation&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">translations</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">EnglishLocalizer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Simply echoes the message&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">localize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> msg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_localizer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">language</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&quot;English&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Factory&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    localizers </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#C6105F">&quot;English&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> EnglishLocalizer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#C6105F">&quot;Greek&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> GreekLocalizer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> localizers</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">language</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Create our localizers</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; e, g = get_localizer(language=&quot;English&quot;), get_localizer(language=&quot;Greek&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Localize some text</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for msg in &quot;dog parrot cat bear&quot;.split():</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     print(e.localize(msg), g.localize(msg))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    dog σκύλος</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    parrot parrot</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    cat γάτα</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    bear bear</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="прототип-prototype">Прототип (Prototype)<a href="#прототип-prototype" class="hash-link" aria-label="Прямая ссылка на Прототип (Prototype)" title="Прямая ссылка на Прототип (Prototype)">​</a></h4><p>Паттерн Прототип применяется для создания нового объекта путем клонирования исходного с последующей модификацией клона.</p><p>Способы создания нового объекта в Python:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Point</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __slots__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;x&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;y&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># При таком классическом определении класса Point создать новую точку можно семью способами</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">make_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point1 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Point</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">eval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;{}({}, {})&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Point&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Опасно</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point3 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modules</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Point&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point4 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">globals</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&#x27;Point&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point5 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> make_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Point</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point6 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> copy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deepcopy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point6</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point6</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point7 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> point1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">14</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>При создании point6 используется классический подход на основе прототипа: сначала мы клонируем существующий объект, а затем  инициализируем и конфигурируем его. Для создания point7 мы берем объект класса точки point1 и передаем ему другие аргументы.</p><p>На примере point6 мы видим, чтов  Python уже встроена поддержка прототипов в виде функции copy.deepcopy(). Однако пример point7 показывает, что в Python есть средства и поулчше: вместо того чтобы клонировать существующий объект и модифицировать клон, Python предоставляет доступ к объекту класса имеющегося объекта и таким образом мы можем создать новый объект непосредственно, что гораздо эффективнее клонирования.</p><p>Прототип - паттерн, порождающий объекты. Задает виды создаваемых объектов с помощью экземпляра-прототипа и создает новые объекты путем копирования этого прототипа.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This patterns aims to reduce the number of classes required by an</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">application. Instead of relying on subclasses it creates objects by</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">copying a prototypical instance at run-time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This is useful as it makes it easier to derive new kinds of objects,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">when instances of the class have only a few different combinations of</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">state, and when instantiation is expensive.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">When the number of prototypes in an application can vary, it can be</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">useful to keep a Dispatcher (aka, Registry or Manager). This allows</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">clients to query the Dispatcher for a prototype before cloning a new</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">instance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Below provides an example of such Dispatcher, which contains three</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">copies of the prototype: &#x27;default&#x27;, &#x27;objecta&#x27; and &#x27;objectb&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Creates new object instances by cloning prototype.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Prototype</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;default&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">attrs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Clone a prototype and update inner attributes dictionary&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Python in Practice, Mark Summerfield</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        obj </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">attrs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PrototypeDispatcher</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_objects </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_objects</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Get all objects&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">register_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Register an object&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_objects</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">unregister_object</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Unregister an object&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">del</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_objects</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; dispatcher = PrototypeDispatcher()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; prototype = Prototype()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; d = prototype.clone()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; a = prototype.clone(value=&#x27;a-value&#x27;, category=&#x27;a&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; b = prototype.clone(value=&#x27;b-value&#x27;, is_checked=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; dispatcher.register_object(&#x27;objecta&#x27;, a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; dispatcher.register_object(&#x27;objectb&#x27;, b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; dispatcher.register_object(&#x27;default&#x27;, d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; [{n: p.value} for n, p in dispatcher.get_objects().items()]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [{&#x27;objecta&#x27;: &#x27;a-value&#x27;}, {&#x27;objectb&#x27;: &#x27;b-value&#x27;}, {&#x27;default&#x27;: &#x27;default&#x27;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="одиночка-singleton">Одиночка (Singleton)<a href="#одиночка-singleton" class="hash-link" aria-label="Прямая ссылка на Одиночка (Singleton)" title="Прямая ссылка на Одиночка (Singleton)">​</a></h4><p>Паттерн Одиночка (Синглтон) применяется, когда необходим класс, у которого должен быть единственный экземпляр во всей программе.</p><p>С помощью паттерна одиночка могут быть реализованы многие паттерны (абстрактная фабрика, строитель, прототип).</p><p>В сборнике рецептов приводится простой класс Singleton, которому любой класс может унаследовать, чтобы стать одиночкой.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Yet one singleton realization on Python without metaclass. Singleton may has __init__ method which will call only when first object create.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://code.activestate.com/recipes/577208-singletonsubclass-with-once-initialization/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Singleton</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">mp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token builtin">hasattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#C6105F">&#x27;_inst&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_inst </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Singleton</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">mp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">init_pass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">mp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> init_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_inst</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Singleton</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Super constructor</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">                There is we can open file or create connection to the database</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">            &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;A init&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a1 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>И класс Borg, который даст тот же результат совсем другим способом.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Borg pattern (also known as the Monostate pattern) is a way to</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">implement singleton behavior, but instead of having only one instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">of a class, there are multiple instances that share the same state. In</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">other words, the focus is on sharing state instead of sharing instance</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">identity.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">To understand the implementation of this pattern in Python, it is</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">important to know that, in Python, instance attributes are stored in a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">attribute dictionary called __dict__. Usually, each instance will have</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">its own dictionary, but the Borg pattern modifies this so that all</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">instances have the same dictionary.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In this example, the __shared_state attribute will be the dictionary</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">shared between all instances, and this is ensured by assigining</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">__shared_state to the __dict__ variable when initializing a new</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">instance (i.e., in the __init__ method). Other attributes are usually</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">added to the instance&#x27;s attribute dictionary, but, since the attribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">dictionary itself is shared (which is __shared_state), all other</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">attributes will also be shared.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Sharing state is useful in applications like managing database connections:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://github.com/onetwopunch/pythonDbTemplate/blob/master/database.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://fkromer.github.io/python-pattern-references/design/#singleton</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Provides singleton-like behavior sharing state between instances.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Borg</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __shared_state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__ </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__shared_state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Init&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">YourBorg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Borg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm1 = Borg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm2 = Borg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm1.state = &#x27;Idle&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm2.state = &#x27;Running&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm1: {0}&#x27;.format(rm1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm1: Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm2: {0}&#x27;.format(rm2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm2: Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # When the `state` attribute is modified from instance `rm2`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # the value of `state` in instance `rm1` also changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm2.state = &#x27;Zombie&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm1: {0}&#x27;.format(rm1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm1: Zombie</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm2: {0}&#x27;.format(rm2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm2: Zombie</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Even though `rm1` and `rm2` share attributes, the instances are not the same</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm1 is rm2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    False</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Shared state is also modified from a subclass instance `rm3`</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; rm3 = YourBorg()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm1: {0}&#x27;.format(rm1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm1: Init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm2: {0}&#x27;.format(rm2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm2: Init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;rm3: {0}&#x27;.format(rm3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    rm3: Init</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Однако самый простой способ получить функциональность одиночки в Python - создать модуль с глобальным состоянием, которое хранится в закрытых переменных, и предоставить открытые функции для доступа к нему. Например, для получения курсов валют нам понадобится функция, которая будет возвращать словарь (ключ - название валюты, значение - обменный курс). Возможно, эту функцию понадобится вызывать несколько раз, но в большинстве случев извлекать откуда-то курсы нужно единожды. Реализовать это поможет паттерн Одиночка.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Copyright © 2012-13 Qtrac Ltd. All rights reserved.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This program or module is free software: you can redistribute it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># and/or modify it under the terms of the GNU General Public License as</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># published by the Free Software Foundation, either version 3 of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># License, or (at your option) any later version. It is provided for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># educational purposes and is distributed in the hope that it will be</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># useful, but WITHOUT ANY WARRANTY; without even the implied warranty of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># General Public License for more details.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_URL </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;http://www.bankofcanada.ca/stats/assets/csv/fx-seven-day.csv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">refresh</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> refresh</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">with</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">urlopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_URL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">as</span><span class="token plain"> </span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> line </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token builtin">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            line </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rstrip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;utf-8&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> line </span><span class="token keyword" style="color:#CF222E">or</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;#&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Date&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> currency</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">rest </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">r&quot;/s*,/s*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            key </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;{} ({})&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> currency</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rest</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">except</span><span class="token plain"> ValueError </span><span class="token keyword" style="color:#CF222E">as</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;error {}: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> line</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rates </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stdout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isatty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Loaded OK&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Здесь мы создаем словарь rates в виде атрибута функции Rates.get() - это наше закрытое значение. Когда открытая функция get() вызывается в первый раз (а также при вызове с параметром refresh=True), мы загружаем список курсов; в противном случае просто возвращаем последние загруженные курсы.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="порождающие-паттерны-итог">Порождающие паттерны. Итог<a href="#порождающие-паттерны-итог" class="hash-link" aria-label="Прямая ссылка на Порождающие паттерны. Итог" title="Прямая ссылка на Порождающие паттерны. Итог">​</a></h4><p>Все порождающие паттерны проектирования реализуются на Python тривиально. Паттерн Одиночка можно реализовать непосредственно с помощью модуля, а паттерн Прототип вообще ни к чему (хотя его можно реализовать с помощью модуля copy), так как Python дает динамический доступ к объектам классов. Из порождающих паттернов наиболее полезны Фабрика и Построитель, и реализовать их можно несколькими способами.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="структурные-structural">Структурные (Structural)<a href="#структурные-structural" class="hash-link" aria-label="Прямая ссылка на Структурные (Structural)" title="Прямая ссылка на Структурные (Structural)">​</a></h3><p>Структурные паттерны описывают, как из одних объектов составляются другие, более крупные. Рассматриваются три основных круга вопросов: адаптация интерфейсов, добавление функциональности и работа с коллекциями объектов.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="адаптер-adapter">Адаптер (Adapter)<a href="#адаптер-adapter" class="hash-link" aria-label="Прямая ссылка на Адаптер (Adapter)" title="Прямая ссылка на Адаптер (Adapter)">​</a></h4><p>Паттерн Адаптер описывает технику адаптации интерфейса. Задача состоит в том, чтобы один класс мог воспользоваться другим - с несовместимым интерфейсом - без внесения каких-либо изменений в оба класса. Это полезно, например, когда требуется воспользоваться не подлежащим изменению классом в контексте, на который он не был расчитан.</p><p>Адаптер обеспечивает совместную работу классов с несовместимыми интерфейсами, которая без него была бы невозможна.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Adapter pattern provides a different interface for a class. We can</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">think about it as a cable adapter that allows you to charge a phone</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">somewhere that has outlets in a different shape. Following this idea,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">the Adapter pattern is useful to integrate classes that couldn&#x27;t be</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">integrated due to their incompatible interfaces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The example has classes that represent entities (Dog, Cat, Human, Car)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">that make different noises. The Adapter class provides a different</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">interface to the original methods that make such noises. So the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">original interfaces (e.g., bark and meow) are available under a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">different name: make_noise.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Grok framework uses adapters to make objects work with a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">particular API without modifying the objects themselves:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://grok.zope.org/doc/current/grok_overview.html#adapters</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://ginstrom.com/scribbles/2008/11/06/generic-adapter-class-in-python/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://sourcemaking.com/design_patterns/adapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://python-3-patterns-idioms-test.readthedocs.io/en/latest/ChangeInterface.html#adapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Allows the interface of an existing class to be used as another interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Dog</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Dog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">bark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;woof!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Cat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Cat&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">meow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;meow!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Human</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Human&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">speak</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&#x27;hello&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Car</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Car&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">make_noise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> octane_level</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;vroom{0}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> octane_level</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Adapter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Adapts an object by replacing methods.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Usage:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    dog = Dog()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    dog = Adapter(dog, make_noise=dog.bark)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">adapted_methods</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;We set the adapted methods in the object&#x27;s dict&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">obj </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">adapted_methods</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__getattr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> attr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;All non-adapted calls are passed to the object&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> attr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">original_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Print original object dict&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; dog = Dog()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(dog.__dict__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    {&#x27;name&#x27;: &#x27;Dog&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects.append(Adapter(dog, make_noise=dog.bark))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects[0].__dict__[&#x27;obj&#x27;], objects[0].__dict__[&#x27;make_noise&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    (&lt;...Dog object at 0x...&gt;, &lt;bound method Dog.bark of &lt;...Dog object at 0x...&gt;&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(objects[0].original_dict())</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    {&#x27;name&#x27;: &#x27;Dog&#x27;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; cat = Cat()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects.append(Adapter(cat, make_noise=cat.meow))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; human = Human()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects.append(Adapter(human, make_noise=human.speak))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; car = Car()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; objects.append(Adapter(car, make_noise=lambda: car.make_noise(3)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for obj in objects:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    print(&quot;A {0} goes {1}&quot;.format(obj.name, obj.make_noise()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    A Dog goes woof!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    A Cat goes meow!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    A Human goes &#x27;hello&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    A Car goes vroom!!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optionflags</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ELLIPSIS</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="мост-bridge">Мост (Bridge)<a href="#мост-bridge" class="hash-link" aria-label="Прямая ссылка на Мост (Bridge)" title="Прямая ссылка на Мост (Bridge)">​</a></h4><p>Мост (Bridge) - паттерн, структурирующий объекты. Основная задача - отделить абстракцию от её реализации так, чтобы то и другое можно было изменять независимо.</p><p>Традиционный подход без использования паттерна Мост состоит в том, чтобы создать один или несколько абстрактных базовых классов, а затем предоставить две или более конкретных реализации каждого базового класса.
А паттерн Мост предлагает создать две независимых иерархии классов: &quot;абстрактную&quot;, которая определяет операции (например интерфейс или алгоритм верхнего уровня) и конкретную, предоставляющую реализацию, которые в конечном итоге и будут вызваны из абстрактных операций. &quot;Абстрактный&quot; класс агрегирует экземпляр одного из конкретных классов с реализацией - и этот последний служит <em>мостом</em> между абстрактным интерфейсом и конкретными операциями.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://en.wikibooks.org/wiki/Computer_Science_Design_Patterns/Bridge_Pattern#Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Decouples an abstraction from its implementation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ConcreteImplementor 1/2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DrawingAPI1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw_circle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;API1.circle at {}:{} radius {}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ConcreteImplementor 2/2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DrawingAPI2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw_circle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;API2.circle at {}:{} radius {}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Refined Abstraction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CircleShape</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> drawing_api</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_y </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_radius </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> radius</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_drawing_api </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> drawing_api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># low-level i.e. Implementation specific</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_drawing_api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw_circle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># high-level i.e. Abstraction specific</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">scale</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_radius </span><span class="token operator" style="color:#D73A49">*=</span><span class="token plain"> pct</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; shapes = (CircleShape(1, 2, 3, DrawingAPI1()), CircleShape(5, 7, 11, DrawingAPI2()))</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for shape in shapes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    shape.scale(2.5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    shape.draw()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    API1.circle at 1:2 radius 7.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    API2.circle at 5:7 radius 27.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="компоновщик-composite">Компоновщик (Composite)<a href="#компоновщик-composite" class="hash-link" aria-label="Прямая ссылка на Компоновщик (Composite)" title="Прямая ссылка на Компоновщик (Composite)">​</a></h4><p>Паттерн Компоновщик позволяет единообразно обрабатывать объекты, образующие иерархию, вне зависимости от того, содержат они другие объекты или нет. Такие объекты называют составными.</p><p>В классическом решении составные объекты - как отдельные, так и коллекции - имеют один и тот же базовый класс. У составных и несоставных объектов обычно одни и те же основные методы, но составные объекты добавляют методы для поддержки добавления, удаления и перебора дочерних объектов.</p><p>Этот паттерн часто применяется в программах рисования, например Inkscape, для поддержки группировки и разгруппировки. Его полезность в таких ситуациях объясняется тем, что подлежащие группировке или разгруппировке компоненты могут быть как одиночными (например прямоугольник) так и состаными (например, рожица, составленная из нескольких разных фигур)</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The composite pattern describes a group of objects that is treated the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">same way as a single instance of the same type of object. The intent of</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">a composite is to &quot;compose&quot; objects into tree structures to represent</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">part-whole hierarchies. Implementing the composite pattern lets clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">treat individual objects and compositions uniformly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The example implements a graphic class，which can be either an ellipse</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">or a composition of several graphics. Every graphic can be printed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">In graphics editors a shape can be basic or complex. An example of a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">simple shape is a line, where a complex shape is a rectangle which is</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">made of four line objects. Since shapes have many operations in common</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">such as rendering the shape to screen, and since shapes follow a</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">part-whole hierarchy, composite pattern can be used to enable the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">program to deal with all shapes uniformly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://en.wikipedia.org/wiki/Composite_pattern</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://infinitescript.com/2014/10/the-23-gang-of-three-design-patterns/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Describes a group of objects that is treated as a single instance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Graphic</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;You should implement this.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CompositeGraphic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graphics </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> graphic </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graphics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            graphic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graphics</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">graphics</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Ellipse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Graphic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Ellipse: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ellipse1 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Ellipse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ellipse2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Ellipse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ellipse3 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Ellipse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ellipse4 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Ellipse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;4&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic1 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> CompositeGraphic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic2 </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> CompositeGraphic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ellipse1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ellipse2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ellipse3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ellipse4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> CompositeGraphic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">graphic1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">graphic2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    graphic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># OUTPUT #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Ellipse: 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Ellipse: 2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Ellipse: 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Ellipse: 4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="декоратор-decorator">Декоратор (Decorator)<a href="#декоратор-decorator" class="hash-link" aria-label="Прямая ссылка на Декоратор (Decorator)" title="Прямая ссылка на Декоратор (Decorator)">​</a></h4><p>Декоратором называется функция, которая принимает функцию с таким же именем, как у исходной, но с расширенной функциональностью. Декораторы часто используются во фреймвоках, чтобы упростить интеграцию пользовательских функций с фреймворком.</p><p>Паттерн Декоратор настолько полезен, что в Python встроена специальная поддержка для него. В Python декорировать можно как функции, так и методы. Кроме того, Python поддерживает декораторы классов: функции, которые принимают клас в качестве аргумента и возвращают новый класс с таким же именем, как у исходного, но дополненной функциональностью.</p><p>Иногда декораторы классов удобно использовать как альтернативу производным классам.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Decorator pattern is used to dynamically add a new feature to an</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">object without changing its implementation. It differs from</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">inheritance because the new feature is added only to that particular</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">object, not to the entire subclass.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This example shows a way to add formatting options (boldface and</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">italic) to a text by appending the corresponding tags (&lt;b&gt; and</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&lt;i&gt;). Also, we can see that decorators can be applied one after the other,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">since the original text is passed to the bold wrapper, which in turn</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">is passed to the italic wrapper.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Grok framework uses decorators to add functionalities to methods,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">like permissions or subscription to an event:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://grok.zope.org/doc/current/reference/decorators.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://sourcemaking.com/design_patterns/decorator</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Adds behaviour to object without affecting its class.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">TextTag</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Represents a base text tag&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">BoldWrapper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TextTag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Wraps a tag in &lt;b&gt;&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wrapped</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_wrapped </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> wrapped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&lt;b&gt;{}&lt;/b&gt;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_wrapped</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ItalicWrapper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TextTag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Wraps a tag in &lt;i&gt;&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wrapped</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_wrapped </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> wrapped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&lt;i&gt;{}&lt;/i&gt;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_wrapped</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    simple_hello </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> TextTag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;hello, world!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    special_hello </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ItalicWrapper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BoldWrapper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">simple_hello</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;before:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> simple_hello</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;after:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> special_hello</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># OUTPUT #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># before: hello, world!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># after: &lt;i&gt;&lt;b&gt;hello, world!&lt;/b&gt;&lt;/i&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="фасад-facade">Фасад (Facade)<a href="#фасад-facade" class="hash-link" aria-label="Прямая ссылка на Фасад (Facade)" title="Прямая ссылка на Фасад (Facade)">​</a></h4><p>Паттерн Фасад служит для того, чтобы предоставить упрощенный унифицированный интерфейс к подсистеме, чей истинный интерфейс слишком сложен или написан на таком низком уровне, что работать с ним неудобно. Фасад определяет интерфейс более высокого уровня, который упрощает использование подсистемы.</p><p>В стандартной библиотеке Python имеется несколько модулей для работы с сжатыми файлами - gzip, tar+gzip, zip. Все они имеют разные интерфейсы. Если мы хотим иметь один унифицированный интерфейс для работы с архивами, мы можем воспользоваться паттерном Фасад.</p><p>Паттерны Фасад и Адаптер на первый взгляд кажутся похожими. Разница в том, что Фасад надстраивает простой интерфейс поверх сложного, а Адаптер надстраивает унифицированный интерфейс над каким-то другим (необязательно сложным). Оба эти паттерна можно использовать совместно. Например определить интерфейс для работы с архивными файлами, написать адапрет для каждого формата и надстроить поверх них фасад, чтобы пользователям не нужно было беспокоиться о том, какой конкретно формат файла используется.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Example from https://en.wikipedia.org/wiki/Facade_pattern#Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Facade pattern is a way to provide a simpler unified interface to</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">a more complex system. It provides an easier way to access functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">of the underlying system by providing a single entry point.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This kind of abstraction is seen in many real life situations. For</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">example, we can turn on a computer by just pressing a button, but in</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">fact there are many procedures and operations done when that happens</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">(e.g., loading programs from disk to memory). In this case, the button</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">serves as an unified interface to all the underlying procedures to</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">turn on a computer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Where is the pattern used practically?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This pattern can be seen in the Python standard library when we use</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">the isdir function. Although a user simply uses this function to know</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">whether a path refers to a directory, the system makes a few</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">operations and calls other modules (e.g., os.stat) to give the result.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://sourcemaking.com/design_patterns/facade</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://fkromer.github.io/python-pattern-references/design/#facade</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://python-3-patterns-idioms-test.readthedocs.io/en/latest/ChangeInterface.html#facade</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Provides a simpler unified interface to a complex system.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Complex computer parts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">CPU</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Simple CPU representation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">freeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Freezing processor.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">jump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> position</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Jumping to:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> position</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Executing.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Simple memory representation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> position</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Loading from {0} data: &#x27;{1}&#x27;.&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">SolidStateDrive</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Simple solid state drive representation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lba</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Some data from sector {0} with size {1}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lba</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ComputerFacade</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Represents a facade for various computer parts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpu </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> CPU</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">memory </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ssd </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> SolidStateDrive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">freeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">memory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;0x00&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ssd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;100&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;1024&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jump</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;0x00&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; computer_facade = ComputerFacade()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; computer_facade.start()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Freezing processor.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Loading from 0x00 data: &#x27;Some data from sector 100 with size 1024&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Jumping to: 0x00</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Executing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optionflags</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ELLIPSIS</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="приспособленец-flyweight">Приспособленец (Flyweight)<a href="#приспособленец-flyweight" class="hash-link" aria-label="Прямая ссылка на Приспособленец (Flyweight)" title="Прямая ссылка на Приспособленец (Flyweight)">​</a></h4><p>Приспособленец предназначен для обработки большого числа сравнительно небольших объектов, когда многие из этих объектов являются дубликатами. Реализация паттерна предполагает, что каждый уникальный объект представлется всего один раз и именно этот экземпляр отдается на запрос. В Python легко реализуется через словарь.</p><p>В Python подход к реализации приспособленцев естественный - благодаря наличию ссылок на объекты. Например, если бы у нас был длинный список строк, в котором много дубликатов, то, сохраняя ссылки на объекты (то есть переменные), а не литеральные строки, мы бы могли существенно сэкономить память</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">red</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> blue </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;red&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;green&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;blue&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">red</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> blue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> red</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> green</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> blue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> green</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This pattern aims to minimise the number of objects that are needed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">a program at run-time. A Flyweight is an object shared by multiple</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">contexts, and is indistinguishable from an object that is not shared.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The state of a Flyweight should not be affected by it&#x27;s context, this</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">is known as its intrinsic state. The decoupling of the objects state</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">from the object&#x27;s context, allows the Flyweight to be shared.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What does this example do?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The example below sets-up an &#x27;object pool&#x27; which stores initialised</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">objects. When a &#x27;Card&#x27; is created it first checks to see if it already</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">exists instead of creating a new one. This aims to reduce the number of</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">objects initialised by the program.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*References:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://codesnipers.com/?q=python-flyweights</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://python-patterns.guide/gang-of-four/flyweight/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Examples in Python ecosystem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://docs.python.org/3/library/sys.html#sys.intern</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Minimizes memory usage by sharing data with other similar objects.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> weakref</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Card</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;The Flyweight&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Could be a simple dict.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># With WeakValueDictionary garbage collection can reclaim the object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># when there are no other references to it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _pool </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> weakref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WeakValueDictionary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> suit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># If the object exists in the pool - just return it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        obj </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> suit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># otherwise - create new one (and add it to the pool)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> obj </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            obj </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__new__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Card</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_pool</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> suit</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This row does the part we usually see in `__init__`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">suit </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> suit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> obj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># If you uncomment `__init__` and comment-out `__new__` -</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#   Card becomes normal (non-flyweight).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># def __init__(self, value, suit):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic">#     self.value, self.suit = value, suit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&lt;Card: {}{}&gt;&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">suit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c1 = Card(&#x27;9&#x27;, &#x27;h&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c2 = Card(&#x27;9&#x27;, &#x27;h&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c1, c2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    (&lt;Card: 9h&gt;, &lt;Card: 9h&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c1 == c2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c1 is c2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c1.new_attr = &#x27;temp&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c3 = Card(&#x27;9&#x27;, &#x27;h&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; hasattr(c3, &#x27;new_attr&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    True</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; Card._pool.clear()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; c4 = Card(&#x27;9&#x27;, &#x27;h&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; hasattr(c4, &#x27;new_attr&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    False</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="заместитель-proxy">Заместитель (Proxy)<a href="#заместитель-proxy" class="hash-link" aria-label="Прямая ссылка на Заместитель (Proxy)" title="Прямая ссылка на Заместитель (Proxy)">​</a></h4><p>Паттерн Заместитель применяется когда мы хотим подставить один объект вместо другого. В книге &quot;Паттенрны проектирования&quot; описаны 4 таких случая:</p><ol><li>удаленный прокси, когда доступ к удаленному объекту проксируется локальным объектом;</li><li>вирутальный прокси, который позволяет создавать облегченные объекты вместо тяжеловесных, а последние создавать только когда это необходимо;</li><li>защитный прокси, который предоставляет различные уровни доступа, в зависимости от прав клиента;</li><li>интелектуальная сслыка, которая выполняет &quot;дополнительные действия при обращении к объекту&quot; (можно также реализовать с помощью дескриптопа @property)</li></ol><p>Mock - пример реализации паттерна Заместитель</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Provides an interface to resource that is expensive to duplicate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">SalesManager</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Sales Manager ready to talk&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Proxy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">busy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;No&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sales </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Proxy checking for Sales Manager availability&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">busy </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;No&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sales </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> SalesManager</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0.1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sales</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0.1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Sales Manager is busy&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NoTalkProxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Proxy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Proxy checking for Sales Manager availability&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0.1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;This Sales Manager will not talk to you&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;whether he/she is busy or not&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">busy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Yes&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> NoTalkProxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">busy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Yes&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">talk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># OUTPUT #</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Proxy checking for Sales Manager availability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Sales Manager ready to talk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Proxy checking for Sales Manager availability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Sales Manager is busy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Proxy checking for Sales Manager availability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This Sales Manager will not talk to you whether he/she is busy or not</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Proxy checking for Sales Manager availability</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This Sales Manager will not talk to you whether he/she is busy or not</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="структурные-паттерны-итог">Структурные паттерны. Итог<a href="#структурные-паттерны-итог" class="hash-link" aria-label="Прямая ссылка на Структурные паттерны. Итог" title="Прямая ссылка на Структурные паттерны. Итог">​</a></h4><p>Паттерны Адаптер и Фасад упрощают повторное использование классов в новых контекстах, а паттерн Мост дает возможность внедрить сложную функциональность одного класса в другой. Компоновщик упрощает создание иерархий объектов, хотя в Python это не особенно нужно, так как для этой цели хватает словарей. Декоратор настолько полезен, что в Python для него имеется прямая поддержка, причем идея декоратора распространена даже на классы. Использование ссылок на объекты означает что в сам язык встроена варианция на тему паттерна Приспособленец. А паттерн Заместитель в Python реализовать особенно просто.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="поведенческие-behavioral">Поведенческие (Behavioral)<a href="#поведенческие-behavioral" class="hash-link" aria-label="Прямая ссылка на Поведенческие (Behavioral)" title="Прямая ссылка на Поведенческие (Behavioral)">​</a></h3><p>Предмет поведенческих паттерном - способ решения задачи, то есть они имеют дело с алгоритмами и взаимодействиями объектов. Эти паттерны предлагают действенные способы обдумывания и организации вычислений. Для некоторых из них имеется прямяая поддержка в синтаксисе Python.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="цепочка-ответственности-chain-of-responsobility">Цепочка ответственности (Chain of responsobility)<a href="#цепочка-ответственности-chain-of-responsobility" class="hash-link" aria-label="Прямая ссылка на Цепочка ответственности (Chain of responsobility)" title="Прямая ссылка на Цепочка ответственности (Chain of responsobility)">​</a></h4><p>Паттерн цепочка отвестственности предназначен, для того чтобы разорвать связь между отправителем запроса и получателем, который этот запрос обрабатывает. Вместо непосредственного вызова одной функции из другой первая функция отправляет запрос цепочке получателей. Первый получатель в цепочке может либо обработать запрос и прервать цепочку (не передавая запрос дальше), либо передать запрос следующему получателю. У второго получателя есть такой же выбор и так далее, пока запрос не дойдет до последнего получателя (который может отбросить запрос или возбудить исключение).</p><p>Представьте себе пользовательский интерфейс, который получает события для обработки. Одни события поступают от пользователя (например, события мыши и клавиатуры), другие - от системы (например, события таймера).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">The Chain of responsibility is an object oriented version of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">`if ... elif ... elif ... else ...` idiom, with the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">benefit that the condition–action blocks can be dynamically rearranged</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">and reconfigured at runtime.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This pattern aims to decouple the senders of a request from its</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">receivers by allowing request to move through chained</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">receivers until it is handled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Request receiver in simple form keeps a reference to a single successor.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">As a variation some receivers may be capable of sending requests out</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">in several directions, forming a `tree of responsibility`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Allow a request to pass down a chain of receivers until it is handled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Handler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">metaclass</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">abc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ABCMeta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> successor</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">successor </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> successor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">        Handle request and stop.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">        If can&#x27;t - call next handler in chain.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">        As an alternative you might even in case of success</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">        call the next handler.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> res </span><span class="token keyword" style="color:#CF222E">and</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">successor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">successor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">handle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@abc</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">abstractmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Compare passed value to predefined interval&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ConcreteHandler0</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Each handler can be different.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Be simple and static...</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> request </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;request {} handled in handler 0&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ConcreteHandler1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;... With it&#x27;s own internal state&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">start </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> request </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;request {} handled in handler 1&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ConcreteHandler2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;... With helper methods.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        start</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_interval_from_db</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> start </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> request </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> end</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;request {} handled in handler 2&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_interval_from_db</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">30</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">FallbackHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">check_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;end of chain, no handler for {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; h0 = ConcreteHandler0()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; h1 = ConcreteHandler1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; h2 = ConcreteHandler2(FallbackHandler())</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; h0.successor = h1</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; h1.successor = h2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; requests = [2, 5, 14, 22, 18, 3, 35, 27, 20]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for request in requests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     h0.handle(request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 2 handled in handler 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 5 handled in handler 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 14 handled in handler 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 22 handled in handler 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 18 handled in handler 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 3 handled in handler 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    end of chain, no handler for 35</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 27 handled in handler 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    request 20 handled in handler 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optionflags</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ELLIPSIS</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="команда-command">Команда (Command)<a href="#команда-command" class="hash-link" aria-label="Прямая ссылка на Команда (Command)" title="Прямая ссылка на Команда (Command)">​</a></h4><p>паттерн Команда применяется для инкапсуляции команд в виде объектов. Например, с его помощью можно построить последовательность команд для отложенного выполнения или создать команды, допускающие отмену.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Encapsulates all information needed to perform an action or trigger an event.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Examples in Python ecosystem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Django HttpRequest (without `execute` method):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F"> https://docs.djangoproject.com/en/2.1/ref/request-response/#httprequest-objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">MoveFileCommand</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">src </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dest </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> dest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">src</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">undo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">rename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;renaming {} to {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">src</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">src</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dest</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; from os.path import lexists</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; command_stack = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     MoveFileCommand(&#x27;foo.txt&#x27;, &#x27;bar.txt&#x27;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     MoveFileCommand(&#x27;bar.txt&#x27;, &#x27;baz.txt&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ... ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Verify that none of the target files exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; assert not lexists(&quot;foo.txt&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; assert not lexists(&quot;bar.txt&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; assert not lexists(&quot;baz.txt&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Create empty file</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; open(&quot;foo.txt&quot;, &quot;w&quot;).close()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Commands can be executed later on</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for cmd in command_stack:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     cmd.execute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    renaming foo.txt to bar.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    renaming bar.txt to baz.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # And can also be undone at will</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for cmd in reversed(command_stack):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...     cmd.undo()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    renaming baz.txt to bar.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    renaming bar.txt to foo.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; os.unlink(&quot;foo.txt&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="интерпретатор-interpreter">Интерпретатор (Interpreter)<a href="#интерпретатор-interpreter" class="hash-link" aria-label="Прямая ссылка на Интерпретатор (Interpreter)" title="Прямая ссылка на Интерпретатор (Interpreter)">​</a></h4><p>Паттерн Интерпретатор формализует два типичных требования: предоставить средства, с помощью которых пользователь мог бы вводить в программу нестроковые значения, и дать пользователям возможность создавать программы.</p><p>На самом примитивном уровне  приложение получает от пользователя, или от другой программы, строки, которые необходимо каким-то образом интерпретировать (и, быть может, выполнить).</p><p>Примером широко распространенного воплощения таких требований является создание предметно-ориентированных языков (DSL).</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Интерпретатор (Interpreter) - паттерн поведения классов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Для заданного языка определяет представление его грамматики,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">а также интерпретатор предложений этого языка.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">RomanNumeralInterpreter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Интерпретатор римских цифр&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grammar </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;I&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;V&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;X&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;L&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;C&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;D&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#C6105F">&#x27;M&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">interpret</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        numbers </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grammar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># строки в значения</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> ValueError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Ошибочное значение: %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># накапливаем результат</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># запоминаем последнее значение</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">while</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            num </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> temp </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">or</span><span class="token plain"> temp </span><span class="token operator" style="color:#D73A49">&gt;=</span><span class="token plain"> num</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                result </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> num</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                result </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> temp </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            temp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> num</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> RomanNumeralInterpreter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> interp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpret</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;MMMCMXCIX&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3999</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> interp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interpret</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;MCMLXXXVIII&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1988</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="итератор-iterator">Итератор (Iterator)<a href="#итератор-iterator" class="hash-link" aria-label="Прямая ссылка на Итератор (Iterator)" title="Прямая ссылка на Итератор (Iterator)">​</a></h4><p>паттерн Итератор позвояет последовательно обойти элементы коллекции или агрегированного объекта, не раскрывая деталей их внутреннего устройства. Он настолько полезен, что в Python встроена его поддержка, а кроме того, предоставляются специальные методы, которые мы можем реализовать в собственных классах, чтобы органично поддержать итерирование.</p><p>Итерирование можно поддержать тремя способами: следуя протоколу последовательности, пользуясь вариантом встроенной функции iter() с двумя агрументами или следуя протоколу итератора.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Copyright © 2012-13 Qtrac Ltd. All rights reserved.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This program or module is free software: you can redistribute it and/or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># modify it under the terms of the GNU General Public License as published</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># by the Free Software Foundation, either version 3 of the License, or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># (at your option) any later version. It is provided for educational</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># purposes and is distributed in the hope that it will be useful, but</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># WITHOUT ANY WARRANTY; without even the implied warranty of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># General Public License for more details.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Bag</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> items</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> items </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> items</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__delitem__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">del</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> KeyError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__len__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> count </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__iter__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> count </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">count</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    items </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> __iter__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__contains__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> item </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__bag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="посредник-mediator">Посредник (Mediator)<a href="#посредник-mediator" class="hash-link" aria-label="Прямая ссылка на Посредник (Mediator)" title="Прямая ссылка на Посредник (Mediator)">​</a></h4><p>Паттерн Посредник представляет средства для создания объекта - посредника - который инкапсулирует взаимодействия между другими объектами. Это позволяет осуществлять взаимодействия между объектами, которые ничего не знают друг о друге. Например, в случае нажатия кнопки соответствующий ей объект должен только известить посредника, а уж тот уведомит все объекты, которых интересует нажатие этой кнопки.</p><p>Посредник обеспечивает слабую связанность системы, избавляя объекты от необъодимости явно ссылаться друг на друга и позволяя тем самым независимо изменять взаимодействия между ними.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">https://www.djangospin.com/design-patterns-python/mediator/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Objects in a system communicate through a Mediator instead of directly with each other.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">This reduces the dependencies between communicating objects, thereby reducing coupling.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Encapsulates how a set of objects interact.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ChatRoom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Mediator class&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">display_message</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;[{} says]: {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">User</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;A class whose instances want to interact with each other&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat_room </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">say</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chat_room</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">display_message</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; molly = User(&#x27;Molly&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; mark = User(&#x27;Mark&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; ethan = User(&#x27;Ethan&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; molly.say(&quot;Hi Team! Meeting at 3 PM today.&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [Molly says]: Hi Team! Meeting at 3 PM today.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; mark.say(&quot;Roger that!&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [Mark says]: Roger that!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; ethan.say(&quot;Alright.&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [Ethan says]: Alright.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Еще пример</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#6B6B6B;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Copyright © 2012-13 Qtrac Ltd. All rights reserved.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># This program or module is free software: you can redistribute it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># and/or modify it under the terms of the GNU General Public License as</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># published by the Free Software Foundation, either version 3 of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># License, or (at your option) any later version. It is provided for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># educational purposes and is distributed in the hope that it will be</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># useful, but WITHOUT ANY WARRANTY; without even the implied warranty of</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># General Public License for more details.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> collections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Form</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_user_interaction_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Form</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_widgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">create_mediator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">create_widgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nameText </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailText </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;OK&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cancelButton </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Cancel&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">create_mediator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mediator </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Mediator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nameText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update_ui</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update_ui</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clicked</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cancelButton</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clicked</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update_ui</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">update_ui</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> widget</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nameText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 </span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">clicked</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> widget </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;OK&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">elif</span><span class="token plain"> widget </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cancelButton</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Cancel&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Mediator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> widgetCallablePairs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">callablesForWidget </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">defaultdict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> widget</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> caller </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> widgetCallablePairs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">callablesForWidget</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">widget</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">caller</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            widget</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mediator </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">on_change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        callables </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">callablesForWidget</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> callables </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> caller </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> callables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                caller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> AttributeError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;No on_change() method registered for {}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">widget</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Mediated</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mediator </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">on_change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mediator </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mediator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">on_change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Mediated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">on_change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Button({!r}) {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#C6105F">&quot;enabled&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;disabled&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Mediated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@property</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@text</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">setter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">on_change</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__str__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Text({!r})&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">test_user_interaction_with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">           </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Ignored because it is disabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nameText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;Fred&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;fred@bloggers.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">           </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># OK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">emailText</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">okButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    form</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cancelButton</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">click</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Cancel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="хранитель-memento">Хранитель (Memento)<a href="#хранитель-memento" class="hash-link" aria-label="Прямая ссылка на Хранитель (Memento)" title="Прямая ссылка на Хранитель (Memento)">​</a></h4><p>Паттерн хранитель служит для сохранения и восстановленя состояния объекта, не нарушая инкапсуляцию.</p><p>В языке Python имеется готовая поддержка этого паттерна; с помощью модуля <code>pickle</code> мы можем сериализовать и десериализовать произвольные объекты Python (с некоторыми ограничениями, например, нельзя сериализовать файловый объект).</p><p>Даже в тех редких случаях, когда мы сталкиваемся с ограничением сериализации, всегда можно добавить собственную поддержку этого механизам, например, реализовав специальные методы <code>__getstate__()</code> и <code>__setstate__()</code> и, возможно, метод <code>__getnewargs__()</code>. Аналогично если мы захотим использовать формат JSON для своих классов, то сможем расширить кодировщик и декодировщик ищ модуля <code>json</code>.</p><p>Можно было бы придумать собственный формат и протоколы, но смысла в это немного, так как Python и так предоставляет развитую поддержку этого паттерна.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://code.activestate.com/recipes/413838-memento-closure/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Provides the ability to restore an object to its previous state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> copy </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> copy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">from</span><span class="token plain"> copy </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> deepcopy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">memento</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> deep</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> deepcopy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> deep </span><span class="token keyword" style="color:#CF222E">else</span><span class="token plain"> copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">restore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__dict__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> restore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Transaction</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;A transaction guard.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    This is, in fact, just syntactic sugar around a memento closure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deep </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    states </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> deep</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">targets</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deep </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> deep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">targets </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> targets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">commit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">states </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">memento</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">deep</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> target </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">targets</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">rollback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> a_state </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">states</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Transactional</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Adds transactional semantics to methods. Methods decorated  with</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    @Transactional will rollback to entry-state upon exceptions.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__get__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">transaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> memento</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">except</span><span class="token plain"> Exception </span><span class="token keyword" style="color:#CF222E">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> transaction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">NumObj</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;&lt;%s: %r&gt;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">increment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@Transactional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">do_stuff</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;1111&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># &lt;- invalid value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">increment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># &lt;- will fail and rollback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; num_obj = NumObj(-1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: -1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; a_transaction = Transaction(True, num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    for i in range(3):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...        num_obj.increment()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...        print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    a_transaction.commit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    print(&#x27;-- committed&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    for i in range(3):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...        num_obj.increment()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...        print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    num_obj.value += &#x27;x&#x27;  # will fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ... except Exception:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    a_transaction.rollback()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    print(&#x27;-- rolled back&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 0&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    -- committed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 3&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 4&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 5&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    -- rolled back</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(&#x27;-- now doing stuff ...&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    -- now doing stuff ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; try:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    num_obj.do_stuff()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ... except Exception:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    print(&#x27;-&gt; doing stuff failed!&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    import sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    import traceback</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    traceback.print_exc(file=sys.stdout)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    -&gt; doing stuff failed!</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    TypeError: ...str...int...</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; print(num_obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;NumObj: 2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optionflags</span><span class="token operator" style="color:#D73A49">=</span><span class="token plain">doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ELLIPSIS</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="наблюдатель-observer">Наблюдатель (Observer)<a href="#наблюдатель-observer" class="hash-link" aria-label="Прямая ссылка на Наблюдатель (Observer)" title="Прямая ссылка на Наблюдатель (Observer)">​</a></h4><p>Паттерн Наблюдатель поддерживает отношения зависимости многие-ко-многим между объектами, например, когда изменяется состояние одного объекта, уведомляются все связанные с ним объекты. В наши дни, наверное самый распростарненный пример этого паттерна и его вариантов - парадигма модель-представление-контроллер (MVC). В этой парадигме модель описывает данные, одно или несколько предствалений эти данные визиалируют, а одни или несколько контроллеров осуществляют посредничество между вводом (например, взаимодействие с пользователем) и моделью. И любые изменения в модели автоматически отражаются в ассоциированных с ней представлениях.</p><p>У подхода MVC есть одно популярное упрощение - использовать только модели и представления, но поручить представлениям как визуализацию данных, так и передачу модели входных данных; иными словами, представления совмещены с контроллерами. В терминах паттерна Наблюдатель это означает, что представления - наблюдатели, а модель - наблюдаемый объект.</p><p>В качестве примеров можно назвать триггеры в базах данных, систему сигнализации Django, механизм сигналов и слотов в библиотеке QT и многочисленные применения технологии WebSockets.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://code.activestate.com/recipes/131499-observer-pattern/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Maintains a list of dependents and notifies them of any state changes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Examples in Python ecosystem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Django Signals: https://docs.djangoproject.com/en/2.1/topics/signals/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Flask Signals: http://flask.pocoo.org/docs/1.0/signals/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Subject</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_observers </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">attach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> observer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> observer </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_observers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_observers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">observer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">detach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> observer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_observers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">observer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">except</span><span class="token plain"> ValueError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">notify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> modifier</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> observer </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_observers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> modifier </span><span class="token operator" style="color:#D73A49">!=</span><span class="token plain"> observer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                observer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#D73A49">=</span><span class="token string" style="color:#C6105F">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@property</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@data</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">setter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">notify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">HexViewer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;HexViewer: Subject {} has data 0x{:x}&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">DecimalViewer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;DecimalViewer: Subject %s has data %d&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1 = Data(&#x27;Data 1&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2 = Data(&#x27;Data 2&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; view1 = DecimalViewer()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; view2 = HexViewer()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.attach(view1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.attach(view2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.attach(view2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.attach(view1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.data = 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 1 has data 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    HexViewer: Subject Data 1 has data 0xa</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.data = 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    HexViewer: Subject Data 2 has data 0xf</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 2 has data 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.data = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 1 has data 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    HexViewer: Subject Data 1 has data 0x3</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.data = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    HexViewer: Subject Data 2 has data 0x5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 2 has data 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    # Detach HexViewer from data1 and data2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.detach(view2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.detach(view2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data1.data = 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 1 has data 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; data2.data = 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    DecimalViewer: Subject Data 2 has data 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="состояние-state">Состояние (State)<a href="#состояние-state" class="hash-link" aria-label="Прямая ссылка на Состояние (State)" title="Прямая ссылка на Состояние (State)">​</a></h4><p>Паттерн Состояние предназначен для создания объектов, поведение которых изменяется при изменении состояния; это означает, что у объекта есть режими работы. Извне создается впечатление, что изменился класс объекта.</p><p>К обработке состояния, хранящегося внутри класса, есть два основных подхода. Первый - использование методов, чувствительных к состоянию. Второй - использование определяемых состоянием методов.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Implementation of the state pattern</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://ginstrom.com/scribbles/2007/10/08/design-patterns-python-style/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Implements state as a derived class of the state pattern interface.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Implements state transitions by invoking methods from the pattern&#x27;s superclass.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">State</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Base state. This is to share functionality&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">scan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Scan the dial to the next station&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stations</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Scanning... Station is {} {}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stations</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">AmState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> radio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stations </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&quot;1250&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;1380&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;1510&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;AM&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">toggle_amfm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Switching to FM&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fmstate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">FmState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> radio</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> radio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stations </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#C6105F">&quot;81.3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;89.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;103.9&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pos </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;FM&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">toggle_amfm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Switching to AM&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">radio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">amstate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Radio</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;A radio. It has a scan button, and an AM/FM toggle switch.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;We have an AM state and an FM state&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">amstate </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> AmState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fmstate </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> FmState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">amstate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">toggle_amfm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">toggle_amfm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">scan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; radio = Radio()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; actions = [radio.scan] * 2 + [radio.toggle_amfm] + [radio.scan] * 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; actions *= 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; for action in actions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    ...    action()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 1380 AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 1510 AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Switching to FM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 89.1 FM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 103.9 FM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 81.3 FM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 89.1 FM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Switching to AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 1250 AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Scanning... Station is 1380 AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Еще пример</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Состояние (State) - паттерн поведения объектов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Позволяет объекту варьировать свое поведение в зависимости от внутреннего состояния.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Извне создается впечатление, что изменился класс объекта.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">LampStateBase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Состояние лампы&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">GreenLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LampStateBase</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Green&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">RedLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LampStateBase</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Red&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">BlueLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LampStateBase</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Blue&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Lamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_states </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_states</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_states</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">GreenLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RedLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BlueLampState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">next_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token keyword" style="color:#CF222E">is</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_states</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            index </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_states</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> index </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_states</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                index </span><span class="token operator" style="color:#D73A49">+=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                index </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_states</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">light</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">next_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_color</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lamp </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Lamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">lamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">light</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Green</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Red</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Blue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">lamp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">light</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Green</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Red</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Blue</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="стратегия-strategy">Стратегия (Strategy)<a href="#стратегия-strategy" class="hash-link" aria-label="Прямая ссылка на Стратегия (Strategy)" title="Прямая ссылка на Стратегия (Strategy)">​</a></h4><p>Паттерн Стратегия позволяет инкапсулировать набор взаимозаменяемых алгоритмов, из которых пользователь выбирает тот, что ему нужен.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Стратегия (Strategy) - паттерн поведения объектов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Определяет семейство алгоритмов, инкапсулирует каждый из них и делает их взаимозаменяемыми.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Стратегия позволяет изменять алгоритмы независимо от клиентов, которые ими пользуются.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ImageDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">PNGImageDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImageDecoder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;PNG decode&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">JPEGImageDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImageDecoder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;JPEG decode&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">GIFImageDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ImageDecoder</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;GIF decode&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ext </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rsplit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;.&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> ext </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;png&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            decoder </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> PNGImageDecoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">elif</span><span class="token plain"> ext </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;jpg&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;jpeg&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            decoder </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> JPEGImageDecoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">elif</span><span class="token plain"> ext </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;gif&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            decoder </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> GIFImageDecoder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> RuntimeError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;Невозможно декодировать файл %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">%</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byterange </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> decoder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">byterange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> byterange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_byterange </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> byterange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_filename </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> filename</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;picture.png&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># PNG decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;picture.jpg&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># JPEG decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;picture.gif&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># GIF decode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Еще пример</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*What is this pattern about?</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Define a family of algorithms, encapsulate each one, and make them interchangeable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Strategy lets the algorithm vary independently from clients that use it.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Enables selecting an algorithm at runtime.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Order</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> price</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> discount_strategy</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">discount_strategy </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> discount_strategy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">price_after_discount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">discount_strategy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            discount </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">discount_strategy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            discount </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> discount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;&lt;Price: {}, price after discount: {}&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price_after_discount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">ten_percent_discount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> order</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0.10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">on_sale_discount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">order</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> order</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">price </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0.25</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; Order(100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;Price: 100, price after discount: 100&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; Order(100, discount_strategy=ten_percent_discount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;Price: 100, price after discount: 90.0&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; Order(1000, discount_strategy=on_sale_discount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &lt;Price: 1000, price after discount: 730.0&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="шаблонный-метод-template-method">Шаблонный метод (Template method)<a href="#шаблонный-метод-template-method" class="hash-link" aria-label="Прямая ссылка на Шаблонный метод (Template method)" title="Прямая ссылка на Шаблонный метод (Template method)">​</a></h4><p>Паттерн Шаблонный метод позволяет определить шаги алгоритма, оставив реализацию некоторых шагов подклассам.</p><p>Паттерн Шаблонный метод в некоторых отношениях похож на паттерн Мост.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Шаблонный метод (Template method) - паттерн поведения классов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Шаблонный метод определяет основу алгоритма и позволяет подклассам переопределить некоторые шаги алгоритма,</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">не изменяя его структуру в целом.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">ExampleBase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">template_method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step_two</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step_three</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_two</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_three</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">raise</span><span class="token plain"> NotImplementedError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Example</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ExampleBase</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_one</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Первый шаг алгоритма&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_two</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Второй шаг алгоритма&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">step_three</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Третий шаг алгоритма&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Example</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">template_method</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Первый шаг алгоритма</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Второй шаг алгоритма</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Третий шаг алгоритма</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Еще пример</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">An example of the Template pattern in Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Defines the skeleton of a base algorithm, deferring definition of exact</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">steps to subclasses.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Examples in Python ecosystem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Django class based views: https://docs.djangoproject.com/en/2.1/topics/class-based-views/</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;plain-text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_pdf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;pdf&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">get_csv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;csv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">convert_to_text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;[CONVERT]&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;{} as text&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">saver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;[SAVE]&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">template_function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">getter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> converter</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> to_save</span><span class="token operator" style="color:#D73A49">=</span><span class="token boolean" style="color:#005CC5">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> getter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Got `{}`&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">and</span><span class="token plain"> converter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> converter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;Skip conversion&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> to_save</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        saver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&quot;`{}` was processed&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; template_function(get_text, to_save=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Got `plain-text`</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Skip conversion</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [SAVE]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    `plain-text` was processed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; template_function(get_pdf, converter=convert_to_text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Got `pdf`</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [CONVERT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    `pdf as text` was processed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; template_function(get_csv, to_save=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Got `csv`</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    Skip conversion</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    [SAVE]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    `csv` was processed</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="посетитель-visitor">Посетитель (Visitor)<a href="#посетитель-visitor" class="hash-link" aria-label="Прямая ссылка на Посетитель (Visitor)" title="Прямая ссылка на Посетитель (Visitor)">​</a></h4><p>Паттерн Посетитель используется, когда нужно применить некую функцию к каждому элементу коллекции или объекту-агрегатору. Это не то же самое, что типичное использование паттерна Итератор - где мы обходим коллекцию или агрегат и вызываем некий метод для каждого элемента, - поскольку в случае &quot;посетителя&quot; вызывается внешнняя функция, а не метод.</p><p>В Python имеется встроенная поддержва этого паттерна. Например конструкция <code>new_list = map(function, old_sequence)</code> означает, что <code>function()</code> вызывается для каждого элемента <code>old_sequence</code>, в результате чего порождается <code>new_list</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Постетитель (Visitor) - паттерн поведения объектов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Описывает операцию, выполняемую с каждым объектом из некоторой структуры.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Паттерн посетитель позволяет определить новую операцию, не изменяя классы этих объектов.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">FruitVisitor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Посетитель&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        methods </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Apple</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw_apple</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Pear</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw_pear</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        draw </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> methods</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw_unknown</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw_apple</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Яблоко&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw_pear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Груша&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw_unknown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;Фрукт&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Fruit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Фрукты&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        visitor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Apple</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Яблоко&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Pear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Груша&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Banana</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Fruit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;Банан&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">visitor </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> FruitVisitor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apple </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Apple</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apple</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Яблоко</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pear </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Pear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pear</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Груша</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">banana </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> Banana</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">banana</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">visitor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Фрукт</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Еще пример</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">http://peter-hoffmann.com/2010/extrinsic-visitor-pattern-python-inheritance.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*TL;DR</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Separates an algorithm from an object structure on which it operates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">An interesting recipe could be found in</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">Brian Jones, David Beazley &quot;Python Cookbook&quot; (2013):</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">- &quot;8.21. Implementing the Visitor Pattern&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">- &quot;8.22. Implementing the Visitor Pattern Without Recursion&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">*Examples in Python ecosystem:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">- Python&#x27;s ast.NodeVisitor: https://github.com/python/cpython/blob/master/Lib/ast.py#L250</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">which is then being used e.g. in tools like `pyflakes`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">- `Black` formatter tool implements it&#x27;s own: https://github.com/ambv/black/blob/master/black.py#L718</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Node</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">A</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">C</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">A</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">Visitor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        meth </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> cls </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__mro__</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            meth_name </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&#x27;visit_&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> cls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__name__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            meth </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">getattr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> meth_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> meth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#CF222E">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">not</span><span class="token plain"> meth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            meth </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generic_visit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> meth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">generic_visit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;generic_visit &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">visit_B</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#C6105F">&#x27;visit_B &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__class__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__name__</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#C6105F">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; a, b, c = A(), B(), C()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; visitor = Visitor()</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; visitor.visit(a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    generic_visit A</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; visitor.visit(b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    visit_B B</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &gt;&gt;&gt; visitor.visit(c)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    visit_B C</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#C6105F">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token string" style="color:#C6105F">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">import</span><span class="token plain"> doctest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doctest</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">testmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="поведенческие-паттерны-итог">Поведенческие паттерны. Итог<a href="#поведенческие-паттерны-итог" class="hash-link" aria-label="Прямая ссылка на Поведенческие паттерны. Итог" title="Прямая ссылка на Поведенческие паттерны. Итог">​</a></h4><p>Для некоторых поведенческих паттернов в Python имеется прямая поддержка; остальные нетрудно реализовать самостоятельно. Паттерны Цепочка ответственности, Посредник и Наблюдатель можно реализовать традиционным способом или с помощью сопрограмм, и все они являются вариациями на тему разрыва связи между взаимодействующими объектами. Паттерн Команда можно использовать для отложенного вычисления и реализации механизма выполнения-отмена. Поскольку Python - интерпретируемый язык (на уровне байт-кода), то паттерн Интерпретатор можно реализовать с помощью самого Python и даже изолировать интерпретируемый код в отдельном процессе. Поддержка паттерна Итератор (и - неявно - паттерна посетитель) встроена в Python. Паттерн Хранитель неплохо поддержан в стандартной библиотеке Python (например, с помощью модулей <code>pickle</code> и <code>json</code>). У паттернов Состояние, Стратегия и Шаблонный метод прямой поддержки нет, но все они легко реализуются.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-lru-cache">Что такое lru cache<a href="#что-такое-lru-cache" class="hash-link" aria-label="Прямая ссылка на Что такое lru cache" title="Прямая ссылка на Что такое lru cache">​</a></h2><ul><li><a href="https://habr.com/ru/post/136758/" target="_blank" rel="noopener noreferrer">LRU, метод вытеснения из кэша</a></li></ul><p>LRU (least recently used) — это алгоритм, при котором вытесняются значения, которые дольше всего не запрашивались. Соответственно, необходимо хранить время последнего запроса к значению. И как только число закэшированных значений превосходит N необходимо вытеснить из кеша значение, которое дольше всего не запрашивалось.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-mq">Что такое MQ<a href="#что-такое-mq" class="hash-link" aria-label="Прямая ссылка на Что такое MQ" title="Прямая ссылка на Что такое MQ">​</a></h2><p>Очереди сообщений, по существу, являются связующим звеном между различными процессами в ваших приложениях и обеспечивают надежный и масштабируемый интерфейс взаимодействия с другими подключенными системами и устройствами.
О́чередь — структура данных с дисциплиной доступа к элементам «первый пришёл — первый вышел». Добавление элемента возможно лишь в конец очереди, выборка — только из начала очереди, при этом выбранный элемент из очереди удаляется.</p><p>Десять причин, почему очереди сообщений являются жизненно важным компонентом для любой архитектуры или приложения:</p><ul><li><em>Слабое связывание</em> — очереди сообщений создают неявные интерфейсы обмена данными, которые позволяют процессам быть независимыми друг от друга т.е вы просто определяете формат сообщений отправляемых от одного процесса другому.</li><li><em>Избыточность</em> — Очереди позволяют избежать случаев неэкономного использования ресурсов процесса(например памяти) в результате хранения необработанной (лишней) информации.</li><li><em>Масштабируемость</em> — очереди сообщений позволяют распределить процессы обработки информации. Таким образом, они позволяют легко наращивать скорость, с которой сообщения добавляются в очередь и обрабатываются.</li><li><em>Эластичность и возможность выдерживать пиковые нагрузки</em> — очереди сообщений могут выполнять роль своего рода буфера для накопления данных в случае пиковой нагрузки, смягчая тем самым нагрузку на систему обработки информации и не допуская ее отказа.</li><li><em>Отказоустойчивость</em> — очереди сообщений позволяют отделить процессы друг от друга, так что если процесс, который обрабатывает сообщения из очереди падает, то сообщения могут быть добавлены в очередь на обработку позднее, когда система восстановится.</li><li><em>Гарантированная доставка</em> — использование очереди сообщений гарантирует, что сообщение будет доставлено и обработано в любом случае (пока есть хотя бы один обработчик).</li><li><em>Гарантированный порядок доставки</em> — большая часть систем очередей сообщений способны обеспечить гарантии того, что данные будут обрабатываться в определённом порядке (чаще всего в том порядке в котором они поступили).</li><li><em>Буферизация</em> — очереди сообщений позволяет отправлять и получать сообщения при этом работая с максимальной эффективностью, предлагая буферный слой — процесс записи в очередь может происходить настолько быстро, насколько быстро это в состоянии выполнить очередь сообщений, а не обработчик сообщения.</li><li><em>Понимание потоков данных</em> — очереди сообщений позволяют выявлять узкие места в потоках данных приложения, легко можно определить какая из очередей забивается, какая простаивает и определить что необходимо делать — добавлять новых обработчиков сообщений или оптимизировать текущую архитектуру.</li><li><em>Асинхронная связь</em> — очереди сообщений предоставляют возможность асинхронной обработки данных, которая позволяет поместить сообщение в очередь без обработки, позволяя системе обработать сообщение позднее, когда появится возможность.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-готовые-реализации-mq-вы-знаете">Какие готовые реализации MQ вы знаете<a href="#какие-готовые-реализации-mq-вы-знаете" class="hash-link" aria-label="Прямая ссылка на Какие готовые реализации MQ вы знаете" title="Прямая ссылка на Какие готовые реализации MQ вы знаете">​</a></h2><ul><li><a href="http://www.programmersought.com/article/3359645442/" target="_blank" rel="noopener noreferrer">Message middleware deployment and comparison: rabbitMQ, activeMQ, zeroMQ, rocketMQ, Kafka, redis</a></li><li><a href="https://habr.com/ru/company/itsumma/blog/416629/" target="_blank" rel="noopener noreferrer">RabbitMQ против Kafka: два разных подхода к обмену сообщениями</a></li><li><a href="https://medium.com/@vozerov/kafka-vs-rabbitmq-38e221cf511b" target="_blank" rel="noopener noreferrer">Kafka VS RabbitMQ</a></li><li><a href="https://habr.com/ru/post/326880/" target="_blank" rel="noopener noreferrer">Выбор MQ для высоконагруженного проекта</a></li></ul><ul><li>ActiveMQ</li><li>RabbitMQ</li><li>RedisQueue</li><li>Kafka</li><li>rocketMQ</li><li>zeroMQ</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-rpc">Что такое RPC<a href="#что-такое-rpc" class="hash-link" aria-label="Прямая ссылка на Что такое RPC" title="Прямая ссылка на Что такое RPC">​</a></h2><p>Удалённый вызов процедур, реже Вызов удалённых процедур (от англ. Remote Procedure Call, RPC) — класс технологий, позволяющих компьютерным программам вызывать функции или процедуры в другом адресном пространстве (на удалённых компьютерах, либо в независимой сторонней системе на том же устройстве). Обычно реализация RPC-технологии включает в себя два компонента: сетевой протокол для обмена в режиме клиент-сервер и язык сериализации объектов (или структур, для необъектных RPC). На транспортном уровне RPC используют в основном протоколы TCP и UDP, однако, некоторые построены на основе HTTP (что нарушает архитектуру ISO/OSI, так как HTTP — изначально не транспортный протокол).</p><p>Характерными чертами вызова удалённых процедур являются:</p><ul><li>Асимметричность, то есть одна из взаимодействующих сторон является инициатором;</li><li>Синхронность, то есть выполнение вызывающей процедуры приостанавливается с момента выдачи запроса и возобновляется только после возврата из вызываемой процедуры.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-gprc">Что такое gPRC<a href="#что-такое-gprc" class="hash-link" aria-label="Прямая ссылка на Что такое gPRC" title="Прямая ссылка на Что такое gPRC">​</a></h2><ul><li><a href="https://habr.com/ru/company/infopulse/blog/265805/" target="_blank" rel="noopener noreferrer">gRPC — фреймворк от Google для удалённого вызова процедур</a></li><li><a href="https://blog.maddevs.io/introduction-to-grpc-6de0d9c0fe61" target="_blank" rel="noopener noreferrer">Введение в gRPC</a></li><li><a href="https://habr.com/ru/company/yandex/blog/484068/" target="_blank" rel="noopener noreferrer">gRPC в качестве протокола межсервисного взаимодействия. Доклад Яндекса</a></li><li><a href="https://realpython.com/python-microservices-grpc/" target="_blank" rel="noopener noreferrer">Python Microservices With gRPC</a></li></ul><p>gRPC — это высокопроизводительный фреймворк разработанный компанией Google для вызов удаленных процедур (RPC), работает поверх HTTP/2.
gRPC простой в использовании, отлично подходит для создания распределенных систем (микросервисов) и API. Имеет встроенную поддержку для балансировки нагрузки, трассировки, аутентификации и проверки жизнеспособности сервисов. Есть возможность создавать клиентские библиотеки для работы с бэкендом на 10 языках. Высокая производительность достигается за счет использования протокола HTTP/2 и Protocol Buffers.</p><p>Из коробки имеет:</p><ul><li>Protobuf в качестве инструмента описания типов данных и сериализации. Очень классная и хорошо зарекомендовавшая себя на практике штука. Собственно говоря, те, кому была нужна производительность — и раньше брали Protobuf, а дальше уже отдельно заморачивались транспортом. Теперь всё в комплекте.</li><li>HTTP/2 в качестве транспорта. И это невероятно мощный ход! Вся прелесть полного сжатия данных, контроля трафика, инициации событий с сервера, переиспользования одного cокета для нескольких параллельных запросов — красотища.</li><li>Статические пути — никаких больше «сервис/коллекция/ресурс/запрос? параметр=значение». Теперь только «сервис», а что внутри — описывайте в терминах вашей модели и её событий.</li><li>Никакого привязывания методов к HTTP-методам, никакого привязывания возвращаемых значений к HTTP-статусам. Пишите, что хотите.</li><li>SSL/TLS, OAuth 2.0, аутентификация через сервисы Google, плюс можно прикрутить свою (например, двухфакторную)</li><li>Поддержка 9-ти языков: C, C++, Java, Go, Node.js, Python, Ruby, Objective-C, PHP, C# плюс, конечно, никто не запрещает взять и реализовать свою версию хоть для брейнфака.</li><li>Поддержка gRPC в публичных API от Google. Уже работает для некоторых сервисов. Нет, REST-версии, конечно, тоже останутся. Но посудите сами, если у вас будет выбор — использовать, скажем, из мобильного приложения REST-версию, отдающие данные за 1 сек или с теми же затратами на разработку взять gRPC-версию, работающую 0.5 сек — что вы выберете? А что выберет ваш конкурент?</li></ul><h1>Алгоритмы, структуры</h1><p>&quot;Грокаем алгоритмы. Адитья Бхаргава&quot;</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-рекурсия-какие-минусы-плюсы">Что такое рекурсия. Какие минусы, плюсы<a href="#что-такое-рекурсия-какие-минусы-плюсы" class="hash-link" aria-label="Прямая ссылка на Что такое рекурсия. Какие минусы, плюсы" title="Прямая ссылка на Что такое рекурсия. Какие минусы, плюсы">​</a></h2><p>Рекурсия – когда функция вызывает саму себя. Логика рекурсивной функции как правило состоит из двух ветвей. Длинная ветвь вызывает эту же функцию с другими параметрами, чтобы накопить результат. Короткая ветвь определяет критерий выхода из рекурсии.</p><p>Рекурсия, <strong>в некоторых случаях</strong>, упрощает код и делает его декларативным. Рекурсия поощряет мыслить функционально и избегать побочных эффектов.</p><p>Неоптимизированная рекурсия приводит к накладным расходам ресурсов. При большом количестве итераций можно превысить лимит на число рекурсивных вызовов (recursion depth limit reached), но при возникновении такой необходимости скорее всего вы делаете что-то не так и лучше присмотритесь к другим инструментам (стэк, например).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-хвостовая-рекурсия">Что такое хвостовая рекурсия<a href="#что-такое-хвостовая-рекурсия" class="hash-link" aria-label="Прямая ссылка на Что такое хвостовая рекурсия" title="Прямая ссылка на Что такое хвостовая рекурсия">​</a></h2><p>Это особый вид рекурсии, когда функция заканчивается вызовом самой себя без дополнительных операторов. Когда это условие выполняется, компилятор разворачивает рекурсию в цикл с одним стек-фреймом, просто меняя локальные переменные от итерации к итерации.</p><p>Так, классическое определение рекурсивного факториала <code>return N * fact(N - 1)</code> не поддерживает хвостовую рекурсию, потому что для каждого стек-фрейма придется хранить текущее значение <code>N</code>.</p><p>Чтобы сделать рекурсии хвостовой, добавляют параметры-аккумуляторы. Благодаря им функция знает о своем текущем состоянии. Пусть параметр <code>acc</code> по умолчанию равен 1. Тогда запись с хвостовой рекурсией будет выглядеть так:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">fact</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">N</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> acc</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> N </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> acc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> fact</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">N </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> acc </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain"> N</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-можно-оптимизировать-хвостовую-рекурсию-в-python">Как можно оптимизировать хвостовую рекурсию в Python<a href="#как-можно-оптимизировать-хвостовую-рекурсию-в-python" class="hash-link" aria-label="Прямая ссылка на Как можно оптимизировать хвостовую рекурсию в Python" title="Прямая ссылка на Как можно оптимизировать хвостовую рекурсию в Python">​</a></h2><ul><li><a href="https://habr.com/ru/post/158385/" target="_blank" rel="noopener noreferrer">Python — оптимизация хвостовой рекурсии</a></li><li><a href="https://habr.com/ru/post/111768/" target="_blank" rel="noopener noreferrer">Устранение Хвостовой рекурсии</a></li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">class</span><span class="token plain"> </span><span class="token class-name" style="color:#116329">recursion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">object</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#C6105F">&quot;Can call other methods inside...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> func</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">func </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> func</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">__call__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">while</span><span class="token plain"> </span><span class="token builtin">callable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> result </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#D73A49">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@recursion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">sum_natural</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token operator" style="color:#D73A49">=</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> x </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> sum_natural</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Даже такой вызов не заканчивается исключением</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># RuntimeError: maximum recursion depth exceeded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sum_natural</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#005CC5">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="о-большое-при-оценке-сложности">О-большое при оценке сложности<a href="#о-большое-при-оценке-сложности" class="hash-link" aria-label="Прямая ссылка на О-большое при оценке сложности" title="Прямая ссылка на О-большое при оценке сложности">​</a></h2><p>О-большое описывает скорость работы алгоритма (не время).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="простой-поиск">Простой поиск<a href="#простой-поиск" class="hash-link" aria-label="Прямая ссылка на Простой поиск" title="Прямая ссылка на Простой поиск">​</a></h2><p>О(n).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="бинарный-поиск">Бинарный поиск<a href="#бинарный-поиск" class="hash-link" aria-label="Прямая ссылка на Бинарный поиск" title="Прямая ссылка на Бинарный поиск">​</a></h2><p>O(log n): работает только с отсортированным массивом. Берем средний элемент и проверяем не тот ли это элемент что мы ищем, если нет и он меньше чем тот который мы ищем - отбрасываем половину с меньшими значениями (если больше, то с большими) и повторяем пока не найдем искомый элемент.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">binary_search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># low and high keep track of which part of the list you&#x27;ll search in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  low </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  high </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># While you haven&#x27;t narrowed it down to one element ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">while</span><span class="token plain"> low </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> high</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># ... check the middle element</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mid </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">low </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> high</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">//</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    guess </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Found the item.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> guess </span><span class="token operator" style="color:#D73A49">==</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> mid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># The guess was too high.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> guess </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      high </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> mid </span><span class="token operator" style="color:#D73A49">-</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># The guess was too low.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      low </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> mid </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># Item doesn&#x27;t exist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> </span><span class="token boolean" style="color:#005CC5">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_list </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">9</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binary_search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># =&gt; 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#6B6B6B;font-style:italic"># &#x27;None&#x27; means nil in Python. We use to indicate that the item wasn&#x27;t found.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binary_search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">my_list</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">-</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># =&gt; None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="рекурсивные-алгоритмы">Рекурсивные алгоритмы<a href="#рекурсивные-алгоритмы" class="hash-link" aria-label="Прямая ссылка на Рекурсивные алгоритмы" title="Прямая ссылка на Рекурсивные алгоритмы">​</a></h2><p>Должны иметь базовый и рекурсивный случай. Если рекурсивный алгоритм не будет иметь базового случая, он будет выполняться вечно, так как не будет условия при котором нужно вернуть управление.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="быстрая-сортировка">Быстрая сортировка<a href="#быстрая-сортировка" class="hash-link" aria-label="Прямая ссылка на Быстрая сортировка" title="Прямая ссылка на Быстрая сортировка">​</a></h2><p>На первом этапе выбирают опорный элемент. Чаще всего его берут из середины массива. Затем последовательно сравнивают первый элемент массива с последним, второй с предпоследним и т.д. Если элемент слева от опорного элемента больше правого, они меняются местами. Когда доходят до опорного элемента, итерация считается законченной.</p><p>Далее описанный выше алгоритм применяют для двух подмассивов. Первый – от первого элемента до опорного элемента (не включительно), второй – от опорного до последнего.</p><p>Рекурсивный спуск продолжается, пока длины подмассивов не станут равны единице.</p><p>Сложность быстрой сортировки в среднем случае равна <code>N * log(N)</code>.</p><p>O(n * log n) (средний и лучший случай), O(n^2) в худшем. Скорость зависит от выбора опорного элемента - в большистве случаев выполняется за среднее время.
Базовый случай - в массиве 0 или 1 элемент, тогда он уже отсортирован.</p><p>Алгоритм:</p><ul><li>Выбрать опорный элемент</li><li>Разделить массив на два подмассива - с элементами меньше и больше опорного</li><li>Рекурсивно применять быструю сортировку к двум подмассивам</li></ul><p><em>Доказательство по индукции:</em></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#CF222E">def</span><span class="token plain"> </span><span class="token function" style="color:#8250DF">quicksort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># base case, arrays with 0 or 1 element are already &quot;sorted&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#CF222E">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># recursive case</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pivot </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># sub-array of all the elements less than the pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    less </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> i </span><span class="token operator" style="color:#D73A49">&lt;=</span><span class="token plain"> pivot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#6B6B6B;font-style:italic"># sub-array of all the elements greater than the pivot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    greater </span><span class="token operator" style="color:#D73A49">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token keyword" style="color:#CF222E">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#CF222E">in</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#CF222E">if</span><span class="token plain"> i </span><span class="token operator" style="color:#D73A49">&gt;</span><span class="token plain"> pivot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#CF222E">return</span><span class="token plain"> quicksort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">less</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pivot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#D73A49">+</span><span class="token plain"> quicksort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">greater</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#CF222E">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">quicksort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#005CC5">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#005CC5">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Скопировать в буфер обмена" title="Скопировать" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="граф">Граф<a href="#граф" class="hash-link" aria-label="Прямая ссылка на Граф" title="Прямая ссылка на Граф">​</a></h2><p>Моделирует набор связей. Они состоят из узлов и ребер. Узлы напрямую соединенные с другими узлами называются соседями.</p><p>Бывают направленные и ненаправленные, взвешенные и невзвешенные.</p><p>В направленном графе есть стрелки, а отношения действуют в направлении стрелки (А -&gt; Б, значит Б - сосед А, а А - родитель Б)</p><p>В ненаправленном графе стрелок нет, а отношение идет в обе стороны</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="очередь-и-стек">Очередь и стек<a href="#очередь-и-стек" class="hash-link" aria-label="Прямая ссылка на Очередь и стек" title="Прямая ссылка на Очередь и стек">​</a></h2><p>Очередь FIFO (first in first out), стрек LIFO (last in first out)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="дерево">Дерево<a href="#дерево" class="hash-link" aria-label="Прямая ссылка на Дерево" title="Прямая ссылка на Дерево">​</a></h2><p>Особая разновидность графа, в котором нет ребер, которые указывают в обратном направлении</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="поиск-в-ширину">Поиск в ширину<a href="#поиск-в-ширину" class="hash-link" aria-label="Прямая ссылка на Поиск в ширину" title="Прямая ссылка на Поиск в ширину">​</a></h2><p>O(V + E), где V - количество вершин, E - количество ребер, работает с графами и помогает ответить на вопросы двух типов:</p><ul><li>Существует ли путь от узла А к узлу Б?</li><li>Как выглядит кратчайший путь от узла А к узлу Б?</li></ul><p><em>Алгоритм:</em></p><ul><li>Поместить узел, с которого начинается поиск, в изначально пустую очередь.</li><li>Извлечь из начала очереди узел u и пометить его как развёрнутый.</li><li>Если узел u является целевым узлом, то завершить поиск с результатом «успех».</li><li>В противном случае, в конец очереди добавляются все преемники узла u, которые ещё не развёрнуты и не находятся в очереди.</li><li>Если очередь пуста, то все узлы связного графа были просмотрены, следовательно, целевой узел недостижим из начального; завершить поиск с результатом «неудача».</li><li>Вернуться к п. 2.</li></ul><p>Используется для нахождения кратчайшего пути в невзвешенном графе</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="алгоритм-дейкстры">Алгоритм Дейкстры<a href="#алгоритм-дейкстры" class="hash-link" aria-label="Прямая ссылка на Алгоритм Дейкстры" title="Прямая ссылка на Алгоритм Дейкстры">​</a></h2><p>Используется для нахождения пути с наименьшим весом в взвешенном графе
Работает только в направленных ациклических графах (DAG - Directed Acyclic Graph)</p><p>Состоит из 4 шагов:</p><ul><li>Найти узел с наименьшей стоимостью</li><li>Обновить стоимость соседей этого узла</li><li>Повторять пока это не будет сделано для всех узлов</li><li>Вычислить итоговый путь</li></ul><p>Не работает с отрицательными весами - для графов с отрицательными весами сущестувет специальный алгоритм, называемый <em>алгоритмом Беллмана-Форда</em></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="жадные-алгоритмы">Жадные алгоритмы<a href="#жадные-алгоритмы" class="hash-link" aria-label="Прямая ссылка на Жадные алгоритмы" title="Прямая ссылка на Жадные алгоритмы">​</a></h2><p>Используются когда вычисление точного решения занимает слишком много времени или когда высокая точность не требуется. Эффективность приближенного алгоритма оценивается по:</p><ul><li>быстроте</li><li>близости полученного решения к оптимальному</li></ul><p>Жадные алгоритмы хороши не только тем что они обычно легко формулируются, но и тем что простота обычно оборачивается быстротой выполнения.</p><p>Жадные алгоритмы стремятся к локальной оптимизации в расчете на то что в итоге будет достигнут глобальный оптимум</p><p>Жадные алгоритмы легко реализуются и быстро выполняются, поэтому из них получаются хорошие приближенные алгоритмы</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="как-распознать-np-полную-задачу">Как распознать NP-полную задачу<a href="#как-распознать-np-полную-задачу" class="hash-link" aria-label="Прямая ссылка на Как распознать NP-полную задачу" title="Прямая ссылка на Как распознать NP-полную задачу">​</a></h2><p>Не существует простого способа это сделать, но есть ряд признаков:</p><ul><li>ваш алгоритм быстро работает при малом количестве элементов, но сильно замедляется при увеличении их числа;</li><li>формулировка ~все комбинации х~ часто указывает на NР-полноту задачи;</li><li>вам приходится вычислять все возможные варианты Х, потому что задачу невозможно разбить на меньшие подзадачи? Такая задача может оказаться NР-полной;</li><li>если в задаче встречается некоторая последовательность (например, последовательность городов, как в задаче о коммивояжере) и задача не имеет простого решения, она может оказаться NР-полной;</li><li>если в задаче встречается некоторое множество (например, множество радиостанций) и задача не имеет простого решения, она может оказаться NР-полной;</li><li>можно ли переформулировать задачу в условиях задачи покрытия множества или задачи о коммивояжере? В таком случае ваша задача определенно является NР-полной.</li></ul><p>У NP-полных задач не бывает известных быстрых решений
Если у вас имеется NP-полная задача лучше воспользоваться приближенным алгоритмом</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="динамическое-программирование">Динамическое программирование<a href="#динамическое-программирование" class="hash-link" aria-label="Прямая ссылка на Динамическое программирование" title="Прямая ссылка на Динамическое программирование">​</a></h2><p>Применяется для оптимизации некоторой характиристики, например положить в рюкзак вещей на наибольшую сумму, или найти самую длинную подстроку в двух словах и тд.</p><p>Работает только в ситуациях когда задача может быть разбита на автономные подзадачи</p><p>В каждом решении из области динамического программирования строится таблица (!)
Значения ячеек таблицы обычно соответствует оптимизируемой характеристике (цена вещей, их важность, количество повторений букв и тд)</p><p>Не существует единой формулы для вычисления решений методом динамического программирования</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="алгоритм-k-ближайших-соседей">Алгоритм k ближайших соседей<a href="#алгоритм-k-ближайших-соседей" class="hash-link" aria-label="Прямая ссылка на Алгоритм k ближайших соседей" title="Прямая ссылка на Алгоритм k ближайших соседей">​</a></h2><p>Применяется для классификации и регрессии. В нем используется проверка k ближайших соседей</p><p>Классификация - распределение по категориям</p><p>Регрессия - прогнозирование результата (например, в виде числа)
Извлечением признаком называется преобразование элемента (например фрукта или пользователя) в список чисел, которые могут использоваться для сравнения
Качественный выбор признаков очень важен
Используется в машинном обучении, построении рекомендательных систем, прогнозировании и тд</p><p>Для вычисления расстояния до соседа используется формула Пифагора (<code>sqrt((x1 - x2)^2 + (y1 - y2)^2)</code>) или метрика близости косинусов. Метрика близости косинусов не измеряет расстояние между двумя векторами, вместо этого она сравнивает углы двух векторов.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="алгоритм-ричарда-фейнмана">Алгоритм Ричарда Фейнмана<a href="#алгоритм-ричарда-фейнмана" class="hash-link" aria-label="Прямая ссылка на Алгоритм Ричарда Фейнмана" title="Прямая ссылка на Алгоритм Ричарда Фейнмана">​</a></h2><ul><li>Записать формулировку задачи</li><li>Хорошенько подумать</li><li>Записать решение</li></ul><h1>Frontend</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-куки-зачем-они-как-с-ними-работать-и-где-они-сохраняются">Что такое куки. Зачем они, как с ними работать и где они сохраняются<a href="#что-такое-куки-зачем-они-как-с-ними-работать-и-где-они-сохраняются" class="hash-link" aria-label="Прямая ссылка на Что такое куки. Зачем они, как с ними работать и где они сохраняются" title="Прямая ссылка на Что такое куки. Зачем они, как с ними работать и где они сохраняются">​</a></h2><p>Куки являются информацией, сохраняемой на компьютере веб-сайтом. Куки часто хранят настройки для веб-сайта, например предпочитаемый язык или местоположение. При возвращении на сайт, браузер отправляет обратно куки, которые принадлежат этому сайту. Это позволяет сайту запоминать информацию о предыдущих посещениях.</p><p>Django использует куки чтобы хранить идентификатор сессии (или позволяет настроить проект чтобы хранить сессию в куках)</p><p>Куки хранятся в браузере.</p><p>С ними можно работать как из Django (request.COOKIES, response.st_cookie) так и из JavaScript (document.cookie) (если не установлен флаг HTTPONLY).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="может-ли-сервер-изменить-добавить-удалить-куки">Может ли сервер изменить (добавить, удалить) куки<a href="#может-ли-сервер-изменить-добавить-удалить-куки" class="hash-link" aria-label="Прямая ссылка на Может ли сервер изменить (добавить, удалить) куки" title="Прямая ссылка на Может ли сервер изменить (добавить, удалить) куки">​</a></h2><p>Да. Значение куки может быть изменено сервером путём отправления новых строк Set-Cookie: name=newvalue. После этого браузер заменяет старое куки с тем же name на новую строку.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-jwt-json-web-token">Что такое JWT (JSON Web Token)<a href="#что-такое-jwt-json-web-token" class="hash-link" aria-label="Прямая ссылка на Что такое JWT (JSON Web Token)" title="Прямая ссылка на Что такое JWT (JSON Web Token)">​</a></h2><ul><li><a href="https://proglib.io/p/json-tokens/" target="_blank" rel="noopener noreferrer">JWT простым языком: что такое JSON токены и зачем они нужны</a></li></ul><p>Веб-токен JSON, или JWT (произносится «jot»), представляет собой стандартизированный, в некоторых случаях подписанный и/или зашифрованный формат упаковки данных, который используется для безопасной передачи информации между двумя сторонами.</p><p>JWT определяет особую структуру информации, которая отправляется по сети. Она представлена в двух формах – сериализованной и десериализованной. Первая используется непосредственно для передачи данных с запросами и ответами. С другой стороны, чтобы читать и записывать информацию в токен, нужна его десериализация.</p><h1>SDLC</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="agilescrum">Agile/Scrum<a href="#agilescrum" class="hash-link" aria-label="Прямая ссылка на Agile/Scrum" title="Прямая ссылка на Agile/Scrum">​</a></h2><ul><li><a href="https://www.slideshare.net/ssuser2ea1b3/agilescrum-72029120" target="_blank" rel="noopener noreferrer">Agile/Scrum. Все что необходимо знать</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-между-ci-и-cd">Какая разница между CI и CD<a href="#какая-разница-между-ci-и-cd" class="hash-link" aria-label="Прямая ссылка на Какая разница между CI и CD" title="Прямая ссылка на Какая разница между CI и CD">​</a></h2><ul><li><a href="https://habr.com/ru/company/piter/blog/343270/" target="_blank" rel="noopener noreferrer">Непрерывная интеграция, непрерывная доставка, непрерывное развертывание: просто матрешка</a></li></ul><p><strong>Continuous integration (непрерывная интеграция)</strong>
Непрерывной интеграция заключается в следующем: все изменения, вносимые в код, объединяются в центральном репозитории (операция называется «слияние»). Слияние происходит несколько раз в день, и после каждого слияния в конкретном проекте срабатывает автоматическая сборка и тестирование.</p><p>Бывает, что перед сборкой и тестированием программу требуется скомпилировать (это зависит от языка, на котором она написана). Сегодня все чаще возникает необходимость упаковать приложение в контейнер Docker. Затем автоматические тесты проверяют конкретные модули кода, работу UI, производительность приложения, надежность API и пр. Все эти этапы в совокупности обычно называют «сборкой».</p><p>CI – это своеобразная страховочная сетка, позволяющая разработчикам избежать массы проблем перед сдачей проекта.</p><p><strong>Continuous delivery (непрерывная доставка)</strong>
Непрерывная доставка – это практика автоматизации всего процесса релиза ПО. Идея заключается в том, чтобы выполнять CI, плюс автоматически готовить и вести релиз к продакшену. При этом желательно добиться следующего: любой, кто обладает достаточными привилегиями для развертывания нового релиза может выполнить развертывание в любой момент, и это можно сделать в несколько кликов. Программист, избавившись практически от всей ручной работы, трудится продуктивнее.</p><p>Как правило, в процессе непрерывной доставки требуется выполнять вручную как минимум один этап: одобрить развертывание в продакшен и запустить его. В сложных системах с множеством зависимостей конвейер непрерывной доставки может включать дополнительные этапы, выполняемые вручную либо автоматически.</p><p><strong>Continuous deployment(непрерывное развёртываение)</strong>
Непрерывное развертывание располагается «на уровень выше» непрерывной доставки. В данном случае все изменения, вносимые в исходный код, автоматически развертываются в продакшен, без явной отмашки от разработчика. Как правило, задача разработчика сводится к проверке запроса на включение (pull request) от коллеги и к информированию команды о результатах всех важных событий.</p><p>Непрерывное развертывание требует, чтобы в команде существовала отлаженная культура мониторинга, все умели держать руку на пульсе и быстро восстанавливать систему.</p><p>Разработчики, практикующие CI и желающие перейти к непрерывному развертыванию, для начала автоматизируют развертывание в обкаточную среду, а развертывание в продакшен продолжают делать вручную – одним кликом.</p><p><strong>Резюме:</strong></p><ul><li>Непрерывная интеграция (CI): короткоживущие функциональные ветки, команда сливает их с основной веткой разработки по несколько раз в день, процессы сборки и тестирования полностью автоматизированы, результат имеем в пределах 10 минут; развертывание выполняется вручную.</li><li>Непрерывная доставка (CD): автоматизируется CI + весь процесс релиза ПО. Может состоять из нескольких этапов. Развертывание в продакшен выполняется вручную.</li><li>Непрерывное развертывание: CI + CD + полностью автоматизированное развертывание в продакшен.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-между-scrum-и-kanban">Какая разница между Scrum и Kanban<a href="#какая-разница-между-scrum-и-kanban" class="hash-link" aria-label="Прямая ссылка на Какая разница между Scrum и Kanban" title="Прямая ссылка на Какая разница между Scrum и Kanban">​</a></h2><ul><li><a href="https://habr.com/ru/company/hygger/blog/351048/" target="_blank" rel="noopener noreferrer">Scrum vs Kanban: в чем разница и что выбрать?</a></li></ul><p>Scrum и Kanban — представители методологий Agile-семейства. Обе считаются гибкими и итеративными.</p><p>Более 17 лет назад лидеры IT-разработки сформулировали манифест Agile. Главное, что можем выделить из манифеста:</p><ul><li>Люди и взаимодействие важнее процессов и инструментов.</li><li>Работающий продукт важнее исчерпывающей документации.</li><li>Сотрудничество с заказчиком важнее согласования условий контракта.</li><li>Готовность к изменениям важнее следования первоначальному плану.</li></ul><p>Основу <strong>Scrum</strong> составляют короткие итерации или спринты, как правило, 2-3-х недельные. Перед началом спринта команда сама формирует список фич на итерацию, далее запускается спринт.</p><p>После окончания спринта выполненные фичи заливаются на продакшн, а невыполненные — переносятся в другой спринт. Как правило, фичи, которые делаются во время спринта, не меняются: что было на старте спринта — должно быть сделано любой ценой к окончанию спринта.</p><p><strong>Kanban</strong> дает больше гибкости, если под гибкостью понимать частоту смены приоритетов. Вчера вы залили на прод новую фичу, а сегодня получили данные с передовой и узнали, что вот эта штука не работает так, как было задумано — люди не нажимают кнопку «купить». Вы «даете по шапке» UX, он дает вам новые требования. Вы поднимаете наверх очереди эту задачу, программист берет эту задачу «сверху», выполняет ее и, к вечеру fix уже на проде, конверсия в платежи выросли на 12%. Это победа.</p><p><strong>Основная разница между Scrum и Канбан — в длине итераций. В Scrum итерации — 2 недели, в Kanban задачи программисту можно «подсовывать» хоть каждый день.</strong></p><p>В <strong>Scrum</strong> задачи принято оценивать в Story points или в часах. Без оценки не получится сформировать спринт: ведь нам нужно знать, успеем ли мы сделать задачи за 2 недели. Через 2 недели мы получаем ценную статистику — сколько часов или Story points команда смогла сделать за спринт. Velocity — это производительность команды за один спринт. Этот параметр позволяет Scrum менеджеру предсказать, где команда будет через 2 недели.</p><p>В <strong>Kanban</strong> не принято делать оценку. Это опционально, команда решает сама. Здесь нет понятия «скорость работы команды», считается только среднее время на задачу. Время это считается с помощью специального отчета — Cycle Time.</p><p><strong>Итак, в Scrum наша цель — закончить спринт, в Kanban — задачу.</strong></p><p>Scrum — это автобус, который останавливается лишь на определенных остановках, где люди выходят группами. А Kanban — это маршрутка: захотел пассажир выйти, попросил водителя и вышел там, где ему нужно.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="вопрос-для-тим-лидов-что-вы-будете-делать-если-на-проекте-нет-тестов-и-заказчик-не-хочет-тратить-на-их-разработку-время-и-деньги">Вопрос для тим-лидов: что Вы будете делать, если на проекте нет тестов и заказчик не хочет тратить на их разработку время и деньги<a href="#вопрос-для-тим-лидов-что-вы-будете-делать-если-на-проекте-нет-тестов-и-заказчик-не-хочет-тратить-на-их-разработку-время-и-деньги" class="hash-link" aria-label="Прямая ссылка на Вопрос для тим-лидов: что Вы будете делать, если на проекте нет тестов и заказчик не хочет тратить на их разработку время и деньги" title="Прямая ссылка на Вопрос для тим-лидов: что Вы будете делать, если на проекте нет тестов и заказчик не хочет тратить на их разработку время и деньги">​</a></h2><p>Апелировать к прибыльности для бизнеса заказчика.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-code-debt-и-как-с-ним-быть">Что такое Code Debt и как с ним быть<a href="#что-такое-code-debt-и-как-с-ним-быть" class="hash-link" aria-label="Прямая ссылка на Что такое Code Debt и как с ним быть" title="Прямая ссылка на Что такое Code Debt и как с ним быть">​</a></h2><p>В классическом понимании, т.е. в том виде, в котором эта метафора была описана Вардом Каннингемом, под техническим долгом понимается осознанное компромиссное решение, когда заказчик и ключевые разработчики четко понимают все преимущества от быстрого, пусть и не идеального технического решения, за которое придется расплатиться позднее. И хотя с точки зрения многих разработчиков ситуация, когда плохое решение может быть хорошим, может показаться безумной, на самом деле, это вполне возможно: если краткосрочное решение позволит компании получить видимые преимущества, выпустить продукт раньше конкурентов, удовлетворить ключевого заказчика или каким-то другим образом получить преимущества перед конкурентами, тогда такое решение совершенно оправданно. Иногда это может быть единственным способом, чтобы долгосрочная перспектива вообще существовала.</p><p>Технический долг в классическом понимании является преднамеренным и в основном касается стратегических решений, поэтому и ответственность за него лежит на заказчиках, матерых лидах, архитекторах и даже ПМ-ах, но вот все, что связано с грязным кодом касается по большей части простых разработчиков. На самом деле, разница между грязным кодом и неоптимальным стратегическим решением, по сути, не такая уж и большая: при добавлении новой возможности в систему вам приходится расплачиваться за недальновидность в прошлом.</p><p>Выплачивать проценты по техдолгу легче, если начать задумываться об этом на этапе создания продукта.</p><ul><li>Делайте одноразовые прототипы MVP и только подтвержденные гипотезы включайте в работу.</li><li>Создавайте архитектуру, которую будет просто изменить: микросервисы, API с версионированием.</li><li>Откажитесь от организации собственных серверных в пользу облачных решений. Например, Microsoft Azure, AWS Amazon Cloud, «Яндекс.Облако», облако от Mail.ru и так далее.</li><li>Установите в команде четкий definition of done, включающий в том числе метрики качества. Очень помогает включить в DOD пункт, исключающий «приемку» фичи, если есть связанные с ней баги.</li><li>Для MVP хорошо проектировать систему так, чтобы миграция пользователей с прототипов на стабильную часть была незаметной.</li></ul><p>Компании справляются с техдолгом по-разному. Основных стратегий три.</p><ul><li>Переписывают все с нуля. Это ультимативный способ поддерживать систему в состоянии, когда она постоянно готова к изменениям, если все зашло слишком далеко и уже нет прежней гибкости.</li><li>Делают постепенный рефакторинг. Задачи по техдолгу отправляются в бэклог наравне с продуктовыми задачами. Это замедляет работу по выкатке новых фич, но бизнес обычно идет на компромиссы.</li><li>Смиряются с техдолгом. Если у вас не стартап, а обновления нужны раз в полгода, то можно просто смириться с тем, что код неоптимален, и действовать по принципу «работает — не трогай». Как только поймете, что ошиблись, вы так или иначе переместитесь к пункту 1.</li></ul><h1>VCS</h1><ul><li><a href="https://git-scm.com/book/ru/v2" target="_blank" rel="noopener noreferrer">Git - Book</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-git-flow">Что такое Git Flow<a href="#что-такое-git-flow" class="hash-link" aria-label="Прямая ссылка на Что такое Git Flow" title="Прямая ссылка на Что такое Git Flow">​</a></h2><ul><li><a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow" target="_blank" rel="noopener noreferrer">Gitflow Workflowl</a></li><li><a href="https://leanpub.com/git-flow/read" target="_blank" rel="noopener noreferrer">Read Git Flow</a></li></ul><p><strong>Historical Branches</strong>
Вместо использования только одной master ветки, этот workflow использует две ветки, для записи истории проекта. Master хранит официальную историю релизов, в development же ветке ведется активная разработка. Также важно тагать комиты в master ветки номерами версий.</p><p><strong>Feature Branches</strong>
Каждая новая фича должна разрабатываться отдельно - в своей ветке, которая должна пушиться в центральный репозиторий для сохранения работы или коллаборации с другими разработчиками. Для создания фичебранча используется development ветка. Когда разработка фичи закончена, она сливается в development. Фичи никогда не должны сливаться напрямую с master веткой.</p><p><strong>Release Branches</strong>
Как только development наберет достаточно фич для релиза (или в заранее определенную дату) создается release ветка из development ветки.</p><p>Создание этого бранча начинает новый релиз-цикл, поэтому в эту ветку уже не должно покадать никаких новых фич - только баг-фиксы, генерация документации и другие таски, ориентированные на релиз.</p><p>Как только релиз-ветка подготовлена, ее сливают с master и тагают новой версией. Также она должна быть слита и с development веткой, которая уже скорее всего убежала вперед, с момента инициализации релиза.</p><p>Использование отдельной ветки для релиза позволяет одной команде готовить релиз, в том время когда другая команда будет продолжать разрабатывать новые фичи в development для последующих релизов.</p><p><strong>Hotfix Branches</strong>
Hotfix ветки используются для быстрого патчинга релизов. Это единственная ветка, которая создается из master. Как только фикс готов, он должен быть слит как в master, так и в development (или в новый release, если она есть) и master должен быть тегирован новой версией (инкрементирована patch цифра. v.1.0.1, например)</p><p>Это позволяет исправлять ошибки не прерывая весь воркфлоу или не дожидаясь следующего релиза, для выкатывания исправлений.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-git-rebase">Что такое Git Rebase<a href="#что-такое-git-rebase" class="hash-link" aria-label="Прямая ссылка на Что такое Git Rebase" title="Прямая ссылка на Что такое Git Rebase">​</a></h2><p>Итак git работает с комитами. Каждый комит — набор изменений. У каждого комита есть уникальный hash. Когда происходит слияние веток посредством merge:</p><p><code>$ git merge &quot;another_branch&quot;</code></p><p>то все комиты сохраняются — сохраняются комментарии комита, его hash + как правило добавляется еще один искусственный комит. При этом комиты могут чередоваться друг с другом. Это не всегда удобно. Допустим ваш комит решили откатить — выискивать в общем списке где ваш комит, а где не ваш не очень приятно. И вообще — в общей истории хочется видеть действительно важные изменения, а не «ой, я забыл поставить ;». Для того, чтобы несколько комитов склеивать в один можно использовать rebase. Хотя в интерфейсе GitHub есть кнопочка squash &amp; commit — это когда вы создаете pull request (PR) из одной ветки в другую (как правило из вашей рабочей ветки в основную) и после прохождения всех формальностей можно нажать squash &amp; commit, обновить комментарий и ваши изменения появятся в основной ветке как один комит.</p><p>Хочу написать о двух случаях использования rebase:</p><ol><li>Когда изменения включаются из одну ветку в другую не посредством merge, а посредством rebase:
<code>$ git rebase &quot;another_branch&quot;</code>
Это позволяет ваши локальные комиты поставить после всех комитов, которые были внесены в ветку «another_branch». Хэши ваших комитов изменятся.</li><li>Когда можно руками отредактировать несколько ваших комитов — например склеить их, изменить коментарий:
<code>$ git rebase -i {HEAD~_commit_count_|commit_hash}</code></li></ol><p>Итак вы все сделали в своей уютненькой веточки и решили поделиться этим комитом с миром, но мир хочет от вас только один комит. <code>git rebase -i</code> запустит редактор и предложит отредактировать комиты (порядок следования комитов — сверху вниз в отличие от git log). Можно оставить комит как есть, можно изменить комментарий, можно склеить с предыдущим. Как правило ваш первый комит надо оставить как есть, а все остальные изменить на
<code>pick &quot;commit_hash&quot; &quot;comment&quot; → fixup &quot;commit_hash&quot; &quot;comment&quot;</code>.</p><p>При этом все комментарии, которые были в fixup комитах потеряются и будет использоваться комментарий от первого комита. Если вам были дороги комментарии, то стоит использовать squash вместо fixup.</p><p>Но если процесс разработки был долог, то скорее всего вам приходилось делать merge основной ветки. И все ваши комиты перемешаются с общими комитами и склеивать ваши с не вашими будет задачей непростой. Поэтому перед тем, как делать <code>git rebase -i &lt;&gt;</code> стоит сделать <code>git rebase</code>. <code>git rebase</code> поставит все ваши комиты в конец списка всех комитов (в чем можно убедиться запустив <code>git log</code>) и после этого запустиь <code>git rebase -i &lt;HEAD~Количесво_ваших_комитов&gt;</code>, во всех строчках кроме первой заменить pick → {fixup|squash} и вуаля — у вас один комит.</p><p>Если в процессе редактирования комитов <code>git rebase -i &lt;&gt;</code> вы как-то накосячили, то не стоит жать Control+C — exit code выхода из редактора git не волнует. Он просто возьмет файл и сделает все по нему. Просто удалите или закомментируйте все строчки в файле. git поймет, что вы ничего не хотели.</p><p>После манипуляций с rebase потребуется push с опцией -F. Все это потому, что мы переписываем меняем историю комитов и git нас об этом честно предупреждает.
<code>$ git push -f</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-git-cherry-pick">Что такое Git Cherry pick<a href="#что-такое-git-cherry-pick" class="hash-link" aria-label="Прямая ссылка на Что такое Git Cherry pick" title="Прямая ссылка на Что такое Git Cherry pick">​</a></h2><p>Команда <code>git cherry-pick</code> используется для перенесения отдельных коммитов из одного места репозитория в другое, обычно между ветками разработки и обслуживания. Этот механизм отличается от привычных команд <code>git merge</code> и <code>git rebase</code>, которые переносят коммиты целыми цепочками.</p><p><code>git cherry-pick &lt;commit-hash&gt;</code></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-force-push">Что такое force push<a href="#что-такое-force-push" class="hash-link" aria-label="Прямая ссылка на Что такое force push" title="Прямая ссылка на Что такое force push">​</a></h2><p>Если вы поправили какие-нибудь старые коммиты в истории git, например: исправили имя автора или e-mail, или отменили последний коммит или воспользовались amend или revert, то при попытке push-а git справедливо «ругнётся»</p><p>Чтобы нам всё же запушить наши изменения, нам нужно выполнить либо</p><p><code>git push --force origin &lt;имя_ветки&gt;</code></p><p>Но в этом случае мы рискуем перетереть чьи-нибудь изменения, если с тех пор, как мы забирали изменения с сервера, кто-то успел запушить свои коммиты. Поэтому лучше использовать более безопасную команду:</p><p><code>git push --force-with-lease origin &lt;имя_ветки&gt;</code></p><p>Такой вариант лучше тем, что если кто-то успел запушить свои коммиты после того, как мы забирали изменения с сервера, то он не будет их перетирать, а выдаст нам ошибку, после чего мы сможем интегрировать чужие коммиты со своими изменениями и попытаться сделать <code>push --force-with-lease</code> ещё раз.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-pre-commit-check">Что такое pre-commit check<a href="#что-такое-pre-commit-check" class="hash-link" aria-label="Прямая ссылка на Что такое pre-commit check" title="Прямая ссылка на Что такое pre-commit check">​</a></h2><p>Как и во многих других системах контроля версий, в Git&#x27;е есть возможность запускать собственные сценарии в те моменты, когда происходят некоторые важные действия. Существуют две группы подобных перехватчиков (hook): на стороне клиента и на стороне сервера. Перехватчики на стороне клиента предназначены для клиентских операций, таких как создание коммита и слияние. Перехватчики на стороне сервера нужны для серверных операций, таких как приём отправленных коммитов. Перехватчики могут быть использованы для выполнения самых различных задач. О некоторых из таких задач мы и поговорим.</p><p>Pre-commit check можно использовать например так:</p><ul><li>выполнять проверку кода на валидность (например: соответствие требованиям PEP8, наличие документации итд);</li><li>выполнять комплексную проверку проекта (юнит-тесты итд);</li><li>прерывать операцию commit&#x27;а в случае обнаружения ошибок и отображать подробный журнал для разбора полетов.</li></ul><h1>БД</h1><ul><li><a href="https://habr.com/ru/company/otus/blog/461067/" target="_blank" rel="noopener noreferrer">Топ-65 вопросов по SQL с собеседований, к которым вы должны подготовиться в 2019 году. Часть I</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-транзакция-какие-у-неё-есть-свойства">Что такое транзакция. Какие у неё есть свойства<a href="#что-такое-транзакция-какие-у-неё-есть-свойства" class="hash-link" aria-label="Прямая ссылка на Что такое транзакция. Какие у неё есть свойства" title="Прямая ссылка на Что такое транзакция. Какие у неё есть свойства">​</a></h2><ul><li><a href="https://proselyte.net/tutorials/sql/sql-transactions/" target="_blank" rel="noopener noreferrer">Руководство по SQL. Транзакции</a></li></ul><p>Транзакция является рабочей единицей работы с базой данных (далее – БД). Это последовательность операций, выполняемых в логическом порядке пользователем, либо программой, которая работает с БД.</p><p>Мы можем сказать, что транзакция – это распространение изменений в БД. Например, если мы создаём, изменяем или удаляем запись, то мы выполняем транзакцию. Крайне важно контролировать транзакции для гарантирования.</p><p>Основные концепции (свойства) транзакции описываются аббревиатурой ACID – Atomicity, Consistency, Isolation, Durability (Атомарность, Согласованность, Изолированность, Долговечность).</p><p><strong>Атомарность:</strong></p><p>Атомарность гарантирует, что любая транзакция будет зафиксирована только целиком (полностью). Если одна из операций в последовательности не будет выполнена, то вся транзакция будет отменена. Тут вводится понятие “отката” (rollback). Т.е. внутри последовательности будут происходить определённые изменения, но по итогу все они будут отменены (“откачены”) и по итогу пользователь не увидит никаких изменений.</p><p><strong>Согласованность:</strong></p><p>Это означает, что любая завершённая транзакция (транзакция, которая достигла завершения транзакции – end of transaction) фиксирует только допустимые результаты. Например, при переводе денег с одного счёта на другой, в случае, если деньги ушли с одного счёта, они должны прийти на другой (это и есть согласованность системы). Списание и зачисление  – это две разные транзакции, поэтому первая транзакция пройдёт без ошибок, а второй просто не будет. Именно поэтому крайне важно учитывать это свойство и поддерживать баланс системы.</p><p><strong>Изолированность:</strong></p><p>Каждая транзакция должна быть изолирована от других, т.е. её результат не должен зависеть от выполнения других параллельных транзакций. На практике, изолированность крайне труднодостижимая вещь, поэтому здесь вводится понятие “уровни изолированности” (транзакция изолируется не полностью).</p><p><strong>Долговечность:</strong></p><p>Эта концепция гарантирует, что если мы получили подтверждение о выполнении транзакции, то изменения, вызванные этой транзакцией не должны быть отменены из-за сбоя системы (например, отключение электропитания).</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-команды-управления-транзакциями-вы-знаете">Какие команды управления транзакциями вы знаете<a href="#какие-команды-управления-транзакциями-вы-знаете" class="hash-link" aria-label="Прямая ссылка на Какие команды управления транзакциями вы знаете" title="Прямая ссылка на Какие команды управления транзакциями вы знаете">​</a></h2><ul><li><a href="https://proselyte.net/tutorials/sql/sql-transactions/" target="_blank" rel="noopener noreferrer">Руководство по SQL. Транзакции</a></li></ul><p>Для управления транзакциями используются следующие команды:</p><ul><li>COMMIT: Сохраняет изменения</li><li>ROLLBACK: Откатывает (отменяет) изменения</li><li>SAVEPOINT: Создаёт точку к которой группа транзакций может откатиться</li><li>SET TRANSACTION: Размещает имя транзакции.</li></ul><p>Команды управление транзакциями используются только для DML команд: INSERT, UPDATE, DELETE. Они не могут быть использованы во время создания, изменения или удаления таблицы.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-уровни-изолированности-транзакций-какие-они-бывают">Что такое уровни изолированности транзакций. Какие они бывают<a href="#что-такое-уровни-изолированности-транзакций-какие-они-бывают" class="hash-link" aria-label="Прямая ссылка на Что такое уровни изолированности транзакций. Какие они бывают" title="Прямая ссылка на Что такое уровни изолированности транзакций. Какие они бывают">​</a></h2><p>&quot;Высоконагруженные приложения&quot;. М. Клеппман. Глава 7</p><p><em>Изоляция</em> в смысле ACID означает, что конкурентно выполняемые транзакции изолированы друг от друга — они не могут помешать друг другу. Классические учебники по базам данных понимают под изоляцией сериализуемость (serializability). То есть каждая транзакция выполняется так, будто она единственная во всей базе. БД гарантирует, что результат фиксации транзакций такой же, как если бы они выполнялись последовательно (serially, одна за другой), хотя в реальности они могут выполняться конкурентно.</p><p><strong>Чтение зафиксированных данных (read comitted):</strong></p><p>Самый базовый уровень изоляции транзакций — чтение зафиксированных данных. Он обеспечивает две гарантии.</p><ul><li>При чтении из БД клиент видит только зафиксированные данные (никаких «грязных» операций чтения).</li><li>При записи в БД можно перезаписывать только зафиксированные данные (никаких «грязных» операций записи).</li></ul><p><em>«Грязные» операции чтения</em>. Клиент читает записанные другим клиентом данные до их фиксации. Уровень изоляции чтения зафиксированных данных и более сильные предотвращают «грязные» операции чтения.</p><p><em>«Грязные» операции записи</em>. Клиент перезаписывает данные, которые другой клиент записал, но еще не зафиксировал. Практически все реализации транзакций предотвращают «грязные» операции записи.</p><p><strong>Изоляция снимков состояния и воспроизводимое чтение:</strong></p><p>Ее идея состоит в том, что каждая из транзакций читает данные из согласованного снимка состояния БД, то есть видит данные, которые были зафиксированы в базе на момент ее (транзакции) начала. Даже если данные затем были изменены другой транзакцией, каждая транзакция видит только старые данные, по состоянию на конкретный момент времени. Позволяет предотвратить асимметрии чтения.</p><p><em>Асимметрия чтения</em> (невоспроизводимое чтение). Клиент видит различные части базы данных по состоянию на разные моменты времени. Чаще всего такую проблему предотвращают с помощью изоляции снимков состояния, при которой транзакция читает данные из согласованного снимка состояния, соответствующего определенному моменту времени. Обычно это реализуется благодаря многоверсионному управлению конкурентным доступом (MVCC).</p><p><strong>Сериализуемость (serializability):</strong></p><p>Обычно считается самым сильным уровнем изоляции. Она гарантирует, что даже при конкурентном выполнении транзакций результат останется таким же, как и в случае их последовательного (по одной за раз) выполнения, без всякой конкурентности. Следовательно, база данных гарантирует, что правильно выполняющиеся последовательно транзакции будут столь же правильно выполняться конкурентно. Другими словами, база предотвращает все возможные состояния гонки.</p><p>Большинство современных БД, обеспечивающих сериализуемость, применяют один из трех методов:</p><ul><li>По-настоящему последовательное выполнение транзакций. Если вы можете сделать отдельные транзакции очень быстрыми, причем количество транзакций, обрабатываемых за единицу времени на одном ядре CPU, достаточно невелико, то для обработки этот вариант окажется простым и эффективным.</li><li>Двухфазная блокировка. На протяжении десятилетий она была стандартным способом обеспечения сериализуемости, но многие приложения стараются ее не использовать из-за плохих показателей производительности.</li><li>Сериализуемая изоляция снимков состояния (SSI). Довольно свежий алгоритм, лишенный практически всех недостатков предыдущих подходов. В нем используется оптимистический подход, благодаря чему транзакции выполняются без блокировок. Перед фиксацией транзакции выполняется проверка, и если выполнение было несериализуемым, то транзакция прерывается без фиксации.</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-вложенные-транзакции">Что такое вложенные транзакции<a href="#что-такое-вложенные-транзакции" class="hash-link" aria-label="Прямая ссылка на Что такое вложенные транзакции" title="Прямая ссылка на Что такое вложенные транзакции">​</a></h2><p>Вложенными называются транзакции, выполнение которых инициируется из тела уже активной транзакции .</p><p>Для создания вложенной транзакции пользователю не нужны какие-либо дополнительные команды. Он просто начинает новую транзакцию, не закрыв предыдущую. Завершение транзакции верхнего уровня откладывается до завершения вложенных транзакций. Если транзакция самого нижнего ( вложенного ) уровня завершена неудачно и отменена, то все транзакции верхнего уровня, включая транзакцию первого уровня, будут отменены. Кроме того, если несколько транзакций нижнего уровня были завершены успешно (но не зафиксированы), однако на среднем уровне (не самая верхняя транзакция ) неудачно завершилась другая транзакция, то в соответствии с требованиями ACID произойдет откат всех транзакций всех уровней, включая успешно завершенные. Только когда все транзакции на всех уровнях завершены успешно, происходит фиксация всех сделанных изменений в результате успешного завершения транзакции верхнего уровня.</p><p>Каждая команда COMMIT TRANSACTION работает только с последней начатой транзакцией. При завершении вложенной транзакции команда COMMIT применяется к наиболее &quot;глубокой&quot; вложенной транзакции. Даже если в команде COMMIT TRANSACTION указано имя транзакции более высокого уровня, будет завершена транзакция, начатая последней.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-курсор-и-зачем-он-нужен">Что такое курсор и зачем он нужен<a href="#что-такое-курсор-и-зачем-он-нужен" class="hash-link" aria-label="Прямая ссылка на Что такое курсор и зачем он нужен" title="Прямая ссылка на Что такое курсор и зачем он нужен">​</a></h2><p>Запрос к реляционной базе данных обычно возвращает несколько рядов (записей) данных, но приложение за один раз обрабатывает лишь одну запись. Даже если оно имеет дело одновременно с несколькими рядами (например, выводит данные в форме электронных таблиц), их количество по-прежнему ограничено. Кроме того, при модификации, удалении или добавлении данных рабочей единицей является ряд. В этой ситуации на первый план выступает концепция курсора, и в таком контексте курсор – указатель на ряд.</p><p>Курсор в SQL – это область в памяти базы данных, которая предназначена для хранения последнего оператора SQL. Если текущий оператор – запрос к базе данных, в памяти сохраняется строка данных запроса, называемая текущим значением, или текущей строкой курсора. Указанная область в памяти поименована и доступна для прикладных программ.</p><p>Обычно курсоры используются для выбора из базы данных некоторого подмножества хранимой в ней информации. В каждый момент времени прикладной программой может быть проверена одна строка курсора. Курсоры часто применяются в операторах SQL, встроенных в написанные на языках процедурного типа прикладные программы. Некоторые из них неявно создаются сервером базы данных, в то время как другие определяются программистами.</p><p>В некоторых случаях применение курсора неизбежно. Однако по возможности этого следует избегать и работать со стандартными командами обработки данных: SELECT, UPDATE, INSERT, DELETE. Помимо того, что курсоры не позволяют проводить операции изменения над всем объемом данных, скорость выполнения операций обработки данных посредством курсора заметно ниже, чем у стандартных средств SQL.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какая-разница-между-postgresql-и-mysql">Какая разница между PostgreSQL и MySQL<a href="#какая-разница-между-postgresql-и-mysql" class="hash-link" aria-label="Прямая ссылка на Какая разница между PostgreSQL и MySQL" title="Прямая ссылка на Какая разница между PostgreSQL и MySQL">​</a></h2><ul><li><a href="https://hyperhost.ua/info/ru/sravnenie-mysql-i-postgresql" target="_blank" rel="noopener noreferrer">Сравнение MySQL и PostgreSQL</a></li></ul><p><strong>История разработки MySQL и PostgreSQL.</strong></p><p>MySQL начал создаваться еще в 90-х. Внутренний выпуск произошел в 1995 году. Тогда разработкой MySQL занимались несколько компаний. Начиная с 2010 года компания  Oracle владеет проектом MySQL и разрабатывает новые версии.</p><p>PostgreSQL немного ранее в 1986 году начал разрабатываться в Калифорнийском университете.  Над проектом работали более 8 лет, но потом был разделен на коммерческую БД IIlustra и свободный проект Postrgesql.</p><p><strong>Особенности хранения данных.</strong></p><p>В MySQL для хранения данных в таблицах используются различные движки. Движок не имеет влияния на синтаксис запросов и их выполнение. Имеется поддержка MyISAM, InnoDB, MEMORY, Berkeley DB. Их основное отличие в способе записи данных на диск и методов считывания. PostgreSQL работает только на движке storage engine. Таблицы организованы в виде обьектов, а действия выполняются с помощью объективно ориентированных функций.</p><p><strong>Стандарты SQL.</strong></p><p>SQL - это стандартизированный язык выполнения запросов, который используется и MySQL и PostgreSQL. Этот стандарт имеет несколько версий и был разработан еще в 1986 году.</p><p>MySQL имеет поддержку не всех функций и возможностей SQL. Это сделано для того, чтобы работать с MySQL было просто и удобно. Но если для проекта необходимо какое-то расширение, разработчики его могут добавить не в ущерб стандарту.</p><p>PostgreSQL поддерживает все новые стандарты SQL, из-за этого данный проект довольно сложный и не настолько популярный как MySQL.</p><p><strong>Возможности обработки данных.</strong></p><p>MySQL при исполнении запроса делает загрузку всего ответа сервера в память клиента. В случае больших обьемов это не всегда удобно. По функциям Postgresql более широкий чем Mysql. Например, в Postgresql при помощи курсора можно перемещать полученные данные. Вам предоставляется только указатель, а весь ответ хранится в памяти сервера баз данных. Данный указатель можно хранить между сеансами. Postgresql имеет поддержку регулярных выражений в запросах, рекурсивных запросов и наследования таблиц.</p><p><strong>Производительность MySQL и Postgresql.</strong></p><p>MySQL всегда был ориентирован на большую производительность, в то время как Postgresql был нацелен на большое количество настроек и стандартов. Но со временем эта ситуация поменялась и Postgre стал более производительным.</p><p>Для организации работы с базой данных в MySQL используется таблица InnoDB. А это значит, что MySQL будет значительно быстрее Postgre в случае использовании первичного ключа.</p><p>По поводу  Postgresql, вся заголовочная информация таблиц размещается в оперативной памяти. Можно применять несколько индексов к одной таблице для большего удобства. В общем PostgreSQL работает быстрее, кроме ситуаций с использованием первичных ключей.</p><p><strong>Поддерживаемые типы данных.</strong></p><p>MySQL и Postgresql имеют похожий набор, который, конечно же, имеет свои отличия. В Postgre типы более разнообразны и есть свои типы полей для определенных видов данных, которых, например, нет в MySQL.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-vacuum-в-postgresql">Что такое VACUUM в PostgreSQL<a href="#что-такое-vacuum-в-postgresql" class="hash-link" aria-label="Прямая ссылка на Что такое VACUUM в PostgreSQL" title="Прямая ссылка на Что такое VACUUM в PostgreSQL">​</a></h2><p>VACUUM высвобождает пространство, занимаемое «мёртвыми» кортежами. При обычных операциях Postgres кортежи, удалённые или устаревшие в результате обновления, физически не удаляются из таблицы; они сохраняются в ней, пока не будет выполнена команда VACUUM. Таким образом, периодически необходимо выполнять VACUUM, особенно для часто изменяемых таблиц.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="что-такое-explain-какая-разница-между-ним-и-explain-analyze">Что такое EXPLAIN. Какая разница между ним и EXPLAIN ANALYZE<a href="#что-такое-explain-какая-разница-между-ним-и-explain-analyze" class="hash-link" aria-label="Прямая ссылка на Что такое EXPLAIN. Какая разница между ним и EXPLAIN ANALYZE" title="Прямая ссылка на Что такое EXPLAIN. Какая разница между ним и EXPLAIN ANALYZE">​</a></h2><p>EXPLAIN выводит информацию, необходимую для понимания, что же делает ядро при каждом конкретном запросе.</p><p>EXPLAIN ANALYZE выполняет объясняемое выражение, даже если это insert, update или delete.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="какие-виды-joinов-вы-знаете-чем-они-отличаются-друг-от-друга">Какие виды Join&#x27;ов вы знаете, чем они отличаются друг от друга<a href="#какие-виды-joinов-вы-знаете-чем-они-отличаются-друг-от-друга" class="hash-link" aria-label="Прямая ссылка на Какие виды Join&#x27;ов вы знаете, чем они отличаются друг от друга" title="Прямая ссылка на Какие виды Join&#x27;ов вы знаете, чем они отличаются друг от друга">​</a></h2><ul><li><a href="https://postgrespro.ru/docs/postgresql/9.6/queries-table-expressions" target="_blank" rel="noopener noreferrer">Табличные выраженияl</a></li></ul><p>Слова INNER и OUTER необязательны во всех формах. По умолчанию подразумевается INNER (внутреннее соединение), а при указании LEFT, RIGHT и FULL — внешнее соединение.</p><p>Условие соединения указывается в предложении ON или USING, либо неявно задаётся ключевым словом NATURAL. Это условие определяет, какие строки двух исходных таблиц считаются «соответствующими» друг другу.</p><p>Возможные типы соединений с сопоставлениями строк:</p><p><em>INNER JOIN</em>
Для каждой строки R1 из T1 в результирующей таблице содержится строка для каждой строки в T2, удовлетворяющей условию соединения с R1.</p><p><em>LEFT OUTER JOIN</em>
Сначала выполняется внутреннее соединение (INNER JOIN). Затем в результат добавляются все строки из T1, которым не соответствуют никакие строки в T2, а вместо значений столбцов T2 вставляются NULL. Таким образом, в результирующей таблице всегда будет минимум одна строка для каждой строки из T1.</p><p><em>RIGHT OUTER JOIN</em>
Сначала выполняется внутреннее соединение (INNER JOIN). Затем в результат добавляются все строки из T2, которым не соответствуют никакие строки в T1, а вместо значений столбцов T1 вставляются NULL. Это соединение является обратным к левому (LEFT JOIN): в результирующей таблице всегда будет минимум одна строка для каждой строки из T2.</p><p><em>FULL OUTER JOIN</em>
Сначала выполняется внутреннее соединение. Затем в результат добавляются все строки из T1, которым не соответствуют никакие строки в T2, а вместо значений столбцов T2 вставляются NULL. И наконец, в результат включаются все строки из T2, которым не соответствуют никакие строки в T1, а вместо значений столбцов T1 вставляются NULL.</p><p>Предложение ON определяет наиболее общую форму условия соединения: в нём указываются выражения логического типа, подобные тем, что используются в предложении WHERE. Пара строк из T1 и T2 соответствуют друг другу, если выражение ON возвращает для них true.</p><p>USING — это сокращённая запись условия, полезная в ситуации, когда с обеих сторон соединения столбцы имеют одинаковые имена. Она принимает список общих имён столбцов через запятую и формирует условие соединения с равенством этих столбцов. Например, запись соединения T1 и T2 с USING (a, b) формирует условие ON T1.a = T2.a AND T1.b = T2.b.</p><p>Более того, при выводе JOIN USING исключаются избыточные столбцы: оба сопоставленных столбца выводить не нужно, так как они содержат одинаковые значения. Тогда как JOIN ON выдаёт все столбцы из T1, а за ними все столбцы из T2, JOIN USING выводит один столбец для каждой пары (в указанном порядке), за ними все оставшиеся столбцы из T1 и, наконец, все оставшиеся столбцы T2.</p><p>Наконец, NATURAL — сокращённая форма USING: она образует список USING из всех имён столбцов, существующих в обеих входных таблицах. Как и с USING, эти столбцы оказываются в выходной таблице в единственном экземпляре. Если столбцов с одинаковыми именами не находится, NATURAL JOIN действует как JOIN ... ON TRUE и выдаёт декартово произведение строк.</p><p>Еще есть cross join - декартово произведение.</p><h1>Дизайн-интервью</h1><p><a href="https://www.youtube.com/watch?v=Be7INI_U6GY" target="_blank" rel="noopener noreferrer">Как задизайнить Facebook за пол часа или секреты System Design Interview / Алексей Петров</a></p><p>Тема очень обширная, поэтому этот раздел следует воспринимать как чеклист для его прохождения.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="план-интервью">План интервью<a href="#план-интервью" class="hash-link" aria-label="Прямая ссылка на План интервью" title="Прямая ссылка на План интервью">​</a></h2><p>Будем считать что тайм-слот интервью - 40 минут.</p><ol><li>Уточнить требования и ограничения (4 минуты)</li><li>Сделать эстимейты проектируемой системы (пропускная способность, сколько нужно хранить информации, количество серверов и т.д.) (3 минуты)</li><li>System interface - какие сервисы предоставляет система, какие сервисы использует система (3 минуты)</li><li>System high-level design - какие компоненты входят в систему, как они взаимодействуют друг с другом (5 минут)</li><li>Component detailed design - какие компоненты входят в систему, как они взаимодействуют друг с другом. Описать возможные ботлнеки (15 минут)</li><li>Масштабирование - как система будет масштабироваться (5 минут)</li><li>Summary - общий обзор и презентация решения (5 минут)</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-сбор-требований">1. Сбор требований<a href="#1-сбор-требований" class="hash-link" aria-label="Прямая ссылка на 1. Сбор требований" title="Прямая ссылка на 1. Сбор требований">​</a></h2><p>Собираем ответы на вопросы &quot;Что система делает?&quot; и &quot;Какой должна быть система?&quot;</p><p>Примеры вопросов:</p><ul><li>Это должна быть глобальная система или региональная?</li><li>Как быстро система должна реагировать на внесенные изменения (latency)?</li><li>Какая должна быть доступность системы (availability)?</li><li>Сколько у нас пользователей активно ежедневно?</li><li>Сколько пользователи генерируют трафика ежедневно (количество постов, публикаций и тд)?</li><li>Какое количество информации пользователь просматривает каждый день?</li></ul><p>Если нам предлагают спроектировать систему по примеру существующей (twitter, facebook, google docs, etc), то мы можем спросить:</p><ul><li>Какую часть системы мы проектируем?</li><li>Какие именно функции должны быть реализованы?</li></ul><p>Сразу формируем для себя чек-лист требований, чтобы не забыть что-то важное.
Например нам предложили спроектировать Facebook с такими требованиями:</p><ul><li>Дизайним ленту новостей (news feed) фейсбука</li><li>Фото/видео не реализуем</li><li>Ранжирование постов не нужно, хронологический порядок</li><li>Встраиваем реламу в ленту (желательно)</li><li>Глобальная система (multi-region)</li><li>Latency (внутри региона) &lt; 1s</li><li>Latency (между регионами) &lt; 60s</li><li>Durability (постоянство данных) очень важно</li><li>Availability (доступность) менее важно</li><li>Миллиард пользователей</li><li>10 миллионов постов в день</li><li>500 друзей в среднем</li><li>5 просмотров фида на пользователя в день</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-эстимейты">2. Эстимейты<a href="#2-эстимейты" class="hash-link" aria-label="Прямая ссылка на 2. Эстимейты" title="Прямая ссылка на 2. Эстимейты">​</a></h2><p>Чтобы посчитать эстимейты нужно примерно представить какой тип информации сколько весит.</p><p>Хранение информации:</p><ul><li>Символ - 1 байт</li><li>Метаданные (строка в базе, вес поста, etc) - 5-10 килобайт</li><li>1080p изображение - 2 мегабайта</li><li>1080p видео (минута) - 30 мегабайт</li></ul><p>Сервера:</p><ul><li>Дисковое пространство - 10 терабайт</li><li>RAM - 256-512 гигабайт</li></ul><p>Итого считаем эстимейты для примера с фейсбуком:</p><ul><li>Read-write ratio - 5B / 10M = 500:1</li><li>RPS<ul><li>Read: 5B / (24 <em> 60 </em> 60) = ~58k rps</li><li>Write: 10M / (24 <em> 60 </em> 60) = ~115 rps</li></ul></li><li>Storage:<ul><li>10KB * 10M = 100GB ежедневно</li><li>30 * 100GB = 3TB ежемесячно</li></ul></li><li>Пропускная способность:<ul><li>Read: 5B <em> 20 постов </em> 10KB = 1PB ежедневно</li><li>Write: 10M * 10KB = 100GB ежедневно</li></ul></li></ul><p>PS. RPS мы посчитали &quot;постоянный&quot;, в пиках он может увеличиваться в 10 раз (условно)</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-api">3. API<a href="#3-api" class="hash-link" aria-label="Прямая ссылка на 3. API" title="Прямая ссылка на 3. API">​</a></h2><p>Описываем максимально просто - какие методы будут доступны, какие параметры будут принимать.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-high-level-design">4. High-level design<a href="#4-high-level-design" class="hash-link" aria-label="Прямая ссылка на 4. High-level design" title="Прямая ссылка на 4. High-level design">​</a></h2><p>Не стоит называть какие-то конкретные технологии, а просто описывать какие компоненты будут в системе и как они будут взаимодействовать.
Ну тоесть не нужно прям называть Nginx, а просто описать что будет балансировщик нагрузки.</p><ul><li>Если ставим лоад-балансер, то какой? (Round-robin, sticky sessions, etc)</li><li>Если БД, то какая? (RDBMS, NoSQL, inmemory etc)</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-detailed-design">5. Detailed design<a href="#5-detailed-design" class="hash-link" aria-label="Прямая ссылка на 5. Detailed design" title="Прямая ссылка на 5. Detailed design">​</a></h2><ul><li>Описываем схему БД и запросы к ней (можем прям примеры запросов писать)</li><li>Перебираем подходы по обработке данных (pros/cons)</li><li>Выбираем решения и объясняем их tradeoffs</li><li>Проверяем требования (список который мы составили на шаге 1)</li><li>Определить edge cases (если они есть)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="performance-mantras">Performance mantras<a href="#performance-mantras" class="hash-link" aria-label="Прямая ссылка на Performance mantras" title="Прямая ссылка на Performance mantras">​</a></h3><p>В процессе, если мы сталкиваемся с проблемой производительности, то мы можем применять следующие <a href="https://www.brendangregg.com/methodology.html" target="_blank" rel="noopener noreferrer">мантры</a>:</p><ul><li>Не делай этого</li><li>Делай, но только один раз</li><li>Делай это реже</li><li>Сделай это позже</li><li>Сделай пока пользователь этого не видит</li><li>Сделай это параллельно</li><li>Сделай это дешевле</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-масштабирование">6. Масштабирование<a href="#6-масштабирование" class="hash-link" aria-label="Прямая ссылка на 6. Масштабирование" title="Прямая ссылка на 6. Масштабирование">​</a></h2><p>Если говорим про шардирование, то сразу оговариаем какой ключ шардирования выбираем.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="performance-bottlenecks">Performance bottlenecks<a href="#performance-bottlenecks" class="hash-link" aria-label="Прямая ссылка на Performance bottlenecks" title="Прямая ссылка на Performance bottlenecks">​</a></h3><p>В зависимости от количества пользователей нам может понадобиться разные инфраструктурные решения:</p><ul><li>1000 пользователей<ul><li>1 сервер</li><li>1 БД</li></ul></li><li>10 000 пользователей<ul><li>Read replicas</li><li>Несколько серверов</li><li>Load balancer(s)</li></ul></li><li>100 000 пользователей<ul><li>Message queue</li><li>Rate limits</li><li>Cache</li><li>CDN</li></ul></li><li>1 000 000 пользователей<ul><li>Stateless services (если они еще не такие)</li><li>Возможно появится noSQL (если еще не использовался)</li><li>Database sharding</li></ul></li><li>1 000 000 000 пользователей<ul><li>Regional DCs</li></ul></li></ul><h1>Вопросы работодателю</h1><ul><li><a href="https://habr.com/ru/post/428283/" target="_blank" rel="noopener noreferrer">Вопросы не мальчика, а джуна. 22 вопроса работодателю на собеседовании на позицию «Middle Python-разработчик»</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="вопросы-hrу">Вопросы HR&#x27;у<a href="#вопросы-hrу" class="hash-link" aria-label="Прямая ссылка на Вопросы HR&#x27;у" title="Прямая ссылка на Вопросы HR&#x27;у">​</a></h2><ol><li>Что с отпуском и больничными?</li><li>Переносится ли отпуск на следующий год?</li><li>Какое отношение к официальным государственным выходным?</li><li>Есть ли мед-страховка?</li><li>Какие ограничения есть на период испытательного срока</li><li>Свободный график? Нужно находиться в офисе n часов?</li><li>Как в компании относятся к удалённой работе?</li><li>Можно ли получить оборудование для удалённой работы (мониторы, etc.) или может есть компенсация на оборудование рабочего места</li><li>Существует ли в компании полугодовая/годовая оценка сотрудников и как она происходит?</li><li>Какой минимальный срок для первого пересмотра ЗП начиная с первого рабочего дня?</li><li>Есть ли у в компании переработки? Если есть, то компенсируются ли они и как часто они происходят?</li><li>Насколько в компании сильна бюрократия?</li><li>Является ли компания участником каких-либо IT-конференций и есть ли у компании публикации на IT-темы?</li><li>Есть ли митапы внутри компании?</li><li>Есть ли в компании стажёры и развита ли система наставничества?</li><li>Зарплата в какой валюте и привязана ли к курсу, если не в у.е?</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="вопросы-для-технического-собеседования">Вопросы для технического собеседования<a href="#вопросы-для-технического-собеседования" class="hash-link" aria-label="Прямая ссылка на Вопросы для технического собеседования" title="Прямая ссылка на Вопросы для технического собеседования">​</a></h2><ol><li>Как дела с тестированием? Какие тесты вы пишете? Какие библиотеки для тестирования вы используете? (фабрики, моки и т.д.)</li><li>Есть ли Code Review? Как оно проходит?</li><li>Есть ли в проектах CI/CD? Есть ли DevOps-инженер?</li><li>Используете ли вы git-flow или какую-либо определенную методологию при работе с git?</li><li>Используете ли Вы методологию разработки (scrum, kanban и т.д.)?</li><li>Используются ли системы мониторинга в проектах(Sentry, NewRelic и т.д.)?</li><li>Используется ли в проекте система для хранения логов и работы с ними(ELK-технология и прочее)?</li><li>Какие БД используются в проекте? Почему именно такие?</li><li>Какая версия языка Python используется в проектах?</li><li>Компания ищет fullstack-разработчика или backend-разработчика?</li><li>Используется ли технология контейнеризации в проектах?</li><li>Немного поспрашивать собеседующего о том, чем он занимался до этого проекта и давно ли он в проекте.</li><li>Есть ли синьеры в команде или просто очень опытные разрабы?</li><li>Оцениваниются ли задачи по времени или стори-поинтам?</li><li>Как легко втащить в проект новую технологию? Как выбирается стек для нового проекта?</li><li>Как в команде принимаются решения? Есть ли человек за которым последнее слово?</li><li>Попросить описать несколько типичных задач или несколько последних</li><li>Какие версии Python и фреймворков используются?</li><li>Насколько часто приходится работать с legacy?</li><li>Если приходится работать с legacy то какой подход: вносим минимальные правки или пытаемся привести legacy в нормальный вид?</li></ol><h1>Интересные ссылки</h1><ul><li><a href="https://habr.com/ru/post/421993/" target="_blank" rel="noopener noreferrer">Интересности и полезности python</a></li><li><a href="https://habr.com/ru/post/207988/" target="_blank" rel="noopener noreferrer">Python: вещи, которых вы могли не знать</a></li><li><a href="https://habr.com/ru/post/322360/" target="_blank" rel="noopener noreferrer">Интересные особенности Python, о которых вы могли не догадываться</a></li><li><a href="https://habr.com/ru/post/205944/" target="_blank" rel="noopener noreferrer">Python на Хабре</a></li><li><a href="https://habr.com/ru/post/249183/" target="_blank" rel="noopener noreferrer">Микросервисы (Microservices)</a></li><li><a href="https://www.youtube.com/watch?v=8cV4ZvHXQL4&amp;index=3&amp;t=0s&amp;list=PLmcXv3fDgVcjpZ6QnpXrSNTj7-RxtdFhA" target="_blank" rel="noopener noreferrer">Цикл событий в js</a></li><li><a href="https://habr.com/ru/post/320710/" target="_blank" rel="noopener noreferrer">Разница между nginx и apache с примерами</a></li></ul><h1>Источники вопросов</h1><ul><li><a href="https://habr.com/ru/post/439576/" target="_blank" rel="noopener noreferrer">Обширный обзор собеседований по Python. Советы и подсказки</a></li><li><a href="https://grishaev.me/interview/" target="_blank" rel="noopener noreferrer">Собеседование. Вопросы для подготовки</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Теги:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/python">python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/questions">questions</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/stavis-dev/stavis-dev.github.io/tree/main/docs/python/python-questions.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Отредактировать эту страницу</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Последнее обновление<!-- --> <b><time datetime="2023-08-22T15:25:35.000Z">22 авг. 2023 г.</time></b> от <b>Stavis</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Страница документа"><a class="pagination-nav__link pagination-nav__link--prev" href="/python/google-colab"><div class="pagination-nav__sublabel">Предыдущая страница</div><div class="pagination-nav__label">Google Colab</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/python/python-re-sub"><div class="pagination-nav__sublabel">Следующая страница</div><div class="pagination-nav__label">Модуль re.replace()</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#последовательности" class="table-of-contents__link toc-highlight">Последовательности</a></li><li><a href="#множества-и-отображения" class="table-of-contents__link toc-highlight">Множества и отображения</a></li><li><a href="#функции" class="table-of-contents__link toc-highlight">Функции</a><ul><li><a href="#что-такое-args-kwargs-в-каких-случаях-они-требуются" class="table-of-contents__link toc-highlight">Что такое args, kwargs. В каких случаях они требуются</a></li><li><a href="#почему-использовать-изменяемые-объекты-как-параметры-по-умолчанию-плохо-приведите-пример-плохого-случая-как-исправить" class="table-of-contents__link toc-highlight">Почему использовать изменяемые объекты как параметры по-умолчанию плохо. Приведите пример плохого случая. Как исправить</a></li><li><a href="#можно-ли-передавать-функцию-в-качестве-аргумента-другой-функции" class="table-of-contents__link toc-highlight">Можно ли передавать функцию в качестве аргумента другой функции</a></li><li><a href="#можно-ли-объявлять-функцию-внутри-другой-функции-где-она-будет-видна" class="table-of-contents__link toc-highlight">Можно ли объявлять функцию внутри другой функции. Где она будет видна</a></li><li><a href="#что-такое-лямбды-каковы-их-особенности" class="table-of-contents__link toc-highlight">Что такое лямбды. Каковы их особенности</a></li><li><a href="#допустимы-ли-следующие-выражения" class="table-of-contents__link toc-highlight">Допустимы ли следующие выражения</a></li><li><a href="#как-передаются-значения-аргументов-в-функцию-или-метод" class="table-of-contents__link toc-highlight">Как передаются значения аргументов в функцию или метод</a></li><li><a href="#что-такое-замыкание" class="table-of-contents__link toc-highlight">Что такое замыкание</a></li></ul></li><li><a href="#итераторы-и-генераторы" class="table-of-contents__link toc-highlight">Итераторы и генераторы</a><ul><li><a href="#что-такое-контейнер" class="table-of-contents__link toc-highlight">Что такое контейнер</a></li><li><a href="#что-такое-итерабельный-объект" class="table-of-contents__link toc-highlight">Что такое итерабельный объект</a></li><li><a href="#что-такое-итератор" class="table-of-contents__link toc-highlight">Что такое итератор</a></li><li><a href="#что-такое-генератор" class="table-of-contents__link toc-highlight">Что такое генератор</a></li><li><a href="#что-такое-генераторная-функция" class="table-of-contents__link toc-highlight">Что такое генераторная функция</a></li><li><a href="#что-делает-yield" class="table-of-contents__link toc-highlight">Что делает yield</a></li><li><a href="#в-чем-отличие-x-for-x-in-y-от-x-for-x-in-y" class="table-of-contents__link toc-highlight">В чем отличие [x for x in y] от (x for x in y)</a></li><li><a href="#что-особенного-в-генераторе" class="table-of-contents__link toc-highlight">Что особенного в генераторе</a></li><li><a href="#как-объявить-генератор" class="table-of-contents__link toc-highlight">Как объявить генератор</a></li><li><a href="#как-получить-из-генератора-список" class="table-of-contents__link toc-highlight">Как получить из генератора список</a></li><li><a href="#что-такое-подгенератор" class="table-of-contents__link toc-highlight">Что такое подгенератор</a></li><li><a href="#какие-методы-есть-у-генераторов" class="table-of-contents__link toc-highlight">Какие методы есть у генераторов</a></li><li><a href="#можно-ли-извлечь-элемент-генератора-по-индексу" class="table-of-contents__link toc-highlight">Можно ли извлечь элемент генератора по индексу</a></li><li><a href="#что-возвращает-итерация-по-словарю" class="table-of-contents__link toc-highlight">Что возвращает итерация по словарю</a></li><li><a href="#как-итерировать-словарь-по-парам-ключ-значение" class="table-of-contents__link toc-highlight">Как итерировать словарь по парам ключ-значение</a></li><li><a href="#что-такое-сопрограмма" class="table-of-contents__link toc-highlight">Что такое сопрограмма</a></li></ul></li><li><a href="#классы-объекты" class="table-of-contents__link toc-highlight">Классы, объекты</a><ul><li><a href="#как-получить-список-атрибутов-объекта" class="table-of-contents__link toc-highlight">Как получить список атрибутов объекта</a></li><li><a href="#что-такое-магические-методы-для-чего-нужны" class="table-of-contents__link toc-highlight">Что такое магические методы, для чего нужны</a></li><li><a href="#как-в-классе-сослаться-на-родительский-класс" class="table-of-contents__link toc-highlight">Как в классе сослаться на родительский класс</a></li><li><a href="#возможно-ли-множественное-наследование" class="table-of-contents__link toc-highlight">Возможно ли множественное наследование</a></li><li><a href="#что-такое-mro" class="table-of-contents__link toc-highlight">Что такое MRO</a></li><li><a href="#что-такое-diamond-problem" class="table-of-contents__link toc-highlight">Что такое Diamond problem</a></li><li><a href="#что-такое-миксины" class="table-of-contents__link toc-highlight">Что такое миксины</a></li><li><a href="#что-такое-контекстный-менеджер-как-написать-свой" class="table-of-contents__link toc-highlight">Что такое контекстный менеджер. Как написать свой</a></li><li><a href="#прокомментировать-выражение" class="table-of-contents__link toc-highlight">Прокомментировать выражение</a></li><li><a href="#что-такое-__slots__-плюсы-минусы" class="table-of-contents__link toc-highlight">Что такое __slots__. Плюсы, минусы</a></li><li><a href="#в-чем-смысл-параметров-_value-__value" class="table-of-contents__link toc-highlight">В чем смысл параметров _value, __value</a></li><li><a href="#что-такое-__new__-и-чем-он-отличается-от-__init__-в-какой-последовательности-они-выполняются" class="table-of-contents__link toc-highlight">Что такое __new__. И чем он отличается от __init__. В какой последовательности они выполняются</a></li><li><a href="#что-такое-и-чем-отличается-old-style-от-new-style-classes" class="table-of-contents__link toc-highlight">Что такое и чем отличается old-style от new-style classes</a></li><li><a href="#что-такое-утиная-типизация" class="table-of-contents__link toc-highlight">Что такое утиная типизация</a></li></ul></li><li><a href="#модули-пакеты" class="table-of-contents__link toc-highlight">Модули, пакеты</a><ul><li><a href="#что-такое-модуль" class="table-of-contents__link toc-highlight">Что такое модуль</a></li><li><a href="#как-можно-получить-имя-модуля" class="table-of-contents__link toc-highlight">Как можно получить имя модуля</a></li><li><a href="#что-такое-модульное-программирование" class="table-of-contents__link toc-highlight">Что такое модульное программирование</a></li><li><a href="#как-python-ищет-модули-при-импорте" class="table-of-contents__link toc-highlight">Как Python ищет модули при импорте</a></li><li><a href="#что-такое-пакет" class="table-of-contents__link toc-highlight">Что такое пакет</a></li><li><a href="#что-вы-можете-сказать-о-конструкции-import-packageitem" class="table-of-contents__link toc-highlight">Что вы можете сказать о конструкции import package.item</a></li></ul></li><li><a href="#исключения" class="table-of-contents__link toc-highlight">Исключения</a><ul><li><a href="#что-такое-обработка-исключений" class="table-of-contents__link toc-highlight">Что такое обработка исключений</a></li><li><a href="#для-чего-могут-применять-конструкцию-try-finally-без-except" class="table-of-contents__link toc-highlight">Для чего могут применять конструкцию try finally без except</a></li><li><a href="#как-правильно-по-разному-обрабатывать-исключения" class="table-of-contents__link toc-highlight">Как правильно по-разному обрабатывать исключения</a></li><li><a href="#что-будет-если-ошибку-не-обработает-блок-except" class="table-of-contents__link toc-highlight">Что будет если ошибку не обработает блок except</a></li><li><a href="#что-делать-если-нужно-перехватить-исключение-выполнить-действия-и-опять-возбудить-это-же-исключение" class="table-of-contents__link toc-highlight">Что делать если нужно перехватить исключение, выполнить действия и опять возбудить это же исключение</a></li><li><a href="#что-такое-сцепление-исключений" class="table-of-contents__link toc-highlight">Что такое сцепление исключений</a></li><li><a href="#зачем-нужен-блок-else" class="table-of-contents__link toc-highlight">Зачем нужен блок else</a></li><li><a href="#что-можно-передать-в-конструктор-исключения" class="table-of-contents__link toc-highlight">Что можно передать в конструктор исключения</a></li><li><a href="#какие-есть-классы-исключений" class="table-of-contents__link toc-highlight">Какие есть классы исключений</a></li><li><a href="#в-каких-случаях-можно-обработать-syntaxerror" class="table-of-contents__link toc-highlight">В каких случаях можно обработать SyntaxError</a></li><li><a href="#можно-ли-создавать-собственные-исключения" class="table-of-contents__link toc-highlight">Можно ли создавать собственные исключения</a></li><li><a href="#для-чего-нужны-предупреждения-warnings-и-как-создать-собственное" class="table-of-contents__link toc-highlight">Для чего нужны предупреждения (warnings) и как создать собственное</a></li><li><a href="#для-чего-нужен-модуль-warning" class="table-of-contents__link toc-highlight">Для чего нужен модуль warning</a></li></ul></li><li><a href="#декораторы" class="table-of-contents__link toc-highlight">Декораторы</a><ul><li><a href="#что-такое-декораторы-зачем-нужны" class="table-of-contents__link toc-highlight">Что такое декораторы. Зачем нужны</a></li><li><a href="#что-может-быть-декоратором-к-чему-может-быть-применен-декоратор" class="table-of-contents__link toc-highlight">Что может быть декоратором. К чему может быть применен декоратор</a></li><li><a href="#что-будет-если-декоратор-не-возвращает-ничего" class="table-of-contents__link toc-highlight">Что будет, если декоратор не возвращает ничего</a></li><li><a href="#в-чем-отличие-foobar-от-foobar" class="table-of-contents__link toc-highlight">В чем отличие @foobar от @foobar()</a></li><li><a href="#что-такое-фабрика-декораторов" class="table-of-contents__link toc-highlight">Что такое фабрика декораторов</a></li><li><a href="#зачем-нужен-wraps" class="table-of-contents__link toc-highlight">Зачем нужен wraps</a></li></ul></li><li><a href="#метаклассы" class="table-of-contents__link toc-highlight">Метаклассы</a><ul><li><a href="#что-такое-метаклассы" class="table-of-contents__link toc-highlight">Что такое метаклассы</a></li><li><a href="#что-такое-type-как-работает-поиск-метакласса-при-создании-объекта" class="table-of-contents__link toc-highlight">Что такое type. Как работает поиск метакласса при создании объекта</a></li><li><a href="#как-работают-метаклассы" class="table-of-contents__link toc-highlight">Как работают метаклассы</a></li><li><a href="#зачем-вообще-использовать-метаклассы" class="table-of-contents__link toc-highlight">Зачем вообще использовать метаклассы</a></li></ul></li><li><a href="#ввод-вывод" class="table-of-contents__link toc-highlight">Ввод-Вывод</a><ul><li><a href="#что-такое-файловый-объект" class="table-of-contents__link toc-highlight">Что такое файловый объект</a></li><li><a href="#какие-есть-виды-файловых-объектов" class="table-of-contents__link toc-highlight">Какие есть виды файловых объектов</a></li><li><a href="#в-чем-отличие-текстовых-и-бинарных-файлов" class="table-of-contents__link toc-highlight">В чем отличие текстовых и бинарных файлов</a></li><li><a href="#как-пользоваться-функцией-open" class="table-of-contents__link toc-highlight">Как пользоваться функцией open</a></li><li><a href="#для-чего-необходимо-закрывать-файлы" class="table-of-contents__link toc-highlight">Для чего необходимо закрывать файлы</a></li><li><a href="#что-делают-методы-tell-и-seek" class="table-of-contents__link toc-highlight">Что делают методы tell и seek</a></li><li><a href="#что-делают-stringio-и-bytesio" class="table-of-contents__link toc-highlight">Что делают StringIO и BytesIO</a></li><li><a href="#являются-ли-файловые-объекты-контекстными-менеджерами" class="table-of-contents__link toc-highlight">Являются ли файловые объекты контекстными менеджерами</a></li><li><a href="#что-такое-сериализация" class="table-of-contents__link toc-highlight">Что такое сериализация</a></li><li><a href="#jsondumps--jsondump--jsonloads--jsonload" class="table-of-contents__link toc-highlight">json.dumps / json.dump , json.loads / json.load</a></li><li><a href="#что-делать-если-нужно-сериализовать-данные-которые-не-поддерживаются-стандартным-модулем-json" class="table-of-contents__link toc-highlight">Что делать если нужно сериализовать данные, которые не поддерживаются стандартным модулем json</a></li><li><a href="#pickledumps--pickledump-pickleloads--pickleload" class="table-of-contents__link toc-highlight">pickle.dumps / pickle.dump, pickle.loads / pickle.load</a></li></ul></li><li><a href="#тестирование" class="table-of-contents__link toc-highlight">Тестирование</a><ul><li><a href="#пирамида-тестирования" class="table-of-contents__link toc-highlight">Пирамида тестирования</a></li><li><a href="#что-такое-mocking" class="table-of-contents__link toc-highlight">Что такое mocking</a></li><li><a href="#что-делать-если-тестируемая-функция-использует-удалённое-подключение-к-внешним-сервисам-которое-иногда-видает-ошибку-таймаута-404-и-им-подобные" class="table-of-contents__link toc-highlight">Что делать, если тестируемая функция использует удалённое подключение к внешним сервисам, которое иногда видает ошибку таймаута, 404 и им подобные</a></li><li><a href="#что-делать-если-тестируемая-функция-занимает-много-времени-на-выполнение-повторяющихся-операций-внутри-неё" class="table-of-contents__link toc-highlight">Что делать, если тестируемая функция занимает много времени на выполнение повторяющихся операций внутри неё</a></li><li><a href="#какие-вы-знаете-виды-тестов" class="table-of-contents__link toc-highlight">Какие вы знаете виды тестов</a></li><li><a href="#чем-интеграционное-тестирование-отличается-от-функционального" class="table-of-contents__link toc-highlight">Чем интеграционное тестирование отличается от функционального</a></li></ul></li><li><a href="#функциональное-программирование" class="table-of-contents__link toc-highlight">Функциональное программирование</a><ul><li><a href="#что-такое-функциональное-программирование" class="table-of-contents__link toc-highlight">Что такое функциональное программирование</a></li><li><a href="#как-у-python-с-поддержкой-функционального-программирования" class="table-of-contents__link toc-highlight">Как у Python с поддержкой функционального программирования</a></li><li><a href="#что-такое-объект-первого-класса" class="table-of-contents__link toc-highlight">Что такое объект первого класса</a></li><li><a href="#что-такое-функция-высшего-порядка" class="table-of-contents__link toc-highlight">Что такое функция высшего порядка</a></li><li><a href="#что-такое-каррирование" class="table-of-contents__link toc-highlight">Что такое каррирование</a></li><li><a href="#опишите-функции-map-reduce-filter-модуля-functools" class="table-of-contents__link toc-highlight">Опишите функции map, reduce, filter модуля functools</a></li><li><a href="#какие-еще-вы-знаете-функции-из-модуля-functools" class="table-of-contents__link toc-highlight">Какие еще вы знаете функции из модуля functools</a></li><li><a href="#какие-вы-функции-знаете-из-модуля-itertools" class="table-of-contents__link toc-highlight">Какие вы функции знаете из модуля itertools</a></li><li><a href="#для-чего-нужен-модуль-operator" class="table-of-contents__link toc-highlight">Для чего нужен модуль operator</a></li></ul></li><li><a href="#gil-потоки-процессы" class="table-of-contents__link toc-highlight">GIL, потоки, процессы</a><ul><li><a href="#что-такое-gil-какие-у-него-есть-проблемы" class="table-of-contents__link toc-highlight">Что такое GIL. Какие у него есть проблемы</a></li><li><a href="#работали-ли-вы-с-asyncio-в-чём-его-особенность" class="table-of-contents__link toc-highlight">Работали ли Вы с asyncio. В чём его особенность</a></li><li><a href="#что-такое-asyncawait-для-чего-они-нужны-и-как-их-использовать" class="table-of-contents__link toc-highlight">Что такое async/await, для чего они нужны и как их использовать</a></li><li><a href="#как-в-питоне-реализуется-многопоточность-какими-модулями" class="table-of-contents__link toc-highlight">Как в питоне реализуется многопоточность. Какими модулями</a></li><li><a href="#в-чем-отличие-тредов-от-мультипроцессинга" class="table-of-contents__link toc-highlight">В чем отличие тредов от мультипроцессинга</a></li><li><a href="#какие-задачи-хорошо-параллелятся-какие-плохо" class="table-of-contents__link toc-highlight">Какие задачи хорошо параллелятся, какие плохо</a></li><li><a href="#нужно-посчитать-100-уравнений-делать-это-в-тредах-или-нет" class="table-of-contents__link toc-highlight">Нужно посчитать 100 уравнений. Делать это в тредах или нет</a></li><li><a href="#треды-в-питоне--это-нативные-треды-или-нет" class="table-of-contents__link toc-highlight">Треды в Питоне — это нативные треды или нет</a></li><li><a href="#что-такое-гринлеты-общее-понятие-примеры-реализаций" class="table-of-contents__link toc-highlight">Что такое гринлеты. Общее понятие. Примеры реализаций</a></li></ul></li><li><a href="#какие-варианты-реализации-шаблона-singleton-на-питоне" class="table-of-contents__link toc-highlight">Какие варианты реализации шаблона Singleton на питоне</a></li><li><a href="#какие-вы-знаете-инструменты-для-проверки-кодстайл" class="table-of-contents__link toc-highlight">Какие вы знаете инструменты для проверки кодстайл</a></li><li><a href="#что-такое-listdict-comprehension" class="table-of-contents__link toc-highlight">Что такое list/dict comprehension</a></li><li><a href="#какая-разница-между-одинарным-и-двойным-подчеркиванием" class="table-of-contents__link toc-highlight">Какая разница между одинарным и двойным подчеркиванием</a></li><li><a href="#отличие-copy-от-deepcopy" class="table-of-contents__link toc-highlight">Отличие copy() от deepcopy()</a></li><li><a href="#что-такое-garbage-collector-в-чём-его-плюсы-и-минусы" class="table-of-contents__link toc-highlight">Что такое garbage collector. В чём его плюсы и минусы</a></li><li><a href="#что-такое-интроспекция" class="table-of-contents__link toc-highlight">Что такое интроспекция</a></li><li><a href="#что-такое-рефлексия" class="table-of-contents__link toc-highlight">Что такое рефлексия</a></li><li><a href="#что-такое-middleware-для-чего-как-реализуется" class="table-of-contents__link toc-highlight">Что такое Middleware, для чего, как реализуется</a></li><li><a href="#назовите-основные-мидлвари-зачем-они-нужны" class="table-of-contents__link toc-highlight">Назовите основные мидлвари. Зачем они нужны</a></li><li><a href="#опишите-алгоритм-работы-csrf-middleware" class="table-of-contents__link toc-highlight">Опишите алгоритм работы CSRF middleware</a></li><li><a href="#что-такое-сигналы-зачем-нужны-назовите-основные" class="table-of-contents__link toc-highlight">Что такое сигналы? Зачем нужны? Назовите основные</a></li><li><a href="#как-реализуется-связь-m2m-на-уровне-базы-данных" class="table-of-contents__link toc-highlight">Как реализуется связь m2m на уровне базы данных</a></li><li><a href="#чем-лучше-отправлять-форму--get-или-post" class="table-of-contents__link toc-highlight">Чем лучше отправлять форму — GET или POST</a></li><li><a href="#как-работает-serializer-в-django-rest-framework" class="table-of-contents__link toc-highlight">Как работает Serializer в Django REST Framework</a></li><li><a href="#что-такое-meta-в-классах-django-и-для-чего-нужен" class="table-of-contents__link toc-highlight">Что такое Meta в классах Django и для чего нужен</a></li><li><a href="#за-что-отвечает-meta-в-сериализаторе" class="table-of-contents__link toc-highlight">За что отвечает Meta в сериализаторе</a></li><li><a href="#какая-разница-в-быстродействии-между-django-и-flask-и-почему" class="table-of-contents__link toc-highlight">Какая разница в быстродействии между django и Flask (и почему)</a></li><li><a href="#как-в-django-работает-система-аутентификации" class="table-of-contents__link toc-highlight">Как в django работает система аутентификации</a></li><li><a href="#что-такое-cgi-плюсы-минусы" class="table-of-contents__link toc-highlight">Что такое CGI. Плюсы, минусы</a></li><li><a href="#как-защитить-куки-от-воровства-и-от-подделки" class="table-of-contents__link toc-highlight">Как защитить куки от воровства и от подделки</a></li><li><a href="#какая-разница-между-аутентификацией-и-авторизацией" class="table-of-contents__link toc-highlight">Какая разница между аутентификацией и авторизацией</a></li><li><a href="#что-такое-xss-примеры-как-защитить-приложение" class="table-of-contents__link toc-highlight">Что такое XSS. Примеры. Как защитить приложение</a></li><li><a href="#rest--soap" class="table-of-contents__link toc-highlight">REST &amp; SOAP</a><ul><li><a href="#что-такое-rest" class="table-of-contents__link toc-highlight">Что такое REST</a></li><li><a href="#что-такое-soap" class="table-of-contents__link toc-highlight">Что такое SOAP</a></li><li><a href="#в-чем-разница-между-rest-и-soap-веб-сервисами" class="table-of-contents__link toc-highlight">В чем разница между REST и SOAP веб сервисами</a></li><li><a href="#можем-ли-мы-посылать-soap-сообщения-с-вложением" class="table-of-contents__link toc-highlight">Можем ли мы посылать SOAP сообщения с вложением</a></li><li><a href="#как-бы-вы-решили-какой-из-rest-или-soap-веб-сервисов-использовать" class="table-of-contents__link toc-highlight">Как бы вы решили какой из REST или SOAP веб сервисов использовать</a></li></ul></li><li><a href="#какие-способы-для-мониторинга-веб-приложений-в-production-вы-использовали-или-знаете" class="table-of-contents__link toc-highlight">Какие способы для мониторинга веб-приложений в production вы использовали или знаете</a></li><li><a href="#как-устроен-протокол-http" class="table-of-contents__link toc-highlight">Как устроен протокол HTTP</a></li><li><a href="#написать-raw-запрос-главной-яндекса" class="table-of-contents__link toc-highlight">Написать raw запрос главной Яндекса</a></li><li><a href="#как-клиенту-понять-удался-запрос-или-нет" class="table-of-contents__link toc-highlight">Как клиенту понять, удался запрос или нет</a></li><li><a href="#что-нужно-отправить-браузеру-чтобы-перенаправить-на-другую-страницу" class="table-of-contents__link toc-highlight">Что нужно отправить браузеру, чтобы перенаправить на другую страницу</a></li><li><a href="#как-управлять-кешированием-в-http" class="table-of-contents__link toc-highlight">Как управлять кешированием в HTTP</a></li><li><a href="#как-кэшируются-файлы-на-уровне-протокола" class="table-of-contents__link toc-highlight">Как кэшируются файлы на уровне протокола</a></li><li><a href="#что-такое-http" class="table-of-contents__link toc-highlight">Что такое HTTP</a></li><li><a href="#чем-отличаются-http-и-https" class="table-of-contents__link toc-highlight">Чем отличаются HTTP и HTTPS</a></li><li><a href="#ооп" class="table-of-contents__link toc-highlight">ООП</a><ul><li><a href="#инкапсуляция" class="table-of-contents__link toc-highlight">Инкапсуляция</a></li><li><a href="#наследование" class="table-of-contents__link toc-highlight">Наследование</a></li><li><a href="#полиморфизм" class="table-of-contents__link toc-highlight">Полиморфизм</a></li><li><a href="#абстракция" class="table-of-contents__link toc-highlight">Абстракция</a></li></ul></li><li><a href="#какие-принципы-программирования-вы-знаете" class="table-of-contents__link toc-highlight">Какие принципы программирования вы знаете</a><ul><li><a href="#kiss" class="table-of-contents__link toc-highlight">KISS</a></li><li><a href="#dry" class="table-of-contents__link toc-highlight">DRY</a></li><li><a href="#yagni" class="table-of-contents__link toc-highlight">YAGNI</a></li><li><a href="#slap" class="table-of-contents__link toc-highlight">SLAP</a></li><li><a href="#solid-принципы" class="table-of-contents__link toc-highlight">SOLID принципы</a></li></ul></li><li><a href="#что-такое-code-cohesion--code-coupling" class="table-of-contents__link toc-highlight">Что такое code cohesion &amp; code coupling</a></li><li><a href="#какие-шаблоны-проектирования-вы-знаете" class="table-of-contents__link toc-highlight">Какие шаблоны проектирования вы знаете</a><ul><li><a href="#порождающие-creational" class="table-of-contents__link toc-highlight">Порождающие (Creational)</a></li><li><a href="#структурные-structural" class="table-of-contents__link toc-highlight">Структурные (Structural)</a></li><li><a href="#поведенческие-behavioral" class="table-of-contents__link toc-highlight">Поведенческие (Behavioral)</a></li></ul></li><li><a href="#что-такое-lru-cache" class="table-of-contents__link toc-highlight">Что такое lru cache</a></li><li><a href="#что-такое-mq" class="table-of-contents__link toc-highlight">Что такое MQ</a></li><li><a href="#какие-готовые-реализации-mq-вы-знаете" class="table-of-contents__link toc-highlight">Какие готовые реализации MQ вы знаете</a></li><li><a href="#что-такое-rpc" class="table-of-contents__link toc-highlight">Что такое RPC</a></li><li><a href="#что-такое-gprc" class="table-of-contents__link toc-highlight">Что такое gPRC</a></li><li><a href="#что-такое-рекурсия-какие-минусы-плюсы" class="table-of-contents__link toc-highlight">Что такое рекурсия. Какие минусы, плюсы</a></li><li><a href="#что-такое-хвостовая-рекурсия" class="table-of-contents__link toc-highlight">Что такое хвостовая рекурсия</a></li><li><a href="#как-можно-оптимизировать-хвостовую-рекурсию-в-python" class="table-of-contents__link toc-highlight">Как можно оптимизировать хвостовую рекурсию в Python</a></li><li><a href="#о-большое-при-оценке-сложности" class="table-of-contents__link toc-highlight">О-большое при оценке сложности</a></li><li><a href="#простой-поиск" class="table-of-contents__link toc-highlight">Простой поиск</a></li><li><a href="#бинарный-поиск" class="table-of-contents__link toc-highlight">Бинарный поиск</a></li><li><a href="#рекурсивные-алгоритмы" class="table-of-contents__link toc-highlight">Рекурсивные алгоритмы</a></li><li><a href="#быстрая-сортировка" class="table-of-contents__link toc-highlight">Быстрая сортировка</a></li><li><a href="#граф" class="table-of-contents__link toc-highlight">Граф</a></li><li><a href="#очередь-и-стек" class="table-of-contents__link toc-highlight">Очередь и стек</a></li><li><a href="#дерево" class="table-of-contents__link toc-highlight">Дерево</a></li><li><a href="#поиск-в-ширину" class="table-of-contents__link toc-highlight">Поиск в ширину</a></li><li><a href="#алгоритм-дейкстры" class="table-of-contents__link toc-highlight">Алгоритм Дейкстры</a></li><li><a href="#жадные-алгоритмы" class="table-of-contents__link toc-highlight">Жадные алгоритмы</a></li><li><a href="#как-распознать-np-полную-задачу" class="table-of-contents__link toc-highlight">Как распознать NP-полную задачу</a></li><li><a href="#динамическое-программирование" class="table-of-contents__link toc-highlight">Динамическое программирование</a></li><li><a href="#алгоритм-k-ближайших-соседей" class="table-of-contents__link toc-highlight">Алгоритм k ближайших соседей</a></li><li><a href="#алгоритм-ричарда-фейнмана" class="table-of-contents__link toc-highlight">Алгоритм Ричарда Фейнмана</a></li><li><a href="#что-такое-куки-зачем-они-как-с-ними-работать-и-где-они-сохраняются" class="table-of-contents__link toc-highlight">Что такое куки. Зачем они, как с ними работать и где они сохраняются</a></li><li><a href="#может-ли-сервер-изменить-добавить-удалить-куки" class="table-of-contents__link toc-highlight">Может ли сервер изменить (добавить, удалить) куки</a></li><li><a href="#что-такое-jwt-json-web-token" class="table-of-contents__link toc-highlight">Что такое JWT (JSON Web Token)</a></li><li><a href="#agilescrum" class="table-of-contents__link toc-highlight">Agile/Scrum</a></li><li><a href="#какая-разница-между-ci-и-cd" class="table-of-contents__link toc-highlight">Какая разница между CI и CD</a></li><li><a href="#какая-разница-между-scrum-и-kanban" class="table-of-contents__link toc-highlight">Какая разница между Scrum и Kanban</a></li><li><a href="#вопрос-для-тим-лидов-что-вы-будете-делать-если-на-проекте-нет-тестов-и-заказчик-не-хочет-тратить-на-их-разработку-время-и-деньги" class="table-of-contents__link toc-highlight">Вопрос для тим-лидов: что Вы будете делать, если на проекте нет тестов и заказчик не хочет тратить на их разработку время и деньги</a></li><li><a href="#что-такое-code-debt-и-как-с-ним-быть" class="table-of-contents__link toc-highlight">Что такое Code Debt и как с ним быть</a></li><li><a href="#что-такое-git-flow" class="table-of-contents__link toc-highlight">Что такое Git Flow</a></li><li><a href="#что-такое-git-rebase" class="table-of-contents__link toc-highlight">Что такое Git Rebase</a></li><li><a href="#что-такое-git-cherry-pick" class="table-of-contents__link toc-highlight">Что такое Git Cherry pick</a></li><li><a href="#что-такое-force-push" class="table-of-contents__link toc-highlight">Что такое force push</a></li><li><a href="#что-такое-pre-commit-check" class="table-of-contents__link toc-highlight">Что такое pre-commit check</a></li><li><a href="#что-такое-транзакция-какие-у-неё-есть-свойства" class="table-of-contents__link toc-highlight">Что такое транзакция. Какие у неё есть свойства</a></li><li><a href="#какие-команды-управления-транзакциями-вы-знаете" class="table-of-contents__link toc-highlight">Какие команды управления транзакциями вы знаете</a></li><li><a href="#что-такое-уровни-изолированности-транзакций-какие-они-бывают" class="table-of-contents__link toc-highlight">Что такое уровни изолированности транзакций. Какие они бывают</a></li><li><a href="#что-такое-вложенные-транзакции" class="table-of-contents__link toc-highlight">Что такое вложенные транзакции</a></li><li><a href="#что-такое-курсор-и-зачем-он-нужен" class="table-of-contents__link toc-highlight">Что такое курсор и зачем он нужен</a></li><li><a href="#какая-разница-между-postgresql-и-mysql" class="table-of-contents__link toc-highlight">Какая разница между PostgreSQL и MySQL</a></li><li><a href="#что-такое-vacuum-в-postgresql" class="table-of-contents__link toc-highlight">Что такое VACUUM в PostgreSQL</a></li><li><a href="#что-такое-explain-какая-разница-между-ним-и-explain-analyze" class="table-of-contents__link toc-highlight">Что такое EXPLAIN. Какая разница между ним и EXPLAIN ANALYZE</a></li><li><a href="#какие-виды-joinов-вы-знаете-чем-они-отличаются-друг-от-друга" class="table-of-contents__link toc-highlight">Какие виды Join&#39;ов вы знаете, чем они отличаются друг от друга</a></li><li><a href="#план-интервью" class="table-of-contents__link toc-highlight">План интервью</a></li><li><a href="#1-сбор-требований" class="table-of-contents__link toc-highlight">1. Сбор требований</a></li><li><a href="#2-эстимейты" class="table-of-contents__link toc-highlight">2. Эстимейты</a></li><li><a href="#3-api" class="table-of-contents__link toc-highlight">3. API</a></li><li><a href="#4-high-level-design" class="table-of-contents__link toc-highlight">4. High-level design</a></li><li><a href="#5-detailed-design" class="table-of-contents__link toc-highlight">5. Detailed design</a><ul><li><a href="#performance-mantras" class="table-of-contents__link toc-highlight">Performance mantras</a></li></ul></li><li><a href="#6-масштабирование" class="table-of-contents__link toc-highlight">6. Масштабирование</a><ul><li><a href="#performance-bottlenecks" class="table-of-contents__link toc-highlight">Performance bottlenecks</a></li></ul></li><li><a href="#вопросы-hrу" class="table-of-contents__link toc-highlight">Вопросы HR&#39;у</a></li><li><a href="#вопросы-для-технического-собеседования" class="table-of-contents__link toc-highlight">Вопросы для технического собеседования</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/stavisvega" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b57e7902.js"></script>
<script src="/assets/js/main.3369d20a.js"></script>
</body>
</html>